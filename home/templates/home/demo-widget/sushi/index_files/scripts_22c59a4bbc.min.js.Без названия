(function($){if($.fn.inputmask===undefined){$.fn.inputmask=function(fn,options){var nptmask,input;options=options||{};if(typeof fn==="string"){switch(fn){case"mask":nptmask=new Inputmask(options);return this.each(function(){nptmask.mask(this);});case"unmaskedvalue":input=this.jquery&&this.length>0?this[0]:this;return input.inputmask?input.inputmask.unmaskedvalue():$(input).val();case"remove":return this.each(function(){if(this.inputmask)this.inputmask.remove();});case"getemptymask":input=this.jquery&&this.length>0?this[0]:this;return input.inputmask?input.inputmask.getemptymask():"";case"hasMaskedValue":input=this.jquery&&this.length>0?this[0]:this;return input.inputmask?input.inputmask.hasMaskedValue():false;case"isComplete":input=this.jquery&&this.length>0?this[0]:this;return input.inputmask?input.inputmask.isComplete():true;case"getmetadata":input=this.jquery&&this.length>0?this[0]:this;return input.inputmask?input.inputmask.getmetadata():undefined;case"setvalue":input=this.jquery&&this.length>0?this[0]:this;$(input).val(options);if(input.Inputmask===undefined)
$(input).triggerHandler("setvalue.inputmask");break;default:options.alias=fn;nptmask=new Inputmask(options);return this.each(function(){nptmask.mask(this);});}}else if(typeof fn=="object"){nptmask=new Inputmask(fn);return this.each(function(){nptmask.mask(this);});}else if(fn===undefined){return this.each(function(){nptmask=new Inputmask(options);nptmask.mask(this);});}};}
return $.fn.inputmask;})(jQuery);
$(function(){var position;$(".mm-mobile-open").on("click",".open--mob.mm-open-icon",function(e){e.preventDefault();position=window.pageYOffset;OpenMenu();});$(".mm-mobile-open").on("click",".open--mob.mm-close-icon",function(e){e.preventDefault();CloseMenu(position);});checkWidth();});$(function(){$('.mm-nav ul li a[href^="#"]').on("click",function(e){e.preventDefault();scroll_el=$(this).attr('href');Autoscroll(scroll_el);});$("body").scrollspy({target:".mm-nav",offset:100});$('.mm-nav-mobile ul li a[href^="#"]').on("click",function(e){e.preventDefault();scroll_el=$(this).attr('href');el=$("body").find(".mm-mobile-open");$(el).find(".open--mob.mm-close-icon").trigger('click');setTimeout(function(){Autoscroll(scroll_el);},400);});});$(function(){$(window).on({'load':function(){checkScrolling();stickBottom();},'resize':function(){w=$window.width();stickBottom();if(w>768){$(".open--mob.mm-close-icon").trigger('click');}},'orientationchange':function(){stickBottom();$(".open--mob.mm-close-icon").trigger('click');},'scroll':function(){checkScrolling();}});});function checkWidth(position){var w=$(window).width();if(w<991){return true;}
else{return false;}}
function CloseMenu(position){$("body").removeClass('mm-menu-open');$("body").removeClass('mm-fixed-body').addClass('mm-static-body');window.scrollTo(0,position);$(".mobile-opener-container").removeClass('openMe');$(".mm-mobile-container-inside").css('minHeight',0);$("#mobile-opener").removeClass('openMe');$('#nav-icon2').removeClass('open');$(".mm-mobile-open .open--mob").removeClass('mm-close-icon').addClass('mm-open-icon');setTimeout(function(){$(".mobile-opener-container").hide();},100);}
function checkHeight(){var h=$(window).height();return h;}
function OpenMenu(position){$("body").addClass('mm-menu-open');$('#nav-icon2').addClass('open');setTimeout(function(){$("#mobile-opener").addClass('openMe');$(".mobile-opener-container").show();},200);h=$("body").outerHeight()-90;var newWidth=checkWidth();$(".mm-mobile-container-inside").css('minHeight',h);setTimeout(function(){$("body").addClass('mm-fixed-body').removeClass('mm-static-body');},200);setTimeout(function(){$(".mobile-opener-container").addClass('openMe');},400);$(".mm-mobile-open .open--mob").addClass('mm-close-icon').removeClass('mm-open-icon');}
function Autoscroll(elem){$('body,html').animate({scrollTop:$(elem).offset().top-80},1000);}
function stickBottom(){var h=$(window).height();if(h>=668){$(".bottom-block").addClass('stick');}
else{$(".bottom-block").removeClass('stick');}}
function checkScrolling(){var top=$(this).scrollTop();var w=$(window).width();if(top>1){$("body").addClass('scrolled');$('.mm-nav-first').hide();}
else{$("body").removeClass('scrolled');$('.mm-nav-first').show();}}
var $window;$(document).ready(function(){var modals=$('.modal');for(var i=0;i<modals.length;i++){if($(modals[i]).find('.close').hasClass('cross-outer')){$(modals[i]).removeClass('for-inner-cross').addClass('for-outer-cross');}
if($(modals[i]).find('.close').hasClass('cross-inner')){$(modals[i]).removeClass('for-outer-cross').addClass('for-inner-cross');}}
$('#scrollup').click(function vverh(){window.scrollBy(0,-$(document).height()/4);return false;});$(window).scroll(function(){if($(document).scrollTop()>0){$('#scrollup').fadeIn('fast');}else{$('#scrollup').fadeOut('fast');}});if($('#special img').size()){var specialInterval=setInterval(function(){var specTop=$(window).height()/2-$('#special').height()/2;$('.special-wrapper-descr').textfill({maxFontPixels:55,ourText:$('#special-descr')});$('.special-wrapper-link').textfill({maxFontPixels:25,ourText:$('#special-link')});$('#special').animate({'top':specTop},2000,'swing');clearInterval(specialInterval);},10*1000);}
$(".inputCountMask").inputmask();if($('.plt_coupon_code').length>0){var text=$('.plt_coupon_code').html();var arr=text.split(':');var text1=arr[0].trim()+':&nbsp'+'<span class="promocode">'+arr[1].trim()+'</span>';$('.plt_coupon_code').html(text1);}});$(function(){$window=$(window);var isMobile={Android:function(){return navigator.userAgent.match(/Android/i);},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);},Opera:function(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function(){return navigator.userAgent.match(/IEMobile/i);},any:function(){return(isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows());}};var mobileAppHref="";var mobileClass="";if(isMobile.Android()){mobileAppHref="https://goo.gl/uI23dh";mobileClass="apps-google";}
if(isMobile.iOS()){mobileAppHref="https://itunes.apple.com/ru/app/мир-суши-2/id1232492982?l=ru&ls=1&mt=8";mobileClass="apps-apple";}
if(!isMobile.Android()&&!isMobile.iOS()){$("#download-app").remove();}
if($("#download-app").size()){$("#download-app").attr('href',mobileAppHref).find('.apps').addClass(mobileClass);}
if($(window).width()<768){$(".close").removeClass('cross-outer').addClass('cross-inner');$(".modal").removeClass('for-outer-cross').addClass('for-inner-cross-sm');}
$('#about-page-slider').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:false,autoplaySpeed:2000,arrows:false,fade:true,dots:false});$(".about-page-slider-nav-left a, .about-slider-left a").click(function(e){e.preventDefault();$('#about-page-slider').slick('slickPrev');});$(".about-page-slider-nav-right a, .about-slider-right a").click(function(e){e.preventDefault();$('#about-page-slider').slick('slickNext');});$('.main-cat-frame').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:false,autoplaySpeed:2000,arrows:false,dots:false,draggable:false,asNavFor:'.main-cat-nav-slider',fade:true});$('.main-cat-nav-slider').slick({slidesToShow:7,slidesToScroll:1,asNavFor:'.main-cat-frame',dots:false,draggable:false,centerMode:true,focusOnSelect:true,responsive:[{breakpoint:1190,settings:{slidesToShow:5,slidesToScroll:1}},{breakpoint:992,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:558,settings:{slidesToShow:1,slidesToScroll:1}}]});$(".main-cat-box-blur-left").click(function(e){e.preventDefault();$('.main-cat-nav-slider').slick('slickPrev');});$(".main-cat-box-blur-right").click(function(e){e.preventDefault();$('.main-cat-nav-slider').slick('slickNext');});$(".main-cat-nav-slider-text").click(function(e){e.preventDefault();var link=window.location.protocol+"//"+window.location.hostname+"/"+$(this).data("link");window.history.pushState("",null,link);ms.loaderShow();location.href=link;});var $thisSlide,$currentSlide;$(".main-cat-nav.slide-down .main-cat-nav-slider-text").hover(function(e){e.preventDefault();var thisLink=$(this).data("link");$thisSlide=$(this).parents(".main-cat").find(".container-fluid .slick-slide a[href = '"+thisLink+"']").closest(".slick-slide");$currentSlide=$(this).parents(".main-cat").find(".container-fluid .slick-slide.slick-current");if(!$thisSlide.hasClass("slick-current")){$thisSlide.css("opacity","1");$currentSlide.css("opacity","0");}},function(e){e.preventDefault();if(!$thisSlide.hasClass("slick-current")){$currentSlide.css("opacity","1");$thisSlide.css("opacity","0");}});$(document).on("click",".mm-city-link",function(e){e.preventDefault();$(this).parent().toggleClass('active');});$(document).on("mousemove",".searchbar.moved",function(e){e.preventDefault();$(this).addClass('active');});$(document).on("mouseleave",".searchbar.moved",function(e){e.preventDefault();$(this).removeClass('active');});$(document).on("mousemove",".social.moved",function(e){e.preventDefault();$(this).addClass('active');});$(document).on("mouseleave",".social.moved",function(e){e.preventDefault();$(this).removeClass('active');});$(document).on("click",".cat-item-footer a",function(e){e.preventDefault();$(this).parent().find("a").removeClass('active');$(this).addClass('active');});$(document).on("mousemove",".login.inside",function(e){e.preventDefault();$(this).addClass('active');});$(document).on("mouseleave",".login.inside",function(e){e.preventDefault();$(this).removeClass('active');});$(document).on("mousemove",".timer",function(e){e.preventDefault();$(this).addClass('active');});$(document).on("mouseleave",".timer",function(e){e.preventDefault();$(this).removeClass('active');});$(document).on('touchend',function(e){if(e.target!==$("a.open-side-nav-social")[0]&&e.target!==$("a.social-item")[0]){$(document).find(".social.moved").removeClass('active');}});$(document).on('click','.catalog-nav-inside-T a',function(e){e.preventDefault();$(this).parent().parent().find("ul").slideToggle(300);$(this).parent().find("i").toggleClass('icon-dropdown_left');});$(document).on('click','.cart-delivery-check-box-container-T a',function(e){e.preventDefault();$(this).parent().parent().find("ul").fadeToggle(200);});$(document).on('click','.order-second-step-reduse-T a',function(e){e.preventDefault();$(this).toggleClass('active');$(this).parents('.cart-outer').find(".cart-outer-container").slideToggle(200);});$(document).on('change','#starterCity',function(e){$href=$(this).val();$target=$($(document).find('.starter-page-container-box-link a'));$target.attr('href',$href);});$(document).on("show.bs.modal",function(e){var $bodyWidth=$("body").width();var b;$("body").css({'overflow-y':"hidden"}).css({'padding-right':(b=$("body").width()-$bodyWidth)});$(".mm-fixed-top").css({'padding-right':b});$("#goUp").css({'right':20+b});$(".cart-xs").css({'right':15});$(".mm-container-inside").css('padding-right','0');$('.modal-wrapper').css('visibility','visible');if($(window).width()<768){$(".cart-xs").css({'right':15+b});}});$(document).on("hidden.bs.modal",function(){$("body").css({'padding-right':"0",'overflow-y':"auto"});$(".mm-fixed-top").css({'padding-right':"0"});$("#goUp").css({'right':"20px"});$(".cart-xs").css({'right':"15px"});$(".mm-container-inside").css('padding-right','0');$('.modal-wrapper').css('visibility','hidden');});$(document).on('click','.goToRegisterModal',function(e){e.preventDefault();setTimeout(function(){$("#login").modal("show");$("#login").find(".modal-login-tabnav a[href='#register-tab']").trigger('click');},600);});$(document).on('click','.goToLoginModal',function(e){e.preventDefault();setTimeout(function(){$("#login").modal("show");$("#login").find(".modal-login-tabnav a[href='#login-tab']").trigger('click');},600);});$(document).on('click','.goToHelpModal',function(e){e.preventDefault();setTimeout(function(){$("#help-modal").modal("show");},600);});$(document).on('click','.goToItemModal',function(e){e.preventDefault();$target=$(this).data('target');setTimeout(function(){$($target).modal("show");},600);});$(document).on('click','.modal-backdrop',function(){$(this).hide();var $mod=$('.modal.fade.zoom.in');$mod.modal('hide');});$(document).on('click','.special-cross',function(){$("#special").addClass("hidden");});$window.on({'resize':function(){},'load':function(){textCrop();}});$("#inputDateBirthMask").inputmask({skipInputEvent:true,skipKeyPressEvent:true,clearIncomplete:true,placeholder:"__.__.__",greedy:false,mask:"99.99.99"});$(".inputDateBirthMask").inputmask({skipInputEvent:true,skipKeyPressEvent:true,clearIncomplete:true,placeholder:"__.__.____",greedy:false,mask:"99.99.9999"});$(".inputPhoneMask").inputmask({constrainInput:true,skipInputEvent:true,skipKeyPressEvent:true,clearIncomplete:true,placeholder:"+7 ___-___-__-__",greedy:false,mask:"+7 ***-999-99-99"});$(".inputCodeMask").inputmask({skipInputEvent:true,skipKeyPressEvent:true,clearIncomplete:false,placeholder:"____",greedy:false,mask:"9999"});$(document).on("click",".bonus-page-question-box a",function(e){e.preventDefault();$(this).parent().find("i").toggleClass('open');$(this).parent().parent().find('ul').fadeToggle(400);});$(document).on("blur","#register_phone, #login_phone",function(e){var that=this;e.preventDefault();var val=$(that).val();if(val.length==0){return false;}
return true;});$(document).on("change","#register_phone, #login_phone",function(e){var that=this;e.preventDefault();var val=$(that).val();if(val.length==0){alert('Введите номер телефона');$(that).focus();return false;}
if(val.substr(3,1)=='8'||val.substr(3,1)=='7'){$(that).val('');alert('Ошибка в номере телефона '+val);$(that).focus();return false;}
return true;});$(document).on('click','.basket-demo',function(event){event.preventDefault();$(".basket-count").addClass('add');setTimeout(function(){$(".basket-count").removeClass('add');},1500);});$(document).on('click',function(e){if($(e.target).closest(".mm-city").length)return;$(document).find('.mm-city-link').parent().removeClass('active');});$('a[href^="##"]').click(function(){var elementClick=$(this).attr("href");var $anchor=$("[name='"+elementClick+"']");var destination=$anchor.offset().top+$anchor.height()-$('#mm-nav').height();$('html, body').animate({scrollTop:destination},1000);return false;});$(document).on('click','a[data-target="#gift-modal"]',function(){textCrop();});});$(function(){var wrapper=$(".file_upload"),inp=wrapper.find("input"),btn=wrapper.find("button");btn.click(function(){inp.click();});var file_api=(window.File&&window.FileReader&&window.FileList&&window.Blob)?true:false;inp.change(function(){var file_name;if(file_api&&inp[0].files[0])
file_name=inp[0].files[0].name;else
file_name=inp.val().replace("C:\\fakepath\\",'');if(!file_name.length)
return;btn.text(file_name);}).change();});function textCrop(){var $this;var $newsContent=$('.cat-item-text, .mob-cat-item-text');$.each($newsContent,function(){$this=$(this);var size=$this.data('crop');var newsText=$this.text();if(newsText.length>size){$this.text(newsText.slice(0,size)+'...');}});}
function stylerInit(){setTimeout(function(){$('select').styler({selectPlaceholder:""});},100);}
function preloaderKill(){setTimeout(function(){$(".preloader-box").fadeOut(300);},1500);}
function updateClock(){if($(".side-nav .timer").size()){var clock=$(".side-nav #timer-num");var minutes=$(".side-nav #timer-minutes");var t=[];t=getTimeRemaining(remainTime);clock.html(t.minutes);minutes.html(getMinutes(t.minutes));if(remainTime==-2){clearInterval(timeinterval);ms.getOrderTimer();}
--remainTime;}}
function getTimeRemaining(t){var minutes=Math.ceil(t / 60);var seconds=Math.floor(t%60);return{'total':t,'minutes':minutes,'seconds':seconds};}
function getMinutes(m){if(m<11||m>14){m=m.toString();switch(m[m.length-1]){case'1':return'минута';case'2':case'3':case'4':return'минуты';default:return'минут';}}else return'минут';}
function toclipboard(){var copyEmailBtn=document.querySelector('.js-copybtn');copyEmailBtn.addEventListener('click',function(event){var codeLink=document.querySelector('.js-codelink');var range=document.createRange();range.selectNode(codeLink);window.getSelection().addRange(range);try{var successful=document.execCommand('copy');var msg=successful?'successful':'unsuccessful';console.log('Copy email command was '+msg);}catch(err){console.log('Oops, unable to copy');}
window.getSelection().removeAllRanges();});}
function print_r(arr,level){var print_red_text="";if(!level)level=0;var level_padding="";for(var j=0;j<level+1;j++)level_padding+="    ";if(typeof(arr)=='object'){for(var item in arr){var value=arr[item];if(typeof(value)=='object'){print_red_text+=level_padding+"'"+item+"' :\n";print_red_text+=print_r(value,level+1);}
else
print_red_text+=level_padding+"'"+item+"' => \""+value+"\"\n";}}
else print_red_text="===>"+arr+"<===("+typeof(arr)+")";return print_red_text;}
function checkdate(month,day,year){var myDate=new Date(year,month-1,day);return((myDate.getMonth()+1)==month&&day<32);}
function utcZone(){var time=new Date();var tz=(String)(time.getTimezoneOffset()/60);if(tz<0){return tz.replace(/-/g,"+");}
if(tz>0){return"-"+tz;}
if(tz==0){return"0";}}
function bannerSliderInit(){$('#header-slider').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:6000,arrows:false,lazyLoad:'ondemand',dots:false});$('#header-slider-xs').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:6000,arrows:false,lazyLoad:'ondemand',dots:false});}
function bonusSliderInit(){$('#bonus-slider').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,dots:false,dotsClass:'slick-dots',autoplaySpeed:6000,arrows:true,dots:false});$('#bonus-slider-xs').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:6000,arrows:false,dots:false});}
function mainSliderInit(){$('#header-slider').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:6000,arrows:true,lazyLoad:'progressive',dots:true});$('#header-slider-xs').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:6000,arrows:false,lazyLoad:'progressive',dots:true});$(".header-slider-nav-left a, .header-slider-left a").click(function(e){e.preventDefault();$('#header-slider').slick('slickPrev');$('#header-slider-xs').slick('slickPrev');});$(".header-slider-nav-right a, .header-slider-right a").click(function(e){e.preventDefault();$('#header-slider').slick('slickNext');$('#header-slider-xs').slick('slickNext');});}
(function($){$.fn.textfill=function(options){var fontSize=options.maxFontPixels;var ourText=options.ourText;var maxWidth=$(this).width();var maxHeight=$(this).height();var textHeight;var textWidth;do{ourText.css('font-size',fontSize);textWidth=ourText.width();textHeight=ourText.height();fontSize=fontSize-1;}while((textWidth>maxWidth||textHeight>maxHeight)&&fontSize>5);return this;}})(jQuery);
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports!=='undefined'){module.exports=factory(require('jquery'));}else{factory(jQuery);}}(function($){'use strict';var Slick=window.Slick||{};Slick=(function(){var instanceUid=0;function Slick(element,settings){var _=this,dataSettings;_.defaults={accessibility:true,adaptiveHeight:false,appendArrows:$(element),appendDots:$(element),arrows:true,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:false,autoplaySpeed:3000,centerMode:false,centerPadding:'50px',cssEase:'ease',customPaging:function(slider,i){return'<button type="button" data-role="none" role="button" aria-required="false" tabindex="0">'+(i+1)+'</button>';},dots:false,dotsClass:'slick-dots',draggable:true,easing:'linear',edgeFriction:0.35,fade:false,focusOnSelect:false,infinite:true,initialSlide:0,lazyLoad:'ondemand',mobileFirst:false,pauseOnHover:true,pauseOnDotsHover:false,respondTo:'window',responsive:null,rows:1,rtl:false,slide:'',slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:true,swipeToSlide:false,touchMove:true,touchThreshold:5,useCSS:true,useTransform:false,variableWidth:false,vertical:false,verticalSwiping:false,waitForAnimate:true,zIndex:1000};_.initials={animating:false,dragging:false,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:false,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:false,unslicked:false};$.extend(_,_.initials);_.activeBreakpoint=null;_.animType=null;_.animProp=null;_.breakpoints=[];_.breakpointSettings=[];_.cssTransitions=false;_.hidden='hidden';_.paused=false;_.positionProp=null;_.respondTo=null;_.rowCount=1;_.shouldClick=true;_.$slider=$(element);_.$slidesCache=null;_.transformType=null;_.transitionType=null;_.visibilityChange='visibilitychange';_.windowWidth=0;_.windowTimer=null;dataSettings=$(element).data('slick')||{};_.options=$.extend({},_.defaults,dataSettings,settings);_.currentSlide=_.options.initialSlide;_.originalSettings=_.options;if(typeof document.mozHidden!=='undefined'){_.hidden='mozHidden';_.visibilityChange='mozvisibilitychange';}else if(typeof document.webkitHidden!=='undefined'){_.hidden='webkitHidden';_.visibilityChange='webkitvisibilitychange';}
_.autoPlay=$.proxy(_.autoPlay,_);_.autoPlayClear=$.proxy(_.autoPlayClear,_);_.changeSlide=$.proxy(_.changeSlide,_);_.clickHandler=$.proxy(_.clickHandler,_);_.selectHandler=$.proxy(_.selectHandler,_);_.setPosition=$.proxy(_.setPosition,_);_.swipeHandler=$.proxy(_.swipeHandler,_);_.dragHandler=$.proxy(_.dragHandler,_);_.keyHandler=$.proxy(_.keyHandler,_);_.autoPlayIterator=$.proxy(_.autoPlayIterator,_);_.instanceUid=instanceUid++;_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;_.registerBreakpoints();_.init(true);_.checkResponsive(true);}
return Slick;}());Slick.prototype.addSlide=Slick.prototype.slickAdd=function(markup,index,addBefore){var _=this;if(typeof(index)==='boolean'){addBefore=index;index=null;}else if(index<0||(index>=_.slideCount)){return false;}
_.unload();if(typeof(index)==='number'){if(index===0&&_.$slides.length===0){$(markup).appendTo(_.$slideTrack);}else if(addBefore){$(markup).insertBefore(_.$slides.eq(index));}else{$(markup).insertAfter(_.$slides.eq(index));}}else{if(addBefore===true){$(markup).prependTo(_.$slideTrack);}else{$(markup).appendTo(_.$slideTrack);}}
_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slides.each(function(index,element){$(element).attr('data-slick-index',index);});_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.animateHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.animate({height:targetHeight},_.options.speed);}};Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;_.animateHeight();if(_.options.rtl===true&&_.options.vertical===false){targetLeft=-targetLeft;}
if(_.transformsEnabled===false){if(_.options.vertical===false){_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback);}else{_.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback);}}else{if(_.cssTransitions===false){if(_.options.rtl===true){_.currentLeft=-(_.currentLeft);}
$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){now=Math.ceil(now);if(_.options.vertical===false){animProps[_.animType]='translate('+
now+'px, 0px)';_.$slideTrack.css(animProps);}else{animProps[_.animType]='translate(0px,'+
now+'px)';_.$slideTrack.css(animProps);}},complete:function(){if(callback){callback.call();}}});}else{_.applyTransition();targetLeft=Math.ceil(targetLeft);if(_.options.vertical===false){animProps[_.animType]='translate3d('+targetLeft+'px, 0px, 0px)';}else{animProps[_.animType]='translate3d(0px,'+targetLeft+'px, 0px)';}
_.$slideTrack.css(animProps);if(callback){setTimeout(function(){_.disableTransition();callback.call();},_.options.speed);}}}};Slick.prototype.asNavFor=function(index){var _=this,asNavFor=_.options.asNavFor;if(asNavFor&&asNavFor!==null){asNavFor=$(asNavFor).not(_.$slider);}
if(asNavFor!==null&&typeof asNavFor==='object'){asNavFor.each(function(){var target=$(this).slick('getSlick');if(!target.unslicked){target.slideHandler(index,true);}});}};Slick.prototype.applyTransition=function(slide){var _=this,transition={};if(_.options.fade===false){transition[_.transitionType]=_.transformType+' '+_.options.speed+'ms '+_.options.cssEase;}else{transition[_.transitionType]='opacity '+_.options.speed+'ms '+_.options.cssEase;}
if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.autoPlay=function(){var _=this;if(_.autoPlayTimer){clearInterval(_.autoPlayTimer);}
if(_.slideCount>_.options.slidesToShow&&_.paused!==true){_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed);}};Slick.prototype.autoPlayClear=function(){var _=this;if(_.autoPlayTimer){clearInterval(_.autoPlayTimer);}};Slick.prototype.autoPlayIterator=function(){var _=this;if(_.options.infinite===false){if(_.direction===1){if((_.currentSlide+1)===_.slideCount-
1){_.direction=0;}
_.slideHandler(_.currentSlide+_.options.slidesToScroll);}else{if((_.currentSlide-1===0)){_.direction=1;}
_.slideHandler(_.currentSlide-_.options.slidesToScroll);}}else{_.slideHandler(_.currentSlide+_.options.slidesToScroll);}};Slick.prototype.buildArrows=function(){var _=this;if(_.options.arrows===true){_.$prevArrow=$(_.options.prevArrow).addClass('slick-arrow');_.$nextArrow=$(_.options.nextArrow).addClass('slick-arrow');if(_.slideCount>_.options.slidesToShow){_.$prevArrow.removeClass('slick-hidden').removeAttr('aria-hidden tabindex');_.$nextArrow.removeClass('slick-hidden').removeAttr('aria-hidden tabindex');if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.prependTo(_.options.appendArrows);}
if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.appendTo(_.options.appendArrows);}
if(_.options.infinite!==true){_.$prevArrow.addClass('slick-disabled').attr('aria-disabled','true');}}else{_.$prevArrow.add(_.$nextArrow).addClass('slick-hidden').attr({'aria-disabled':'true','tabindex':'-1'});}}};Slick.prototype.buildDots=function(){var _=this,i,dotString;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){dotString='<ul class="'+_.options.dotsClass+'">';for(i=0;i<=_.getDotCount();i+=1){dotString+='<li>'+_.options.customPaging.call(this,_,i)+'</li>';}
dotString+='</ul>';_.$dots=$(dotString).appendTo(_.options.appendDots);_.$dots.find('li').first().addClass('slick-active').attr('aria-hidden','false');}};Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+':not(.slick-cloned)').addClass('slick-slide');_.slideCount=_.$slides.length;_.$slides.each(function(index,element){$(element).attr('data-slick-index',index).data('originalStyling',$(element).attr('style')||'');});_.$slider.addClass('slick-slider');_.$slideTrack=(_.slideCount===0)?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent();_.$list=_.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent();_.$slideTrack.css('opacity',0);if(_.options.centerMode===true||_.options.swipeToSlide===true){_.options.slidesToScroll=1;}
$('img[data-lazy]',_.$slider).not('[src]').addClass('slick-loading');_.setupInfinite();_.buildArrows();_.buildDots();_.updateDots();_.setSlideClasses(typeof _.currentSlide==='number'?_.currentSlide:0);if(_.options.draggable===true){_.$list.addClass('draggable');}};Slick.prototype.buildRows=function(){var _=this,a,b,c,newSlides,numOfSlides,originalSlides,slidesPerSection;newSlides=document.createDocumentFragment();originalSlides=_.$slider.children();if(_.options.rows>1){slidesPerSection=_.options.slidesPerRow*_.options.rows;numOfSlides=Math.ceil(originalSlides.length / slidesPerSection);for(a=0;a<numOfSlides;a++){var slide=document.createElement('div');for(b=0;b<_.options.rows;b++){var row=document.createElement('div');for(c=0;c<_.options.slidesPerRow;c++){var target=(a*slidesPerSection+((b*_.options.slidesPerRow)+c));if(originalSlides.get(target)){row.appendChild(originalSlides.get(target));}}
slide.appendChild(row);}
newSlides.appendChild(slide);}
_.$slider.html(newSlides);_.$slider.children().children().children().css({'width':(100 / _.options.slidesPerRow)+'%','display':'inline-block'});}};Slick.prototype.checkResponsive=function(initial,forceUpdate){var _=this,breakpoint,targetBreakpoint,respondToWidth,triggerBreakpoint=false;var sliderWidth=_.$slider.width();var windowWidth=window.innerWidth||$(window).width();if(_.respondTo==='window'){respondToWidth=windowWidth;}else if(_.respondTo==='slider'){respondToWidth=sliderWidth;}else if(_.respondTo==='min'){respondToWidth=Math.min(windowWidth,sliderWidth);}
if(_.options.responsive&&_.options.responsive.length&&_.options.responsive!==null){targetBreakpoint=null;for(breakpoint in _.breakpoints){if(_.breakpoints.hasOwnProperty(breakpoint)){if(_.originalSettings.mobileFirst===false){if(respondToWidth<_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}else{if(respondToWidth>_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}}}
if(targetBreakpoint!==null){if(_.activeBreakpoint!==null){if(targetBreakpoint!==_.activeBreakpoint||forceUpdate){_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==='unslick'){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);}
triggerBreakpoint=targetBreakpoint;}}else{_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==='unslick'){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);}
triggerBreakpoint=targetBreakpoint;}}else{if(_.activeBreakpoint!==null){_.activeBreakpoint=null;_.options=_.originalSettings;if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);triggerBreakpoint=targetBreakpoint;}}
if(!initial&&triggerBreakpoint!==false){_.$slider.trigger('breakpoint',[_,triggerBreakpoint]);}}};Slick.prototype.changeSlide=function(event,dontAnimate){var _=this,$target=$(event.target),indexOffset,slideOffset,unevenOffset;if($target.is('a')){event.preventDefault();}
if(!$target.is('li')){$target=$target.closest('li');}
unevenOffset=(_.slideCount%_.options.slidesToScroll!==0);indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll;switch(event.data.message){case'previous':slideOffset=indexOffset===0?_.options.slidesToScroll:_.options.slidesToShow-indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide-slideOffset,false,dontAnimate);}
break;case'next':slideOffset=indexOffset===0?_.options.slidesToScroll:indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide+slideOffset,false,dontAnimate);}
break;case'index':var index=event.data.index===0?0:event.data.index||$target.index()*_.options.slidesToScroll;_.slideHandler(_.checkNavigable(index),false,dontAnimate);$target.children().trigger('focus');break;default:return;}};Slick.prototype.checkNavigable=function(index){var _=this,navigables,prevNavigable;navigables=_.getNavigableIndexes();prevNavigable=0;if(index>navigables[navigables.length-1]){index=navigables[navigables.length-1];}else{for(var n in navigables){if(index<navigables[n]){index=prevNavigable;break;}
prevNavigable=navigables[n];}}
return index;};Slick.prototype.cleanUpEvents=function(){var _=this;if(_.options.dots&&_.$dots!==null){$('li',_.$dots).off('click.slick',_.changeSlide);if(_.options.pauseOnDotsHover===true&&_.options.autoplay===true){$('li',_.$dots).off('mouseenter.slick',$.proxy(_.setPaused,_,true)).off('mouseleave.slick',$.proxy(_.setPaused,_,false));}}
if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow&&_.$prevArrow.off('click.slick',_.changeSlide);_.$nextArrow&&_.$nextArrow.off('click.slick',_.changeSlide);}
_.$list.off('touchstart.slick mousedown.slick',_.swipeHandler);_.$list.off('touchmove.slick mousemove.slick',_.swipeHandler);_.$list.off('touchend.slick mouseup.slick',_.swipeHandler);_.$list.off('touchcancel.slick mouseleave.slick',_.swipeHandler);_.$list.off('click.slick',_.clickHandler);$(document).off(_.visibilityChange,_.visibility);_.$list.off('mouseenter.slick',$.proxy(_.setPaused,_,true));_.$list.off('mouseleave.slick',$.proxy(_.setPaused,_,false));if(_.options.accessibility===true){_.$list.off('keydown.slick',_.keyHandler);}
if(_.options.focusOnSelect===true){$(_.$slideTrack).children().off('click.slick',_.selectHandler);}
$(window).off('orientationchange.slick.slick-'+_.instanceUid,_.orientationChange);$(window).off('resize.slick.slick-'+_.instanceUid,_.resize);$('[draggable!=true]',_.$slideTrack).off('dragstart',_.preventDefault);$(window).off('load.slick.slick-'+_.instanceUid,_.setPosition);$(document).off('ready.slick.slick-'+_.instanceUid,_.setPosition);};Slick.prototype.cleanUpRows=function(){var _=this,originalSlides;if(_.options.rows>1){originalSlides=_.$slides.children().children();originalSlides.removeAttr('style');_.$slider.html(originalSlides);}};Slick.prototype.clickHandler=function(event){var _=this;if(_.shouldClick===false){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();}};Slick.prototype.destroy=function(refresh){var _=this;_.autoPlayClear();_.touchObject={};_.cleanUpEvents();$('.slick-cloned',_.$slider).detach();if(_.$dots){_.$dots.remove();}
if(_.$prevArrow&&_.$prevArrow.length){_.$prevArrow.removeClass('slick-disabled slick-arrow slick-hidden').removeAttr('aria-hidden aria-disabled tabindex').css("display","");if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}}
if(_.$nextArrow&&_.$nextArrow.length){_.$nextArrow.removeClass('slick-disabled slick-arrow slick-hidden').removeAttr('aria-hidden aria-disabled tabindex').css("display","");if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}}
if(_.$slides){_.$slides.removeClass('slick-slide slick-active slick-center slick-visible slick-current').removeAttr('aria-hidden').removeAttr('data-slick-index').each(function(){$(this).attr('style',$(this).data('originalStyling'));});_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.detach();_.$list.detach();_.$slider.append(_.$slides);}
_.cleanUpRows();_.$slider.removeClass('slick-slider');_.$slider.removeClass('slick-initialized');_.unslicked=true;if(!refresh){_.$slider.trigger('destroy',[_]);}};Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]='';if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.fadeSlide=function(slideIndex,callback){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).css({zIndex:_.options.zIndex});_.$slides.eq(slideIndex).animate({opacity:1},_.options.speed,_.options.easing,callback);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:1,zIndex:_.options.zIndex});if(callback){setTimeout(function(){_.disableTransition(slideIndex);callback.call();},_.options.speed);}}};Slick.prototype.fadeSlideOut=function(slideIndex){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).animate({opacity:0,zIndex:_.options.zIndex-2},_.options.speed,_.options.easing);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:0,zIndex:_.options.zIndex-2});}};Slick.prototype.filterSlides=Slick.prototype.slickFilter=function(filter){var _=this;if(filter!==null){_.$slidesCache=_.$slides;_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.filter(filter).appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.getCurrent=Slick.prototype.slickCurrentSlide=function(){var _=this;return _.currentSlide;};Slick.prototype.getDotCount=function(){var _=this;var breakPoint=0;var counter=0;var pagerQty=0;if(_.options.infinite===true){while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}else if(_.options.centerMode===true){pagerQty=_.slideCount;}else{while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}
return pagerQty-1;};Slick.prototype.getLeft=function(slideIndex){var _=this,targetLeft,verticalHeight,verticalOffset=0,targetSlide;_.slideOffset=0;verticalHeight=_.$slides.first().outerHeight(true);if(_.options.infinite===true){if(_.slideCount>_.options.slidesToShow){_.slideOffset=(_.slideWidth*_.options.slidesToShow)*-1;verticalOffset=(verticalHeight*_.options.slidesToShow)*-1;}
if(_.slideCount%_.options.slidesToScroll!==0){if(slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow){if(slideIndex>_.slideCount){_.slideOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*_.slideWidth)*-1;verticalOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*verticalHeight)*-1;}else{_.slideOffset=((_.slideCount%_.options.slidesToScroll)*_.slideWidth)*-1;verticalOffset=((_.slideCount%_.options.slidesToScroll)*verticalHeight)*-1;}}}}else{if(slideIndex+_.options.slidesToShow>_.slideCount){_.slideOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*_.slideWidth;verticalOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*verticalHeight;}}
if(_.slideCount<=_.options.slidesToShow){_.slideOffset=0;verticalOffset=0;}
if(_.options.centerMode===true&&_.options.infinite===true){_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow / 2)-_.slideWidth;}else if(_.options.centerMode===true){_.slideOffset=0;_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow / 2);}
if(_.options.vertical===false){targetLeft=((slideIndex*_.slideWidth)*-1)+_.slideOffset;}else{targetLeft=((slideIndex*verticalHeight)*-1)+verticalOffset;}
if(_.options.variableWidth===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex);}else{targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex+_.options.slidesToShow);}
if(_.options.rtl===true){if(targetSlide[0]){targetLeft=(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1;}else{targetLeft=0;}}else{targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;}
if(_.options.centerMode===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex);}else{targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex+_.options.slidesToShow+1);}
if(_.options.rtl===true){if(targetSlide[0]){targetLeft=(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1;}else{targetLeft=0;}}else{targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;}
targetLeft+=(_.$list.width()-targetSlide.outerWidth())/ 2;}}
return targetLeft;};Slick.prototype.getOption=Slick.prototype.slickGetOption=function(option){var _=this;return _.options[option];};Slick.prototype.getNavigableIndexes=function(){var _=this,breakPoint=0,counter=0,indexes=[],max;if(_.options.infinite===false){max=_.slideCount;}else{breakPoint=_.options.slidesToScroll*-1;counter=_.options.slidesToScroll*-1;max=_.slideCount*2;}
while(breakPoint<max){indexes.push(breakPoint);breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}
return indexes;};Slick.prototype.getSlick=function(){return this;};Slick.prototype.getSlideCount=function(){var _=this,slidesTraversed,swipedSlide,centerOffset;centerOffset=_.options.centerMode===true?_.slideWidth*Math.floor(_.options.slidesToShow / 2):0;if(_.options.swipeToSlide===true){_.$slideTrack.find('.slick-slide').each(function(index,slide){if(slide.offsetLeft-centerOffset+($(slide).outerWidth()/ 2)>(_.swipeLeft*-1)){swipedSlide=slide;return false;}});slidesTraversed=Math.abs($(swipedSlide).attr('data-slick-index')-_.currentSlide)||1;return slidesTraversed;}else{return _.options.slidesToScroll;}};Slick.prototype.goTo=Slick.prototype.slickGoTo=function(slide,dontAnimate){var _=this;_.changeSlide({data:{message:'index',index:parseInt(slide)}},dontAnimate);};Slick.prototype.init=function(creation){var _=this;if(!$(_.$slider).hasClass('slick-initialized')){$(_.$slider).addClass('slick-initialized');_.buildRows();_.buildOut();_.setProps();_.startLoad();_.loadSlider();_.initializeEvents();_.updateArrows();_.updateDots();}
if(creation){_.$slider.trigger('init',[_]);}
if(_.options.accessibility===true){_.initADA();}};Slick.prototype.initArrowEvents=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.on('click.slick',{message:'previous'},_.changeSlide);_.$nextArrow.on('click.slick',{message:'next'},_.changeSlide);}};Slick.prototype.initDotEvents=function(){var _=this;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){$('li',_.$dots).on('click.slick',{message:'index'},_.changeSlide);}
if(_.options.dots===true&&_.options.pauseOnDotsHover===true&&_.options.autoplay===true){$('li',_.$dots).on('mouseenter.slick',$.proxy(_.setPaused,_,true)).on('mouseleave.slick',$.proxy(_.setPaused,_,false));}};Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents();_.initDotEvents();_.$list.on('touchstart.slick mousedown.slick',{action:'start'},_.swipeHandler);_.$list.on('touchmove.slick mousemove.slick',{action:'move'},_.swipeHandler);_.$list.on('touchend.slick mouseup.slick',{action:'end'},_.swipeHandler);_.$list.on('touchcancel.slick mouseleave.slick',{action:'end'},_.swipeHandler);_.$list.on('click.slick',_.clickHandler);$(document).on(_.visibilityChange,$.proxy(_.visibility,_));_.$list.on('mouseenter.slick',$.proxy(_.setPaused,_,true));_.$list.on('mouseleave.slick',$.proxy(_.setPaused,_,false));if(_.options.accessibility===true){_.$list.on('keydown.slick',_.keyHandler);}
if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on('click.slick',_.selectHandler);}
$(window).on('orientationchange.slick.slick-'+_.instanceUid,$.proxy(_.orientationChange,_));$(window).on('resize.slick.slick-'+_.instanceUid,$.proxy(_.resize,_));$('[draggable!=true]',_.$slideTrack).on('dragstart',_.preventDefault);$(window).on('load.slick.slick-'+_.instanceUid,_.setPosition);$(document).on('ready.slick.slick-'+_.instanceUid,_.setPosition);};Slick.prototype.initUI=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.show();_.$nextArrow.show();}
if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.show();}
if(_.options.autoplay===true){_.autoPlay();}};Slick.prototype.keyHandler=function(event){var _=this;if(!event.target.tagName.match('TEXTAREA|INPUT|SELECT')){if(event.keyCode===37&&_.options.accessibility===true){_.changeSlide({data:{message:'previous'}});}else if(event.keyCode===39&&_.options.accessibility===true){_.changeSlide({data:{message:'next'}});}}};Slick.prototype.lazyLoad=function(){var _=this,loadRange,cloneRange,rangeStart,rangeEnd;function loadImages(imagesScope){$('img[data-lazy]',imagesScope).each(function(){var image=$(this),imageSource=$(this).attr('data-lazy'),imageToLoad=document.createElement('img');imageToLoad.onload=function(){image.animate({opacity:0},100,function(){image.attr('src',imageSource).animate({opacity:1},200,function(){image.removeAttr('data-lazy').removeClass('slick-loading');});});};imageToLoad.src=imageSource;});}
if(_.options.centerMode===true){if(_.options.infinite===true){rangeStart=_.currentSlide+(_.options.slidesToShow / 2+1);rangeEnd=rangeStart+_.options.slidesToShow+2;}else{rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow / 2+1));rangeEnd=2+(_.options.slidesToShow / 2+1)+_.currentSlide;}}else{rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide;rangeEnd=rangeStart+_.options.slidesToShow;if(_.options.fade===true){if(rangeStart>0)rangeStart--;if(rangeEnd<=_.slideCount)rangeEnd++;}}
loadRange=_.$slider.find('.slick-slide').slice(rangeStart,rangeEnd);loadImages(loadRange);if(_.slideCount<=_.options.slidesToShow){cloneRange=_.$slider.find('.slick-slide');loadImages(cloneRange);}else
if(_.currentSlide>=_.slideCount-_.options.slidesToShow){cloneRange=_.$slider.find('.slick-cloned').slice(0,_.options.slidesToShow);loadImages(cloneRange);}else if(_.currentSlide===0){cloneRange=_.$slider.find('.slick-cloned').slice(_.options.slidesToShow*-1);loadImages(cloneRange);}};Slick.prototype.loadSlider=function(){var _=this;_.setPosition();_.$slideTrack.css({opacity:1});_.$slider.removeClass('slick-loading');_.initUI();if(_.options.lazyLoad==='progressive'){_.progressiveLazyLoad();}};Slick.prototype.next=Slick.prototype.slickNext=function(){var _=this;_.changeSlide({data:{message:'next'}});};Slick.prototype.orientationChange=function(){var _=this;_.checkResponsive();_.setPosition();};Slick.prototype.pause=Slick.prototype.slickPause=function(){var _=this;_.autoPlayClear();_.paused=true;};Slick.prototype.play=Slick.prototype.slickPlay=function(){var _=this;_.paused=false;_.autoPlay();};Slick.prototype.postSlide=function(index){var _=this;_.$slider.trigger('afterChange',[_,index]);_.animating=false;_.setPosition();_.swipeLeft=null;if(_.options.autoplay===true&&_.paused===false){_.autoPlay();}
if(_.options.accessibility===true){_.initADA();}};Slick.prototype.prev=Slick.prototype.slickPrev=function(){var _=this;_.changeSlide({data:{message:'previous'}});};Slick.prototype.preventDefault=function(event){event.preventDefault();};Slick.prototype.progressiveLazyLoad=function(){var _=this,imgCount,targetImage;imgCount=$('img[data-lazy]',_.$slider).length;if(imgCount>0){targetImage=$('img[data-lazy]',_.$slider).first();targetImage.attr('src',null);targetImage.attr('src',targetImage.attr('data-lazy')).removeClass('slick-loading').load(function(){targetImage.removeAttr('data-lazy');_.progressiveLazyLoad();if(_.options.adaptiveHeight===true){_.setPosition();}}).error(function(){targetImage.removeAttr('data-lazy');_.progressiveLazyLoad();});}};Slick.prototype.refresh=function(initializing){var _=this,currentSlide,firstVisible;firstVisible=_.slideCount-_.options.slidesToShow;if(!_.options.infinite){if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}else if(_.currentSlide>firstVisible){_.currentSlide=firstVisible;}}
currentSlide=_.currentSlide;_.destroy(true);$.extend(_,_.initials,{currentSlide:currentSlide});_.init();if(!initializing){_.changeSlide({data:{message:'index',index:currentSlide}},false);}};Slick.prototype.registerBreakpoints=function(){var _=this,breakpoint,currentBreakpoint,l,responsiveSettings=_.options.responsive||null;if($.type(responsiveSettings)==="array"&&responsiveSettings.length){_.respondTo=_.options.respondTo||'window';for(breakpoint in responsiveSettings){l=_.breakpoints.length-1;currentBreakpoint=responsiveSettings[breakpoint].breakpoint;if(responsiveSettings.hasOwnProperty(breakpoint)){while(l>=0){if(_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint){_.breakpoints.splice(l,1);}
l--;}
_.breakpoints.push(currentBreakpoint);_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].settings;}}
_.breakpoints.sort(function(a,b){return(_.options.mobileFirst)?a-b:b-a;});}};Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass('slick-slide');_.slideCount=_.$slides.length;if(_.currentSlide>=_.slideCount&&_.currentSlide!==0){_.currentSlide=_.currentSlide-_.options.slidesToScroll;}
if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}
_.registerBreakpoints();_.setProps();_.setupInfinite();_.buildArrows();_.updateArrows();_.initArrowEvents();_.buildDots();_.updateDots();_.initDotEvents();_.checkResponsive(false,true);if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on('click.slick',_.selectHandler);}
_.setSlideClasses(0);_.setPosition();_.$slider.trigger('reInit',[_]);if(_.options.autoplay===true){_.focusHandler();}};Slick.prototype.resize=function(){var _=this;if($(window).width()!==_.windowWidth){clearTimeout(_.windowDelay);_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width();_.checkResponsive();if(!_.unslicked){_.setPosition();}},50);}};Slick.prototype.removeSlide=Slick.prototype.slickRemove=function(index,removeBefore,removeAll){var _=this;if(typeof(index)==='boolean'){removeBefore=index;index=removeBefore===true?0:_.slideCount-1;}else{index=removeBefore===true?--index:index;}
if(_.slideCount<1||index<0||index>_.slideCount-1){return false;}
_.unload();if(removeAll===true){_.$slideTrack.children().remove();}else{_.$slideTrack.children(this.options.slide).eq(index).remove();}
_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.setCSS=function(position){var _=this,positionProps={},x,y;if(_.options.rtl===true){position=-position;}
x=_.positionProp=='left'?Math.ceil(position)+'px':'0px';y=_.positionProp=='top'?Math.ceil(position)+'px':'0px';positionProps[_.positionProp]=position;if(_.transformsEnabled===false){_.$slideTrack.css(positionProps);}else{positionProps={};if(_.cssTransitions===false){positionProps[_.animType]='translate('+x+', '+y+')';_.$slideTrack.css(positionProps);}else{positionProps[_.animType]='translate3d('+x+', '+y+', 0px)';_.$slideTrack.css(positionProps);}}};Slick.prototype.setDimensions=function(){var _=this;if(_.options.vertical===false){if(_.options.centerMode===true){_.$list.css({padding:('0px '+_.options.centerPadding)});}}else{_.$list.height(_.$slides.first().outerHeight(true)*_.options.slidesToShow);if(_.options.centerMode===true){_.$list.css({padding:(_.options.centerPadding+' 0px')});}}
_.listWidth=_.$list.width();_.listHeight=_.$list.height();if(_.options.vertical===false&&_.options.variableWidth===false){_.slideWidth=Math.ceil(_.listWidth / _.options.slidesToShow);_.$slideTrack.width(Math.ceil((_.slideWidth*_.$slideTrack.children('.slick-slide').length)));}else if(_.options.variableWidth===true){_.$slideTrack.width(5000*_.slideCount);}else{_.slideWidth=Math.ceil(_.listWidth);_.$slideTrack.height(Math.ceil((_.$slides.first().outerHeight(true)*_.$slideTrack.children('.slick-slide').length)));}
var offset=_.$slides.first().outerWidth(true)-_.$slides.first().width();if(_.options.variableWidth===false)_.$slideTrack.children('.slick-slide').width(_.slideWidth-offset);};Slick.prototype.setFade=function(){var _=this,targetLeft;_.$slides.each(function(index,element){targetLeft=(_.slideWidth*index)*-1;if(_.options.rtl===true){$(element).css({position:'relative',right:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}else{$(element).css({position:'relative',left:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}});_.$slides.eq(_.currentSlide).css({zIndex:_.options.zIndex-1,opacity:1});};Slick.prototype.setHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.css('height',targetHeight);}};Slick.prototype.setOption=Slick.prototype.slickSetOption=function(option,value,refresh){var _=this,l,item;if(option==="responsive"&&$.type(value)==="array"){for(item in value){if($.type(_.options.responsive)!=="array"){_.options.responsive=[value[item]];}else{l=_.options.responsive.length-1;while(l>=0){if(_.options.responsive[l].breakpoint===value[item].breakpoint){_.options.responsive.splice(l,1);}
l--;}
_.options.responsive.push(value[item]);}}}else{_.options[option]=value;}
if(refresh===true){_.unload();_.reinit();}};Slick.prototype.setPosition=function(){var _=this;_.setDimensions();_.setHeight();if(_.options.fade===false){_.setCSS(_.getLeft(_.currentSlide));}else{_.setFade();}
_.$slider.trigger('setPosition',[_]);};Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===true?'top':'left';if(_.positionProp==='top'){_.$slider.addClass('slick-vertical');}else{_.$slider.removeClass('slick-vertical');}
if(bodyStyle.WebkitTransition!==undefined||bodyStyle.MozTransition!==undefined||bodyStyle.msTransition!==undefined){if(_.options.useCSS===true){_.cssTransitions=true;}}
if(_.options.fade){if(typeof _.options.zIndex==='number'){if(_.options.zIndex<3){_.options.zIndex=3;}}else{_.options.zIndex=_.defaults.zIndex;}}
if(bodyStyle.OTransform!==undefined){_.animType='OTransform';_.transformType='-o-transform';_.transitionType='OTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false;}
if(bodyStyle.MozTransform!==undefined){_.animType='MozTransform';_.transformType='-moz-transform';_.transitionType='MozTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.MozPerspective===undefined)_.animType=false;}
if(bodyStyle.webkitTransform!==undefined){_.animType='webkitTransform';_.transformType='-webkit-transform';_.transitionType='webkitTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false;}
if(bodyStyle.msTransform!==undefined){_.animType='msTransform';_.transformType='-ms-transform';_.transitionType='msTransition';if(bodyStyle.msTransform===undefined)_.animType=false;}
if(bodyStyle.transform!==undefined&&_.animType!==false){_.animType='transform';_.transformType='transform';_.transitionType='transition';}
_.transformsEnabled=_.options.useTransform&&(_.animType!==null&&_.animType!==false);};Slick.prototype.setSlideClasses=function(index){var _=this,centerOffset,allSlides,indexOffset,remainder;allSlides=_.$slider.find('.slick-slide').removeClass('slick-active slick-center slick-current').attr('aria-hidden','true');_.$slides.eq(index).addClass('slick-current');if(_.options.centerMode===true){centerOffset=Math.floor(_.options.slidesToShow / 2);if(_.options.infinite===true){if(index>=centerOffset&&index<=(_.slideCount-1)-centerOffset){_.$slides.slice(index-centerOffset,index+centerOffset+1).addClass('slick-active').attr('aria-hidden','false');}else{indexOffset=_.options.slidesToShow+index;allSlides.slice(indexOffset-centerOffset+1,indexOffset+centerOffset+2).addClass('slick-active').attr('aria-hidden','false');}
if(index===0){allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass('slick-center');}else if(index===_.slideCount-1){allSlides.eq(_.options.slidesToShow).addClass('slick-center');}}
_.$slides.eq(index).addClass('slick-center');}else{if(index>=0&&index<=(_.slideCount-_.options.slidesToShow)){_.$slides.slice(index,index+_.options.slidesToShow).addClass('slick-active').attr('aria-hidden','false');}else if(allSlides.length<=_.options.slidesToShow){allSlides.addClass('slick-active').attr('aria-hidden','false');}else{remainder=_.slideCount%_.options.slidesToShow;indexOffset=_.options.infinite===true?_.options.slidesToShow+index:index;if(_.options.slidesToShow==_.options.slidesToScroll&&(_.slideCount-index)<_.options.slidesToShow){allSlides.slice(indexOffset-(_.options.slidesToShow-remainder),indexOffset+remainder).addClass('slick-active').attr('aria-hidden','false');}else{allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass('slick-active').attr('aria-hidden','false');}}}
if(_.options.lazyLoad==='ondemand'){_.lazyLoad();}};Slick.prototype.setupInfinite=function(){var _=this,i,slideIndex,infiniteCount;if(_.options.fade===true){_.options.centerMode=false;}
if(_.options.infinite===true&&_.options.fade===false){slideIndex=null;if(_.slideCount>_.options.slidesToShow){if(_.options.centerMode===true){infiniteCount=_.options.slidesToShow+1;}else{infiniteCount=_.options.slidesToShow;}
for(i=_.slideCount;i>(_.slideCount-
infiniteCount);i-=1){slideIndex=i-1;$(_.$slides[slideIndex]).clone(true).attr('id','').attr('data-slick-index',slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass('slick-cloned');}
for(i=0;i<infiniteCount;i+=1){slideIndex=i;$(_.$slides[slideIndex]).clone(true).attr('id','').attr('data-slick-index',slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass('slick-cloned');}
_.$slideTrack.find('.slick-cloned').find('[id]').each(function(){$(this).attr('id','');});}}};Slick.prototype.setPaused=function(paused){var _=this;if(_.options.autoplay===true&&_.options.pauseOnHover===true){_.paused=paused;if(!paused){_.autoPlay();}else{_.autoPlayClear();}}};Slick.prototype.selectHandler=function(event){var _=this;var targetElement=$(event.target).is('.slick-slide')?$(event.target):$(event.target).parents('.slick-slide');var index=parseInt(targetElement.attr('data-slick-index'));if(!index)index=0;if(_.slideCount<=_.options.slidesToShow){_.setSlideClasses(index);_.asNavFor(index);return;}
_.slideHandler(index);};Slick.prototype.slideHandler=function(index,sync,dontAnimate){var targetSlide,animSlide,oldSlide,slideLeft,targetLeft=null,_=this;sync=sync||false;if(_.animating===true&&_.options.waitForAnimate===true){return;}
if(_.options.fade===true&&_.currentSlide===index){return;}
if(_.slideCount<=_.options.slidesToShow){return;}
if(sync===false){_.asNavFor(index);}
targetSlide=index;targetLeft=_.getLeft(targetSlide);slideLeft=_.getLeft(_.currentSlide);_.currentLeft=_.swipeLeft===null?slideLeft:_.swipeLeft;if(_.options.infinite===false&&_.options.centerMode===false&&(index<0||index>_.getDotCount()*_.options.slidesToScroll)){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}
return;}else if(_.options.infinite===false&&_.options.centerMode===true&&(index<0||index>(_.slideCount-_.options.slidesToScroll))){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}
return;}
if(_.options.autoplay===true){clearInterval(_.autoPlayTimer);}
if(targetSlide<0){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=_.slideCount-(_.slideCount%_.options.slidesToScroll);}else{animSlide=_.slideCount+targetSlide;}}else if(targetSlide>=_.slideCount){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=0;}else{animSlide=targetSlide-_.slideCount;}}else{animSlide=targetSlide;}
_.animating=true;_.$slider.trigger('beforeChange',[_,_.currentSlide,animSlide]);oldSlide=_.currentSlide;_.currentSlide=animSlide;_.setSlideClasses(_.currentSlide);_.updateDots();_.updateArrows();if(_.options.fade===true){if(dontAnimate!==true){_.fadeSlideOut(oldSlide);_.fadeSlide(animSlide,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}
_.animateHeight();return;}
if(dontAnimate!==true){_.animateSlide(targetLeft,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}};Slick.prototype.startLoad=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.hide();_.$nextArrow.hide();}
if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.hide();}
_.$slider.addClass('slick-loading');};Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;xDist=_.touchObject.startX-_.touchObject.curX;yDist=_.touchObject.startY-_.touchObject.curY;r=Math.atan2(yDist,xDist);swipeAngle=Math.round(r*180 / Math.PI);if(swipeAngle<0){swipeAngle=360-Math.abs(swipeAngle);}
if((swipeAngle<=45)&&(swipeAngle>=0)){return(_.options.rtl===false?'left':'right');}
if((swipeAngle<=360)&&(swipeAngle>=315)){return(_.options.rtl===false?'left':'right');}
if((swipeAngle>=135)&&(swipeAngle<=225)){return(_.options.rtl===false?'right':'left');}
if(_.options.verticalSwiping===true){if((swipeAngle>=35)&&(swipeAngle<=135)){return'left';}else{return'right';}}
return'vertical';};Slick.prototype.swipeEnd=function(event){var _=this,slideCount;_.dragging=false;_.shouldClick=(_.touchObject.swipeLength>10)?false:true;if(_.touchObject.curX===undefined){return false;}
if(_.touchObject.edgeHit===true){_.$slider.trigger('edge',[_,_.swipeDirection()]);}
if(_.touchObject.swipeLength>=_.touchObject.minSwipe){switch(_.swipeDirection()){case'left':slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide+_.getSlideCount()):_.currentSlide+_.getSlideCount();_.slideHandler(slideCount);_.currentDirection=0;_.touchObject={};_.$slider.trigger('swipe',[_,'left']);break;case'right':slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide-_.getSlideCount()):_.currentSlide-_.getSlideCount();_.slideHandler(slideCount);_.currentDirection=1;_.touchObject={};_.$slider.trigger('swipe',[_,'right']);break;}}else{if(_.touchObject.startX!==_.touchObject.curX){_.slideHandler(_.currentSlide);_.touchObject={};}}};Slick.prototype.swipeHandler=function(event){var _=this;if((_.options.swipe===false)||('ontouchend'in document&&_.options.swipe===false)){return;}else if(_.options.draggable===false&&event.type.indexOf('mouse')!==-1){return;}
_.touchObject.fingerCount=event.originalEvent&&event.originalEvent.touches!==undefined?event.originalEvent.touches.length:1;_.touchObject.minSwipe=_.listWidth / _.options.touchThreshold;if(_.options.verticalSwiping===true){_.touchObject.minSwipe=_.listHeight / _.options.touchThreshold;}
switch(event.data.action){case'start':_.swipeStart(event);break;case'move':_.swipeMove(event);break;case'end':_.swipeEnd(event);break;}};Slick.prototype.swipeMove=function(event){var _=this,edgeWasHit=false,curLeft,swipeDirection,swipeLength,positionOffset,touches;touches=event.originalEvent!==undefined?event.originalEvent.touches:null;if(!_.dragging||touches&&touches.length!==1){return false;}
curLeft=_.getLeft(_.currentSlide);_.touchObject.curX=touches!==undefined?touches[0].pageX:event.clientX;_.touchObject.curY=touches!==undefined?touches[0].pageY:event.clientY;_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-_.touchObject.startX,2)));if(_.options.verticalSwiping===true){_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curY-_.touchObject.startY,2)));}
swipeDirection=_.swipeDirection();if(swipeDirection==='vertical'){return;}
if(event.originalEvent!==undefined&&_.touchObject.swipeLength>4){event.preventDefault();}
positionOffset=(_.options.rtl===false?1:-1)*(_.touchObject.curX>_.touchObject.startX?1:-1);if(_.options.verticalSwiping===true){positionOffset=_.touchObject.curY>_.touchObject.startY?1:-1;}
swipeLength=_.touchObject.swipeLength;_.touchObject.edgeHit=false;if(_.options.infinite===false){if((_.currentSlide===0&&swipeDirection==='right')||(_.currentSlide>=_.getDotCount()&&swipeDirection==='left')){swipeLength=_.touchObject.swipeLength*_.options.edgeFriction;_.touchObject.edgeHit=true;}}
if(_.options.vertical===false){_.swipeLeft=curLeft+swipeLength*positionOffset;}else{_.swipeLeft=curLeft+(swipeLength*(_.$list.height()/ _.listWidth))*positionOffset;}
if(_.options.verticalSwiping===true){_.swipeLeft=curLeft+swipeLength*positionOffset;}
if(_.options.fade===true||_.options.touchMove===false){return false;}
if(_.animating===true){_.swipeLeft=null;return false;}
_.setCSS(_.swipeLeft);};Slick.prototype.swipeStart=function(event){var _=this,touches;if(_.touchObject.fingerCount!==1||_.slideCount<=_.options.slidesToShow){_.touchObject={};return false;}
if(event.originalEvent!==undefined&&event.originalEvent.touches!==undefined){touches=event.originalEvent.touches[0];}
_.touchObject.startX=_.touchObject.curX=touches!==undefined?touches.pageX:event.clientX;_.touchObject.startY=_.touchObject.curY=touches!==undefined?touches.pageY:event.clientY;_.dragging=true;};Slick.prototype.unfilterSlides=Slick.prototype.slickUnfilter=function(){var _=this;if(_.$slidesCache!==null){_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.unload=function(){var _=this;$('.slick-cloned',_.$slider).remove();if(_.$dots){_.$dots.remove();}
if(_.$prevArrow&&_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}
if(_.$nextArrow&&_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}
_.$slides.removeClass('slick-slide slick-active slick-visible slick-current').attr('aria-hidden','true').css('width','');};Slick.prototype.unslick=function(fromBreakpoint){var _=this;_.$slider.trigger('unslick',[_,fromBreakpoint]);_.destroy();};Slick.prototype.updateArrows=function(){var _=this,centerOffset;centerOffset=Math.floor(_.options.slidesToShow / 2);if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow&&!_.options.infinite){_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');_.$nextArrow.removeClass('slick-disabled').attr('aria-disabled','false');if(_.currentSlide===0){_.$prevArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$nextArrow.removeClass('slick-disabled').attr('aria-disabled','false');}else if(_.currentSlide>=_.slideCount-_.options.slidesToShow&&_.options.centerMode===false){_.$nextArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');}else if(_.currentSlide>=_.slideCount-1&&_.options.centerMode===true){_.$nextArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');}}};Slick.prototype.updateDots=function(){var _=this;if(_.$dots!==null){_.$dots.find('li').removeClass('slick-active').attr('aria-hidden','true');_.$dots.find('li').eq(Math.floor(_.currentSlide / _.options.slidesToScroll)).addClass('slick-active').attr('aria-hidden','false');}};Slick.prototype.visibility=function(){var _=this;if(document[_.hidden]){_.paused=true;_.autoPlayClear();}else{if(_.options.autoplay===true){_.paused=false;_.autoPlay();}}};Slick.prototype.initADA=function(){var _=this;_.$slides.add(_.$slideTrack.find('.slick-cloned')).attr({'aria-hidden':'true','tabindex':'-1'}).find('a, input, button, select').attr({'tabindex':'-1'});_.$slideTrack.attr('role','listbox');_.$slides.not(_.$slideTrack.find('.slick-cloned')).each(function(i){$(this).attr({'role':'option','aria-describedby':'slick-slide'+_.instanceUid+i+''});});if(_.$dots!==null){_.$dots.attr('role','tablist').find('li').each(function(i){$(this).attr({'role':'presentation','aria-selected':'false','aria-controls':'navigation'+_.instanceUid+i+'','id':'slick-slide'+_.instanceUid+i+''});}).first().attr('aria-selected','true').end().find('button').attr('role','button').end().closest('div').attr('role','toolbar');}
_.activateADA();};Slick.prototype.activateADA=function(){var _=this;_.$slideTrack.find('.slick-active').attr({'aria-hidden':'false'}).find('a, input, button, select').attr({'tabindex':'0'});};Slick.prototype.focusHandler=function(){var _=this;_.$slider.on('focus.slick blur.slick','*',function(event){event.stopImmediatePropagation();var sf=$(this);setTimeout(function(){if(_.isPlay){if(sf.is(':focus')){_.autoPlayClear();_.paused=true;}else{_.paused=false;_.autoPlay();}}},0);});};$.fn.slick=function(){var _=this,opt=arguments[0],args=Array.prototype.slice.call(arguments,1),l=_.length,i,ret;for(i=0;i<l;i++){if(typeof opt=='object'||typeof opt=='undefined')
_[i].slick=new Slick(_[i],opt);else
ret=_[i].slick[opt].apply(_[i].slick,args);if(typeof ret!='undefined')return ret;}
return _;};}));
;(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{factory(jQuery);}}(function($){'use strict';var pluginName='styler',defaults={wrapper:'form',idSuffix:'-styler',filePlaceholder:'Файл не выбран',fileBrowse:'Обзор...',fileNumber:'Выбрано файлов: %s',selectPlaceholder:'Выберите...',selectSearch:false,selectSearchLimit:10,selectSearchNotFound:'Совпадений не найдено',selectSearchPlaceholder:'Поиск...',selectVisibleOptions:0,singleSelectzIndex:'100',selectSmartPositioning:true,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};function Plugin(element,options){this.element=element;this.options=$.extend({},defaults,options);this.init();}
Plugin.prototype={init:function(){var el=$(this.element);var opt=this.options;var iOS=(navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i))?true:false;var Android=(navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i))?true:false;function Attributes(){var id='',title='',classes='',dataList='';if(el.attr('id')!==undefined&&el.attr('id')!=='')id=' id="'+el.attr('id')+opt.idSuffix+'"';if(el.attr('title')!==undefined&&el.attr('title')!=='')title=' title="'+el.attr('title')+'"';if(el.attr('class')!==undefined&&el.attr('class')!=='')classes=' '+el.attr('class');var data=el.data();for(var i in data){if(data[i]!==''&&i!=='_styler')dataList+=' data-'+i+'="'+data[i]+'"';}
id+=dataList;this.id=id;this.title=title;this.classes=classes;}
if(el.is(':checkbox')){var checkboxOutput=function(){var att=new Attributes();var checkbox=$('<div'+att.id+' class="jq-checkbox'+att.classes+'"'+att.title+'><div class="jq-checkbox__div"></div></div>');el.css({position:'absolute',zIndex:'-1',opacity:0,margin:0,padding:0}).after(checkbox).prependTo(checkbox);checkbox.attr('unselectable','on').css({'-webkit-user-select':'none','-moz-user-select':'none','-ms-user-select':'none','-o-user-select':'none','user-select':'none',display:'inline-block',position:'relative',overflow:'hidden'});if(el.is(':checked'))checkbox.addClass('checked');if(el.is(':disabled'))checkbox.addClass('disabled');checkbox.click(function(e){e.preventDefault();if(!checkbox.is('.disabled')){if(el.is(':checked')){el.prop('checked',false);checkbox.removeClass('checked');}else{el.prop('checked',true);checkbox.addClass('checked');}
el.focus().change();}});el.closest('label').add('label[for="'+el.attr('id')+'"]').on('click.styler',function(e){if(!$(e.target).is('a')&&!$(e.target).closest(checkbox).length){checkbox.triggerHandler('click');e.preventDefault();}});el.on('change.styler',function(){if(el.is(':checked'))checkbox.addClass('checked');else checkbox.removeClass('checked');}).on('keydown.styler',function(e){if(e.which==32)checkbox.click();}).on('focus.styler',function(){if(!checkbox.is('.disabled'))checkbox.addClass('focused');}).on('blur.styler',function(){checkbox.removeClass('focused');});};checkboxOutput();el.on('refresh',function(){el.closest('label').add('label[for="'+el.attr('id')+'"]').off('.styler');el.off('.styler').parent().before(el).remove();checkboxOutput();});}else if(el.is(':radio')){var radioOutput=function(){var att=new Attributes();var radio=$('<div'+att.id+' class="jq-radio'+att.classes+'"'+att.title+'><div class="jq-radio__div"></div></div>');el.css({position:'absolute',zIndex:'-1',opacity:0,margin:0,padding:0}).after(radio).prependTo(radio);radio.attr('unselectable','on').css({'-webkit-user-select':'none','-moz-user-select':'none','-ms-user-select':'none','-o-user-select':'none','user-select':'none',display:'inline-block',position:'relative'});if(el.is(':checked'))radio.addClass('checked');if(el.is(':disabled'))radio.addClass('disabled');radio.click(function(e){e.preventDefault();if(!radio.is('.disabled')){radio.closest(opt.wrapper).find('input[name="'+el.attr('name')+'"]').prop('checked',false).parent().removeClass('checked');el.prop('checked',true).parent().addClass('checked');el.focus().change();}});el.closest('label').add('label[for="'+el.attr('id')+'"]').on('click.styler',function(e){if(!$(e.target).is('a')&&!$(e.target).closest(radio).length){radio.triggerHandler('click');e.preventDefault();}});el.on('change.styler',function(){el.parent().addClass('checked');}).on('focus.styler',function(){if(!radio.is('.disabled'))radio.addClass('focused');}).on('blur.styler',function(){radio.removeClass('focused');});};radioOutput();el.on('refresh',function(){el.closest('label').add('label[for="'+el.attr('id')+'"]').off('.styler');el.off('.styler').parent().before(el).remove();radioOutput();});}else if(el.is(':file')){el.css({position:'absolute',top:0,right:0,width:'100%',height:'100%',opacity:0,margin:0,padding:0});var fileOutput=function(){var att=new Attributes();var placeholder=el.data('placeholder');if(placeholder===undefined)placeholder=opt.filePlaceholder;var browse=el.data('browse');if(browse===undefined||browse==='')browse=opt.fileBrowse;var file=$('<div'+att.id+' class="jq-file'+att.classes+'"'+att.title+' style="display: inline-block; position: relative; overflow: hidden"></div>');var name=$('<div class="jq-file__name">'+placeholder+'</div>').appendTo(file);$('<div class="jq-file__browse">'+browse+'</div>').appendTo(file);el.after(file).appendTo(file);if(el.is(':disabled'))file.addClass('disabled');el.on('change.styler',function(){var value=el.val();if(el.is('[multiple]')){value='';var files=el[0].files.length;if(files>0){var number=el.data('number');if(number===undefined)number=opt.fileNumber;number=number.replace('%s',files);value=number;}}
name.text(value.replace(/.+[\\\/]/,''));if(value===''){name.text(placeholder);file.removeClass('changed');}else{file.addClass('changed');}}).on('focus.styler',function(){file.addClass('focused');}).on('blur.styler',function(){file.removeClass('focused');}).on('click.styler',function(){file.removeClass('focused');});};fileOutput();el.on('refresh',function(){el.off('.styler').parent().before(el).remove();fileOutput();});}else if(el.is('input[type="number"]')){var numberOutput=function(){var number=$('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>');el.after(number).prependTo(number).wrap('<div class="jq-number__field"></div>');if(el.is(':disabled'))number.addClass('disabled');var min,max,step,timeout=null,interval=null;if(el.attr('min')!==undefined)min=el.attr('min');if(el.attr('max')!==undefined)max=el.attr('max');if(el.attr('step')!==undefined&&$.isNumeric(el.attr('step')))
step=Number(el.attr('step'));else
step=Number(1);var changeValue=function(spin){var value=el.val(),newValue;if(!$.isNumeric(value)){value=0;el.val('0');}
if(spin.is('.minus')){newValue=parseInt(value,10)-step;if(step>0)newValue=Math.ceil(newValue / step)*step;}else if(spin.is('.plus')){newValue=parseInt(value,10)+step;if(step>0)newValue=Math.floor(newValue / step)*step;}
if($.isNumeric(min)&&$.isNumeric(max)){if(newValue>=min&&newValue<=max)el.val(newValue);}else if($.isNumeric(min)&&!$.isNumeric(max)){if(newValue>=min)el.val(newValue);}else if(!$.isNumeric(min)&&$.isNumeric(max)){if(newValue<=max)el.val(newValue);}else{el.val(newValue);}};if(!number.is('.disabled')){number.on('mousedown','div.jq-number__spin',function(){var spin=$(this);changeValue(spin);timeout=setTimeout(function(){interval=setInterval(function(){changeValue(spin);},40);},350);}).on('mouseup mouseout','div.jq-number__spin',function(){clearTimeout(timeout);clearInterval(interval);});el.on('focus.styler',function(){number.addClass('focused');}).on('blur.styler',function(){number.removeClass('focused');});}};numberOutput();el.on('refresh',function(){el.off('.styler').closest('.jq-number').before(el).remove();numberOutput();});}else if(el.is('select')){var selectboxOutput=function(){function preventScrolling(selector){selector.off('mousewheel DOMMouseScroll').on('mousewheel DOMMouseScroll',function(e){var scrollTo=null;if(e.type=='mousewheel'){scrollTo=(e.originalEvent.wheelDelta*-1);}
else if(e.type=='DOMMouseScroll'){scrollTo=40*e.originalEvent.detail;}
if(scrollTo){e.stopPropagation();e.preventDefault();$(this).scrollTop(scrollTo+$(this).scrollTop());}});}
var option=$('option',el);var list='';function makeList(){for(var i=0;i<option.length;i++){var op=option.eq(i);var li='',liClass='',liClasses='',id='',title='',dataList='',optionClass='',optgroupClass='',dataJqfsClass='';var disabled='disabled';var selDis='selected sel disabled';if(op.prop('selected'))liClass='selected sel';if(op.is(':disabled'))liClass=disabled;if(op.is(':selected:disabled'))liClass=selDis;if(op.attr('id')!==undefined&&op.attr('id')!=='')id=' id="'+op.attr('id')+opt.idSuffix+'"';if(op.attr('title')!==undefined&&option.attr('title')!=='')title=' title="'+op.attr('title')+'"';if(op.attr('class')!==undefined){optionClass=' '+op.attr('class');dataJqfsClass=' data-jqfs-class="'+op.attr('class')+'"';}
var data=op.data();for(var k in data){if(data[k]!=='')dataList+=' data-'+k+'="'+data[k]+'"';}
if((liClass+optionClass)!=='')liClasses=' class="'+liClass+optionClass+'"';li='<li'+dataJqfsClass+dataList+liClasses+title+id+'>'+op.html()+'</li>';if(op.parent().is('optgroup')){if(op.parent().attr('class')!==undefined)optgroupClass=' '+op.parent().attr('class');li='<li'+dataJqfsClass+dataList+' class="'+liClass+optionClass+' option'+optgroupClass+'"'+title+id+'>'+op.html()+'</li>';if(op.is(':first-child')){li='<li class="optgroup'+optgroupClass+'">'+op.parent().attr('label')+'</li>'+li;}}
list+=li;}}
function doSelect(){var att=new Attributes();var searchHTML='';var selectPlaceholder=el.data('placeholder');var selectSearch=el.data('search');var selectSearchLimit=el.data('search-limit');var selectSearchNotFound=el.data('search-not-found');var selectSearchPlaceholder=el.data('search-placeholder');var singleSelectzIndex=el.data('z-index');var selectSmartPositioning=el.data('smart-positioning');if(selectPlaceholder===undefined)selectPlaceholder=opt.selectPlaceholder;if(selectSearch===undefined||selectSearch==='')selectSearch=opt.selectSearch;if(selectSearchLimit===undefined||selectSearchLimit==='')selectSearchLimit=opt.selectSearchLimit;if(selectSearchNotFound===undefined||selectSearchNotFound==='')selectSearchNotFound=opt.selectSearchNotFound;if(selectSearchPlaceholder===undefined)selectSearchPlaceholder=opt.selectSearchPlaceholder;if(singleSelectzIndex===undefined||singleSelectzIndex==='')singleSelectzIndex=opt.singleSelectzIndex;if(selectSmartPositioning===undefined||selectSmartPositioning==='')selectSmartPositioning=opt.selectSmartPositioning;var selectbox=$('<div'+att.id+' class="jq-selectbox jqselect'+att.classes+'" style="display: inline-block; position: relative; z-index:'+singleSelectzIndex+'">'+'<div class="jq-selectbox__select"'+att.title+' style="position: relative">'+'<div class="jq-selectbox__select-text"></div>'+'<div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div>'+'</div>'+'</div>');el.css({margin:0,padding:0}).after(selectbox).prependTo(selectbox);var divSelect=$('div.jq-selectbox__select',selectbox);var divText=$('div.jq-selectbox__select-text',selectbox);var optionSelected=option.filter(':selected');makeList();if(selectSearch)searchHTML='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+selectSearchPlaceholder+'"></div>'+'<div class="jq-selectbox__not-found">'+selectSearchNotFound+'</div>';var dropdown=$('<div class="jq-selectbox__dropdown" style="position: absolute">'+
searchHTML+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+list+'</ul>'+'</div>');selectbox.append(dropdown);var ul=$('ul',dropdown);var li=$('li',dropdown);var search=$('input',dropdown);var notFound=$('div.jq-selectbox__not-found',dropdown).hide();if(li.length<selectSearchLimit)search.parent().hide();if(el.val()===''){divText.text(selectPlaceholder).addClass('placeholder');}else{divText.text(optionSelected.text());}
var liWidthInner=0,liWidth=0;li.each(function(){var l=$(this);l.css({'display':'inline-block'});if(l.innerWidth()>liWidthInner){liWidthInner=l.innerWidth();liWidth=l.width();}
l.css({'display':''});});if(divText.is('.placeholder')&&(divText.width()>liWidthInner)){divText.width(divText.width());}else{var selClone=selectbox.clone().appendTo('body').width('auto');var selCloneWidth=selClone.outerWidth();selClone.remove();if(selCloneWidth==selectbox.outerWidth()){divText.width(liWidth);}}
if(liWidthInner>selectbox.width())dropdown.width(liWidthInner);if(option.first().text()===''&&el.data('placeholder')!==''){li.first().hide();}
el.css({position:'absolute',left:0,top:0,width:'100%',height:'100%',opacity:0});var selectHeight=selectbox.outerHeight();var searchHeight=search.outerHeight();var isMaxHeight=ul.css('max-height');var liSelected=li.filter('.selected');if(liSelected.length<1)li.first().addClass('selected sel');if(li.data('li-height')===undefined)li.data('li-height',li.outerHeight());var position=dropdown.css('top');if(dropdown.css('left')=='auto')dropdown.css({left:0});if(dropdown.css('top')=='auto')dropdown.css({top:selectHeight});dropdown.hide();if(liSelected.length){if(option.first().text()!=optionSelected.text()){selectbox.addClass('changed');}
selectbox.data('jqfs-class',liSelected.data('jqfs-class'));selectbox.addClass(liSelected.data('jqfs-class'));}
if(el.is(':disabled')){selectbox.addClass('disabled');return false;}
divSelect.click(function(){if($('div.jq-selectbox').filter('.opened').length){opt.onSelectClosed.call($('div.jq-selectbox').filter('.opened'));}
el.focus();var win=$(window);var liHeight=li.data('li-height');var topOffset=selectbox.offset().top;var bottomOffset=win.height()-selectHeight-(topOffset-win.scrollTop());var visible=el.data('visible-options');if(visible===undefined||visible==='')visible=opt.selectVisibleOptions;var minHeight=liHeight*5;var newHeight=liHeight*visible;if(visible>0&&visible<6)minHeight=newHeight;if(visible===0)newHeight='auto';var dropDown=function(){dropdown.height('auto').css({bottom:'auto',top:position});var maxHeightBottom=function(){ul.css('max-height',Math.floor((bottomOffset-20-searchHeight)/ liHeight)*liHeight);};maxHeightBottom();ul.css('max-height',newHeight);if(isMaxHeight!='none'){ul.css('max-height',isMaxHeight);}
if(bottomOffset<(dropdown.outerHeight()+20)){maxHeightBottom();}};var dropUp=function(){dropdown.height('auto').css({top:'auto',bottom:position});var maxHeightTop=function(){ul.css('max-height',Math.floor((topOffset-win.scrollTop()-20-searchHeight)/ liHeight)*liHeight);};maxHeightTop();ul.css('max-height',newHeight);if(isMaxHeight!='none'){ul.css('max-height',isMaxHeight);}
if((topOffset-win.scrollTop()-20)<(dropdown.outerHeight()+20)){maxHeightTop();}};if(selectSmartPositioning===true||selectSmartPositioning===1){if(bottomOffset>(minHeight+searchHeight+20)){dropDown();selectbox.removeClass('dropup').addClass('dropdown');}else{dropUp();selectbox.removeClass('dropdown').addClass('dropup');}}else if(selectSmartPositioning===false||selectSmartPositioning===0){if(bottomOffset>(minHeight+searchHeight+20)){dropDown();selectbox.removeClass('dropup').addClass('dropdown');}}
if(selectbox.offset().left+dropdown.outerWidth()>win.width()){dropdown.css({left:'auto',right:0});}
$('div.jqselect').css({zIndex:(singleSelectzIndex-1)}).removeClass('opened');selectbox.css({zIndex:singleSelectzIndex});if(dropdown.is(':hidden')){$('div.jq-selectbox__dropdown:visible').hide();dropdown.show();selectbox.addClass('opened focused');opt.onSelectOpened.call(selectbox);}else{dropdown.hide();selectbox.removeClass('opened dropup dropdown');if($('div.jq-selectbox').filter('.opened').length){opt.onSelectClosed.call(selectbox);}}
if(search.length){search.val('').keyup();notFound.hide();search.keyup(function(){var query=$(this).val();li.each(function(){if(!$(this).html().match(new RegExp('.*?'+query+'.*?','i'))){$(this).hide();}else{$(this).show();}});if(option.first().text()===''&&el.data('placeholder')!==''){li.first().hide();}
if(li.filter(':visible').length<1){notFound.show();}else{notFound.hide();}});}
if(li.filter('.selected').length){if(el.val()===''){ul.scrollTop(0);}else{if((ul.innerHeight()/ liHeight)%2!==0)liHeight=liHeight / 2;ul.scrollTop(ul.scrollTop()+li.filter('.selected').position().top-ul.innerHeight()/ 2+liHeight);}}
preventScrolling(ul);});li.hover(function(){$(this).siblings().removeClass('selected');});var selectedText=li.filter('.selected').text();li.filter(':not(.disabled):not(.optgroup)').click(function(){el.focus();var t=$(this);var liText=t.text();if(!t.is('.selected')){var index=t.index();index-=t.prevAll('.optgroup').length;t.addClass('selected sel').siblings().removeClass('selected sel');option.prop('selected',false).eq(index).prop('selected',true);selectedText=liText;divText.text(liText);if(selectbox.data('jqfs-class'))selectbox.removeClass(selectbox.data('jqfs-class'));selectbox.data('jqfs-class',t.data('jqfs-class'));selectbox.addClass(t.data('jqfs-class'));el.change();}
dropdown.hide();selectbox.removeClass('opened dropup dropdown');opt.onSelectClosed.call(selectbox);});dropdown.mouseout(function(){$('li.sel',dropdown).addClass('selected');});el.on('change.styler',function(){divText.text(option.filter(':selected').text()).removeClass('placeholder');li.removeClass('selected sel').not('.optgroup').eq(el[0].selectedIndex).addClass('selected sel');if(option.first().text()!=li.filter('.selected').text()){selectbox.addClass('changed');}else{selectbox.removeClass('changed');}}).on('focus.styler',function(){selectbox.addClass('focused');$('div.jqselect').not('.focused').removeClass('opened dropup dropdown').find('div.jq-selectbox__dropdown').hide();}).on('blur.styler',function(){selectbox.removeClass('focused');}).on('keydown.styler keyup.styler',function(e){var liHeight=li.data('li-height');if(el.val()===''){divText.text(selectPlaceholder).addClass('placeholder');}else{divText.text(option.filter(':selected').text());}
li.removeClass('selected sel').not('.optgroup').eq(el[0].selectedIndex).addClass('selected sel');if(e.which==38||e.which==37||e.which==33||e.which==36){if(el.val()===''){ul.scrollTop(0);}else{ul.scrollTop(ul.scrollTop()+li.filter('.selected').position().top);}}
if(e.which==40||e.which==39||e.which==34||e.which==35){ul.scrollTop(ul.scrollTop()+li.filter('.selected').position().top-ul.innerHeight()+liHeight);}
if(e.which==13){e.preventDefault();dropdown.hide();selectbox.removeClass('opened dropup dropdown');opt.onSelectClosed.call(selectbox);}}).on('keydown.styler',function(e){if(e.which==32){e.preventDefault();divSelect.click();}});if(!onDocumentClick.registered){$(document).on('click',onDocumentClick);onDocumentClick.registered=true;}}
function doMultipleSelect(){var att=new Attributes();var selectbox=$('<div'+att.id+' class="jq-select-multiple jqselect'+att.classes+'"'+att.title+' style="display: inline-block; position: relative"></div>');el.css({margin:0,padding:0}).after(selectbox);makeList();selectbox.append('<ul>'+list+'</ul>');var ul=$('ul',selectbox).css({'position':'relative','overflow-x':'hidden','-webkit-overflow-scrolling':'touch'});var li=$('li',selectbox).attr('unselectable','on');var size=el.attr('size');var ulHeight=ul.outerHeight();var liHeight=li.outerHeight();if(size!==undefined&&size>0){ul.css({'height':liHeight*size});}else{ul.css({'height':liHeight*4});}
if(ulHeight>selectbox.height()){ul.css('overflowY','scroll');preventScrolling(ul);if(li.filter('.selected').length){ul.scrollTop(ul.scrollTop()+li.filter('.selected').position().top);}}
el.prependTo(selectbox).css({position:'absolute',left:0,top:0,width:'100%',height:'100%',opacity:0});if(el.is(':disabled')){selectbox.addClass('disabled');option.each(function(){if($(this).is(':selected'))li.eq($(this).index()).addClass('selected');});}else{li.filter(':not(.disabled):not(.optgroup)').click(function(e){el.focus();var clkd=$(this);if(!e.ctrlKey&&!e.metaKey)clkd.addClass('selected');if(!e.shiftKey)clkd.addClass('first');if(!e.ctrlKey&&!e.metaKey&&!e.shiftKey)clkd.siblings().removeClass('selected first');if(e.ctrlKey||e.metaKey){if(clkd.is('.selected'))clkd.removeClass('selected first');else clkd.addClass('selected first');clkd.siblings().removeClass('first');}
if(e.shiftKey){var prev=false,next=false;clkd.siblings().removeClass('selected').siblings('.first').addClass('selected');clkd.prevAll().each(function(){if($(this).is('.first'))prev=true;});clkd.nextAll().each(function(){if($(this).is('.first'))next=true;});if(prev){clkd.prevAll().each(function(){if($(this).is('.selected'))return false;else $(this).not('.disabled, .optgroup').addClass('selected');});}
if(next){clkd.nextAll().each(function(){if($(this).is('.selected'))return false;else $(this).not('.disabled, .optgroup').addClass('selected');});}
if(li.filter('.selected').length==1)clkd.addClass('first');}
option.prop('selected',false);li.filter('.selected').each(function(){var t=$(this);var index=t.index();if(t.is('.option'))index-=t.prevAll('.optgroup').length;option.eq(index).prop('selected',true);});el.change();});option.each(function(i){$(this).data('optionIndex',i);});el.on('change.styler',function(){li.removeClass('selected');var arrIndexes=[];option.filter(':selected').each(function(){arrIndexes.push($(this).data('optionIndex'));});li.not('.optgroup').filter(function(i){return $.inArray(i,arrIndexes)>-1;}).addClass('selected');}).on('focus.styler',function(){selectbox.addClass('focused');}).on('blur.styler',function(){selectbox.removeClass('focused');});if(ulHeight>selectbox.height()){el.on('keydown.styler',function(e){if(e.which==38||e.which==37||e.which==33){ul.scrollTop(ul.scrollTop()+li.filter('.selected').position().top-liHeight);}
if(e.which==40||e.which==39||e.which==34){ul.scrollTop(ul.scrollTop()+li.filter('.selected:last').position().top-ul.innerHeight()+liHeight*2);}});}}}
if(el.is('[multiple]')){if(Android||iOS)return;doMultipleSelect();}else{doSelect();}};selectboxOutput();el.on('refresh',function(){el.off('.styler').parent().before(el).remove();selectboxOutput();});}else if(el.is(':reset')){el.on('click',function(){setTimeout(function(){el.closest(opt.wrapper).find('input, select').trigger('refresh');},1);});}},destroy:function(){var el=$(this.element);if(el.is(':checkbox')||el.is(':radio')){el.removeData('_'+pluginName).off('.styler refresh').removeAttr('style').parent().before(el).remove();el.closest('label').add('label[for="'+el.attr('id')+'"]').off('.styler');}else if(el.is('input[type="number"]')){el.removeData('_'+pluginName).off('.styler refresh').closest('.jq-number').before(el).remove();}else if(el.is(':file')||el.is('select')){el.removeData('_'+pluginName).off('.styler refresh').removeAttr('style').parent().before(el).remove();}}};$.fn[pluginName]=function(options){var args=arguments;if(options===undefined||typeof options==='object'){this.each(function(){if(!$.data(this,'_'+pluginName)){$.data(this,'_'+pluginName,new Plugin(this,options));}}).promise().done(function(){var opt=$(this[0]).data('_'+pluginName);if(opt)opt.options.onFormStyled.call();});return this;}else if(typeof options==='string'&&options[0]!=='_'&&options!=='init'){var returns;this.each(function(){var instance=$.data(this,'_'+pluginName);if(instance instanceof Plugin&&typeof instance[options]==='function'){returns=instance[options].apply(instance,Array.prototype.slice.call(args,1));}});return returns!==undefined?returns:this;}};function onDocumentClick(e){if(!$(e.target).parents().hasClass('jq-selectbox')&&e.target.nodeName!='OPTION'){if($('div.jq-selectbox.opened').length){var selectbox=$('div.jq-selectbox.opened'),search=$('div.jq-selectbox__search input',selectbox),dropdown=$('div.jq-selectbox__dropdown',selectbox),opt=selectbox.find('select').data('_'+pluginName).options;opt.onSelectClosed.call(selectbox);if(search.length)search.val('').keyup();dropdown.hide().find('li.sel').addClass('selected');selectbox.removeClass('focused opened dropup dropdown');}}}
onDocumentClick.registered=false;}));
(function($){function Inputmask(options){this.el=undefined;this.opts=$.extend(true,{},this.defaults,options);this.noMasksCache=options&&options.definitions!==undefined;this.userOptions=options||{};resolveAlias(this.opts.alias,options,this.opts);}
Inputmask.prototype={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:undefined,oncomplete:$.noop,onincomplete:$.noop,oncleared:$.noop,repeat:0,greedy:true,autoUnmask:false,removeMaskOnSubmit:false,clearMaskOnLostFocus:true,insertMode:true,clearIncomplete:false,aliases:{},alias:undefined,onKeyDown:$.noop,onBeforeMask:undefined,onBeforePaste:undefined,onBeforeWrite:undefined,onUnMask:undefined,showMaskOnFocus:true,showMaskOnHover:true,onKeyValidation:$.noop,skipOptionalPartCharacter:" ",showTooltip:false,numericInput:false,rightAlign:false,undoOnEscape:true,radixPoint:"",groupSeparator:"",radixFocus:false,nojumps:false,nojumpsThreshold:0,keepStatic:undefined,positionCaretOnTab:false,tabThrough:false,definitions:{"9":{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},"a":{validator:"[A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:undefined,canClearPosition:$.noop,postValidation:undefined},masksCache:{},mask:function(el){var input=el.jquery&&el.length>0?el[0]:el,scopedOpts=$.extend(true,{},this.opts);importAttributeOptions(el,scopedOpts,$.extend(true,{},this.userOptions));var maskset=generateMaskSet(scopedOpts,this.noMasksCache);if(maskset!==undefined){input.inputmask=input.inputmask||new Inputmask();input.inputmask.opts=scopedOpts;input.inputmask.noMasksCache=this.noMasksCache;input.inputmask.el=input;input.inputmask.maskset=maskset;input.inputmask.isRTL=false;$(input).data("_inputmask_opts",scopedOpts);maskScope({"action":"mask","el":input},maskset,input.inputmask.opts);}
return el;},unmaskedvalue:function(){if(this.el){return maskScope({"action":"unmaskedvalue","el":this.el});}},remove:function(){if(this.el){maskScope({"action":"remove","el":this.el});this.el.inputmask=undefined;return this.el;}},getemptymask:function(){if(this.el){return maskScope({"action":"getemptymask","el":this.el});}},hasMaskedValue:function(){return!this.opts.autoUnmask;},isComplete:function(){if(this.el){return maskScope({"action":"isComplete","buffer":this.el.inputmask._valueGet().split(""),"el":this.el});}},getmetadata:function(){if(this.el){return maskScope({"action":"getmetadata","el":this.el});}}};Inputmask.extendDefaults=function(options){$.extend(Inputmask.prototype.defaults,options);};Inputmask.extendDefinitions=function(definition){$.extend(Inputmask.prototype.defaults.definitions,definition);};Inputmask.extendAliases=function(alias){$.extend(Inputmask.prototype.defaults.aliases,alias);};Inputmask.format=function(value,options,metadata){var opts=$.extend(true,{},Inputmask.prototype.defaults,options);resolveAlias(opts.alias,options,opts);return maskScope({"action":"format","value":value,"metadata":metadata},generateMaskSet(opts,options&&options.definitions!==undefined),opts);};Inputmask.unmask=function(value,options){var opts=$.extend(true,{},Inputmask.prototype.defaults,options);resolveAlias(opts.alias,options,opts);return maskScope({"action":"unmaskedvalue","value":value},generateMaskSet(opts,options&&options.definitions!==undefined),opts);};Inputmask.isValid=function(value,options){var opts=$.extend(true,{},Inputmask.prototype.defaults,options);resolveAlias(opts.alias,options,opts);return maskScope({"action":"isValid","value":value},generateMaskSet(opts,options&&options.definitions!==undefined),opts);};Inputmask.escapeRegex=function(str){var specials=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return str.replace(new RegExp("(\\"+specials.join("|\\")+")","gim"),"\\$1");};Inputmask.keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91};function isInputEventSupported(eventName){var el=document.createElement("input"),evName="on"+eventName,isSupported=(evName in el);if(!isSupported){el.setAttribute(evName,"return;");isSupported=typeof el[evName]=="function";}
el=null;return isSupported;}
function isInputTypeSupported(inputType){var isSupported=inputType==="text"||inputType==="tel"||inputType==="password";if(!isSupported){var el=document.createElement("input");el.setAttribute("type",inputType);isSupported=el.type==="text";el=null;}
return isSupported;}
function resolveAlias(aliasStr,options,opts){var aliasDefinition=opts.aliases[aliasStr];if(aliasDefinition){if(aliasDefinition.alias)resolveAlias(aliasDefinition.alias,undefined,opts);$.extend(true,opts,aliasDefinition);$.extend(true,opts,options);return true;}else
if(opts.mask===undefined){opts.mask=aliasStr;}
return false;}
function importAttributeOptions(npt,opts,userOptions){var $npt=$(npt),attrOptions=$npt.data("inputmask");function importOption(option){var optionData=$npt.data("inputmask-"+option.toLowerCase());if(optionData!==undefined){optionData=typeof optionData=="boolean"?optionData:optionData.toString();if(option==="mask"&&optionData.indexOf("[")===0){userOptions[option]=optionData.replace(/[\s[\]]/g,"").split(",");userOptions[option][0]=userOptions[option][0].replace("'","");userOptions[option][userOptions[option].length-1]=userOptions[option][userOptions[option].length-1].replace("'","");}else userOptions[option]=optionData;}}
if(attrOptions&&attrOptions!==""){try{attrOptions=attrOptions.replace(new RegExp("'","g"),'"');var dataoptions=$.parseJSON("{"+attrOptions+"}");$.extend(true,userOptions,dataoptions);}catch(ex){}}
for(var option in opts){importOption(option);}
if(userOptions.alias){resolveAlias(userOptions.alias,userOptions,opts);for(option in opts){importOption(option);}}
$.extend(true,opts,userOptions);return opts;}
function generateMaskSet(opts,nocache){var ms;function analyseMask(mask){var tokenizer=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})\??|[^.?*+^${[]()|\\]+|./g,escaped=false,currentToken=new MaskToken(),match,m,openenings=[],maskTokens=[],openingToken,currentOpeningToken,alternator,lastMatch,groupToken;function MaskToken(isGroup,isOptional,isQuantifier,isAlternator){this.matches=[];this.isGroup=isGroup||false;this.isOptional=isOptional||false;this.isQuantifier=isQuantifier||false;this.isAlternator=isAlternator||false;this.quantifier={min:1,max:1};}
function insertTestDefinition(mtoken,element,position){var maskdef=opts.definitions[element];position=position!==undefined?position:mtoken.matches.length;var prevMatch=mtoken.matches[position-1];if(maskdef&&!escaped){maskdef.placeholder=$.isFunction(maskdef.placeholder)?maskdef.placeholder.call(this,opts):maskdef.placeholder;var prevalidators=maskdef.prevalidator,prevalidatorsL=prevalidators?prevalidators.length:0;for(var i=1;i<maskdef.cardinality;i++){var prevalidator=prevalidatorsL>=i?prevalidators[i-1]:[],validator=prevalidator.validator,cardinality=prevalidator.cardinality;mtoken.matches.splice(position++,0,{fn:validator?typeof validator==="string"?new RegExp(validator):new function(){this.test=validator;}:new RegExp("."),cardinality:cardinality?cardinality:1,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element});prevMatch=mtoken.matches[position-1];}
mtoken.matches.splice(position++,0,{fn:maskdef.validator?typeof maskdef.validator=="string"?new RegExp(maskdef.validator):new function(){this.test=maskdef.validator;}:new RegExp("."),cardinality:maskdef.cardinality,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element});}else{mtoken.matches.splice(position++,0,{fn:null,cardinality:0,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==element,casing:null,def:element,placeholder:undefined,mask:element});escaped=false;}}
function verifyGroupMarker(lastMatch,isOpenGroup){if(lastMatch.isGroup){lastMatch.isGroup=false;insertTestDefinition(lastMatch,opts.groupmarker.start,0);if(isOpenGroup!==true)
insertTestDefinition(lastMatch,opts.groupmarker.end);}}
function maskCurrentToken(m,currentToken,lastMatch,extraCondition){if(currentToken.matches.length>0&&(extraCondition===undefined||extraCondition)){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch);}
insertTestDefinition(currentToken,m);}
function defaultCase(){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];maskCurrentToken(m,currentOpeningToken,lastMatch,!currentOpeningToken.isAlternator);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false;}
if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator);}else{currentToken.matches.push(alternator);}}}else{maskCurrentToken(m,currentToken,lastMatch);}}
function reverseTokens(maskToken){function reverseStatic(st){if(st===opts.optionalmarker.start)
st=opts.optionalmarker.end;else if(st===opts.optionalmarker.end)
st=opts.optionalmarker.start;else if(st===opts.groupmarker.start)
st=opts.groupmarker.end;else if(st===opts.groupmarker.end)
st=opts.groupmarker.start;return st;}
maskToken.matches=maskToken.matches.reverse();for(var match in maskToken.matches){var intMatch=parseInt(match);if(maskToken.matches[match].isQuantifier&&maskToken.matches[intMatch+1]&&maskToken.matches[intMatch+1].isGroup){var qt=maskToken.matches[match];maskToken.matches.splice(match,1);maskToken.matches.splice(intMatch+1,0,qt);}
if(maskToken.matches[match].matches!==undefined)
maskToken.matches[match]=reverseTokens(maskToken.matches[match]);else
maskToken.matches[match]=reverseStatic(maskToken.matches[match]);}
return maskToken;}
while(match=tokenizer.exec(mask)){m=match[0];if(escaped){defaultCase();continue;}
switch(m.charAt(0)){case opts.escapeChar:escaped=true;break;case opts.optionalmarker.end:case opts.groupmarker.end:openingToken=openenings.pop();if(openingToken!==undefined){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(openingToken);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false;}
if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator);}else{currentToken.matches.push(alternator);}}}else{currentToken.matches.push(openingToken);}}else defaultCase();break;case opts.optionalmarker.start:openenings.push(new MaskToken(false,true));break;case opts.groupmarker.start:openenings.push(new MaskToken(true));break;case opts.quantifiermarker.start:var quantifier=new MaskToken(false,false,true);m=m.replace(/[{}]/g,"");var mq=m.split(","),mq0=isNaN(mq[0])?mq[0]:parseInt(mq[0]),mq1=mq.length===1?mq0:(isNaN(mq[1])?mq[1]:parseInt(mq[1]));if(mq1==="*"||mq1==="+"){mq0=mq1==="*"?0:1;}
quantifier.quantifier={min:mq0,max:mq1};if(openenings.length>0){var matches=openenings[openenings.length-1].matches;match=matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken;}
matches.push(match);matches.push(quantifier);}else{match=currentToken.matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken;}
currentToken.matches.push(match);currentToken.matches.push(quantifier);}
break;case opts.alternatormarker:if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];lastMatch=currentOpeningToken.matches.pop();}else{lastMatch=currentToken.matches.pop();}
if(lastMatch.isAlternator){openenings.push(lastMatch);}else{alternator=new MaskToken(false,false,false,true);alternator.matches.push(lastMatch);openenings.push(alternator);}
break;default:defaultCase();}}
while(openenings.length>0){openingToken=openenings.pop();verifyGroupMarker(openingToken,true);currentToken.matches.push(openingToken);}
if(currentToken.matches.length>0){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch);maskTokens.push(currentToken);}
if(opts.numericInput){reverseTokens(maskTokens[0]);}
return maskTokens;}
function generateMask(mask,metadata){if(mask===undefined||mask==="")
return undefined;else{if(mask.length===1&&opts.greedy===false&&opts.repeat!==0){opts.placeholder="";}
if(opts.repeat>0||opts.repeat==="*"||opts.repeat==="+"){var repeatStart=opts.repeat==="*"?0:(opts.repeat==="+"?1:opts.repeat);mask=opts.groupmarker.start+mask+opts.groupmarker.end+opts.quantifiermarker.start+repeatStart+","+opts.repeat+opts.quantifiermarker.end;}
var masksetDefinition;if(Inputmask.prototype.masksCache[mask]===undefined||nocache===true){masksetDefinition={"mask":mask,"maskToken":analyseMask(mask),"validPositions":{},"_buffer":undefined,"buffer":undefined,"tests":{},"metadata":metadata};if(nocache!==true)
Inputmask.prototype.masksCache[opts.numericInput?mask.split("").reverse().join(""):mask]=masksetDefinition;}else masksetDefinition=$.extend(true,{},Inputmask.prototype.masksCache[mask]);return masksetDefinition;}}
function preProcessMask(mask){mask=mask.toString();return mask;}
if($.isFunction(opts.mask)){opts.mask=opts.mask.call(this,opts);}
if($.isArray(opts.mask)){if(opts.mask.length>1){opts.keepStatic=opts.keepStatic===undefined?true:opts.keepStatic;var altMask="(";$.each(opts.numericInput?opts.mask.reverse():opts.mask,function(ndx,msk){if(altMask.length>1)
altMask+=")|(";if(msk.mask!==undefined&&!$.isFunction(msk.mask)){altMask+=preProcessMask(msk.mask);}else{altMask+=preProcessMask(msk);}});altMask+=")";return generateMask(altMask,opts.mask);}else opts.mask=opts.mask.pop();}
if(opts.mask){if(opts.mask.mask!==undefined&&!$.isFunction(opts.mask.mask)){ms=generateMask(preProcessMask(opts.mask.mask),opts.mask);}else{ms=generateMask(preProcessMask(opts.mask),opts.mask);}}
return ms;}
var ua=navigator.userAgent,iphone=ua.match(new RegExp("iphone","i"))!==null,androidchrome=ua.match(new RegExp("android.*chrome.*","i"))!==null,androidfirefox=ua.match(new RegExp("android.*firefox.*","i"))!==null,PasteEventType=isInputEventSupported("paste")?"paste":isInputEventSupported("input")?"input":"propertychange";function maskScope(actionObj,maskset,opts){var isRTL=false,undoValue,compositionValidPos,compositionCaretPos,compositionData,el,$el,skipKeyPressEvent=false,skipInputEvent=false,ignorable=false,maxLength,firstClick=true,mouseEnter=true;function getMaskTemplate(baseOnInput,minimalPos,includeInput){minimalPos=minimalPos||0;var maskTemplate=[],ndxIntlzr,pos=0,test,testPos;do{if(baseOnInput===true&&getMaskSet().validPositions[pos]){var validPos=getMaskSet().validPositions[pos];test=validPos.match;ndxIntlzr=validPos.locator.slice();maskTemplate.push(includeInput===true?validPos.input:getPlaceholder(pos,test));}else{testPos=getTestTemplate(pos,ndxIntlzr,pos-1);test=testPos.match;ndxIntlzr=testPos.locator.slice();maskTemplate.push(getPlaceholder(pos,test));}
pos++;}while((maxLength===undefined||pos-1<maxLength)&&test.fn!==null||(test.fn===null&&test.def!=="")||minimalPos>=pos);maskTemplate.pop();return maskTemplate;}
function getMaskSet(){return maskset;}
function resetMaskSet(soft){var maskset=getMaskSet();maskset.buffer=undefined;maskset.tests={};if(soft!==true){maskset._buffer=undefined;maskset.validPositions={};maskset.p=0;}}
function getLastValidPosition(closestTo,strict){var maskset=getMaskSet(),lastValidPosition=-1,valids=maskset.validPositions;if(closestTo===undefined)closestTo=-1;var before=lastValidPosition,after=lastValidPosition;for(var posNdx in valids){var psNdx=parseInt(posNdx);if(valids[psNdx]&&(strict||valids[psNdx].match.fn!==null)){if(psNdx<=closestTo)before=psNdx;if(psNdx>=closestTo)after=psNdx;}}
lastValidPosition=(before!==-1&&(closestTo-before)>1)||after<closestTo?before:after;return lastValidPosition;}
function setValidPosition(pos,validTest,fromSetValid){if(opts.insertMode&&getMaskSet().validPositions[pos]!==undefined&&fromSetValid===undefined){var positionsClone=$.extend(true,{},getMaskSet().validPositions),lvp=getLastValidPosition(),i;for(i=pos;i<=lvp;i++){delete getMaskSet().validPositions[i];}
getMaskSet().validPositions[pos]=validTest;var valid=true,j,vps=getMaskSet().validPositions;for(i=(j=pos);i<=lvp;i++){var t=positionsClone[i];if(t!==undefined){var posMatch=j,prevPosMatch=-1;while(posMatch<getMaskLength()&&((t.match.fn==null&&vps[i]&&(vps[i].match.optionalQuantifier===true||vps[i].match.optionality===true))||t.match.fn!=null)){if(t.match.fn===null||(!opts.keepStatic&&vps[i]&&(vps[i+1]!==undefined&&getTests(i+1,vps[i].locator.slice(),i).length>1||vps[i].alternation!==undefined)))
posMatch++;else
posMatch=seekNext(j);if(positionCanMatchDefinition(posMatch,t.match.def)){valid=isValid(posMatch,t.input,true,true)!==false;j=posMatch;break;}else{valid=t.match.fn==null;if(prevPosMatch===posMatch)break;prevPosMatch=posMatch;}}}
if(!valid)break;}
if(!valid){getMaskSet().validPositions=$.extend(true,{},positionsClone);return false;}}else
getMaskSet().validPositions[pos]=validTest;return true;}
function stripValidPositions(start,end,nocheck,strict){var i,startPos=start;getMaskSet().p=start;var endPos=end;for(i=startPos;i<end;i++){if(getMaskSet().validPositions[i]!==undefined){if(nocheck===true||opts.canClearPosition(getMaskSet(),i,getLastValidPosition(),strict,opts)!==false)
delete getMaskSet().validPositions[i];}}
resetMaskSet(true);for(i=startPos+1;i<=getLastValidPosition();){while(getMaskSet().validPositions[startPos]!==undefined)startPos++;var s=getMaskSet().validPositions[startPos];if(i<startPos)i=startPos+1;var t=getMaskSet().validPositions[i];if(t!==undefined&&isMask(i)&&s===undefined){if(positionCanMatchDefinition(startPos,t.match.def)&&isValid(startPos,t.input,true)!==false){delete getMaskSet().validPositions[i];i++;}
startPos++;}else i++;}
var lvp=getLastValidPosition(),ml=getMaskLength();if(strict!==true&&nocheck!==true&&getMaskSet().validPositions[lvp]!==undefined&&getMaskSet().validPositions[lvp].input===opts.radixPoint)
delete getMaskSet().validPositions[lvp];for(i=lvp+1;i<=ml;i++){if(getMaskSet().validPositions[i])
delete getMaskSet().validPositions[i];}
resetMaskSet(true);}
function getTestTemplate(pos,ndxIntlzr,tstPs){var testPos=getMaskSet().validPositions[pos];if(testPos===undefined){var testPositions=getTests(pos,ndxIntlzr,tstPs),lvp=getLastValidPosition(),lvTest=getMaskSet().validPositions[lvp]||getTests(0)[0],lvTestAltArr=(lvTest.alternation!==undefined)?lvTest.locator[lvTest.alternation].toString().split(","):[];for(var ndx=0;ndx<testPositions.length;ndx++){testPos=testPositions[ndx];if(testPos.match&&(((opts.greedy&&testPos.match.optionalQuantifier!==true)||(testPos.match.optionality===false||testPos.match.newBlockMarker===false)&&testPos.match.optionalQuantifier!==true)&&((lvTest.alternation===undefined||lvTest.alternation!==testPos.alternation)||(testPos.locator[lvTest.alternation]!==undefined&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(","),lvTestAltArr))))){break;}}}
return testPos;}
function getTest(pos){if(getMaskSet().validPositions[pos]){return getMaskSet().validPositions[pos].match;}
return getTests(pos)[0].match;}
function positionCanMatchDefinition(pos,def){var valid=false,tests=getTests(pos);for(var tndx=0;tndx<tests.length;tndx++){if(tests[tndx].match&&tests[tndx].match.def===def){valid=true;break;}}
return valid;}
function getTests(pos,ndxIntlzr,tstPs,cacheable){var maskTokens=getMaskSet().maskToken,testPos=ndxIntlzr?tstPs:0,ndxInitializer=ndxIntlzr||[0],matches=[],insertStop=false,latestMatch,isFirstMatch;function resolveTestFromToken(maskToken,ndxInitializer,loopNdx,quantifierRecurse){function handleMatch(match,loopNdx,quantifierRecurse){if(testPos>10000){alert("jquery.inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+getMaskSet().mask);return true;}
if(testPos===pos&&match.matches===undefined){matches.push({"match":match,"locator":loopNdx.reverse()});return true;}else if(match.matches!==undefined){if(match.isGroup&&quantifierRecurse!==match){match=handleMatch(maskToken.matches[$.inArray(match,maskToken.matches)+1],loopNdx);if(match)return true;}else if(match.isOptional){var optionalToken=match;match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match){latestMatch=matches[matches.length-1].match;isFirstMatch=$.inArray(latestMatch,optionalToken.matches)===0;if(isFirstMatch){insertStop=true;testPos=pos;}else return true;}}else if(match.isAlternator){var alternateToken=match,malternateMatches=[],maltMatches,currentMatches=matches.slice(),loopNdxCnt=loopNdx.length;var altIndex=ndxInitializer.length>0?ndxInitializer.shift():-1;if(altIndex===-1||typeof altIndex==="string"){var currentPos=testPos,ndxInitializerClone=ndxInitializer.slice(),altIndexArr=[];if(typeof altIndex=="string")altIndexArr=altIndex.split(",");for(var amndx=0;amndx<alternateToken.matches.length;amndx++){matches=[];match=handleMatch(alternateToken.matches[amndx],[amndx].concat(loopNdx),quantifierRecurse)||match;if(match!==true&&match!==undefined&&(altIndexArr[altIndexArr.length-1]<alternateToken.matches.length)){var ntndx=maskToken.matches.indexOf(match)+1;if(maskToken.matches.length>ntndx){match=handleMatch(maskToken.matches[ntndx],[ntndx].concat(loopNdx.slice(1,loopNdx.length)),quantifierRecurse);if(match){altIndexArr.push(ntndx.toString());$.each(matches,function(ndx,lmnt){lmnt.alternation=loopNdx.length-1;});}}}
maltMatches=matches.slice();testPos=currentPos;matches=[];for(var i=0;i<ndxInitializerClone.length;i++){ndxInitializer[i]=ndxInitializerClone[i];}
for(var ndx1=0;ndx1<maltMatches.length;ndx1++){var altMatch=maltMatches[ndx1];altMatch.alternation=altMatch.alternation||loopNdxCnt;for(var ndx2=0;ndx2<malternateMatches.length;ndx2++){var altMatch2=malternateMatches[ndx2];if(altMatch.match.mask===altMatch2.match.mask&&(typeof altIndex!=="string"||$.inArray(altMatch.locator[altMatch.alternation].toString(),altIndexArr)!==-1)){maltMatches.splice(ndx1,1);ndx1--;altMatch2.locator[altMatch.alternation]=altMatch2.locator[altMatch.alternation]+","+altMatch.locator[altMatch.alternation];altMatch2.alternation=altMatch.alternation;break;}}}
malternateMatches=malternateMatches.concat(maltMatches);}
if(typeof altIndex=="string"){malternateMatches=$.map(malternateMatches,function(lmnt,ndx){if(isFinite(ndx)){var mamatch,alternation=lmnt.alternation,altLocArr=lmnt.locator[alternation].toString().split(",");lmnt.locator[alternation]=undefined;lmnt.alternation=undefined;for(var alndx=0;alndx<altLocArr.length;alndx++){mamatch=$.inArray(altLocArr[alndx],altIndexArr)!==-1;if(mamatch){if(lmnt.locator[alternation]!==undefined){lmnt.locator[alternation]+=",";lmnt.locator[alternation]+=altLocArr[alndx];}else
lmnt.locator[alternation]=parseInt(altLocArr[alndx]);lmnt.alternation=alternation;}}
if(lmnt.locator[alternation]!==undefined)return lmnt;}});}
matches=currentMatches.concat(malternateMatches);testPos=pos;insertStop=matches.length>0;}else{if(alternateToken.matches[altIndex]){match=handleMatch(alternateToken.matches[altIndex],[altIndex].concat(loopNdx),quantifierRecurse);}else match=false;}
if(match)return true;}else if(match.isQuantifier&&quantifierRecurse!==maskToken.matches[$.inArray(match,maskToken.matches)-1]){var qt=match;for(var qndx=(ndxInitializer.length>0)?ndxInitializer.shift():0;(qndx<(isNaN(qt.quantifier.max)?qndx+1:qt.quantifier.max))&&testPos<=pos;qndx++){var tokenGroup=maskToken.matches[$.inArray(qt,maskToken.matches)-1];match=handleMatch(tokenGroup,[qndx].concat(loopNdx),tokenGroup);if(match){latestMatch=matches[matches.length-1].match;latestMatch.optionalQuantifier=qndx>(qt.quantifier.min-1);isFirstMatch=$.inArray(latestMatch,tokenGroup.matches)===0;if(isFirstMatch){if(qndx>(qt.quantifier.min-1)){insertStop=true;testPos=pos;break;}else return true;}else{return true;}}}}else{match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match)
return true;}}else testPos++;}
for(var tndx=(ndxInitializer.length>0?ndxInitializer.shift():0);tndx<maskToken.matches.length;tndx++){if(maskToken.matches[tndx].isQuantifier!==true){var match=handleMatch(maskToken.matches[tndx],[tndx].concat(loopNdx),quantifierRecurse);if(match&&testPos===pos){return match;}else if(testPos>pos){break;}}}}
if(cacheable===true&&getMaskSet().tests[pos]){return getMaskSet().tests[pos];}
if(ndxIntlzr===undefined){var previousPos=pos-1,test;while((test=getMaskSet().validPositions[previousPos])===undefined&&previousPos>-1){if(getMaskSet().tests[previousPos]&&(test=getMaskSet().tests[previousPos][0])!==undefined)
break;previousPos--;}
if(test!==undefined&&previousPos>-1){testPos=previousPos;ndxInitializer=test.locator.slice();}}
for(var mtndx=ndxInitializer.shift();mtndx<maskTokens.length;mtndx++){var match=resolveTestFromToken(maskTokens[mtndx],ndxInitializer,[mtndx]);if((match&&testPos===pos)||testPos>pos){break;}}
if(matches.length===0||insertStop)
matches.push({"match":{fn:null,cardinality:0,optionality:true,casing:null,def:""},"locator":[]});getMaskSet().tests[pos]=$.extend(true,[],matches);return getMaskSet().tests[pos];}
function getBufferTemplate(){if(getMaskSet()._buffer===undefined){getMaskSet()._buffer=getMaskTemplate(false,1);}
return getMaskSet()._buffer;}
function getBuffer(){if(getMaskSet().buffer===undefined){getMaskSet().buffer=getMaskTemplate(true,getLastValidPosition(),true);}
return getMaskSet().buffer;}
function refreshFromBuffer(start,end,buffer){var i;buffer=buffer||getBuffer().slice();if(start===true){resetMaskSet();start=0;end=buffer.length;}else{for(i=start;i<end;i++){delete getMaskSet().validPositions[i];delete getMaskSet().tests[i];}}
for(i=start;i<end;i++){if(buffer[i]!==opts.skipOptionalPartCharacter){isValid(i,buffer[i],true,true);}}}
function casing(elem,test){switch(test.casing){case"upper":elem=elem.toUpperCase();break;case"lower":elem=elem.toLowerCase();break;}
return elem;}
function checkAlternationMatch(altArr1,altArr2){var altArrC=opts.greedy?altArr2:altArr2.slice(0,1),isMatch=false;for(var alndx=0;alndx<altArr1.length;alndx++){if($.inArray(altArr1[alndx],altArrC)!==-1){isMatch=true;break;}}
return isMatch;}
function isValid(pos,c,strict,fromSetValid){strict=strict===true;function _isValid(position,c,strict,fromSetValid){var rslt=false;$.each(getTests(position),function(ndx,tst){var test=tst.match;var loopend=c?1:0,chrs='',buffer=getBuffer();for(var i=test.cardinality;i>loopend;i--){chrs+=getBufferElement(position-(i-1));}
if(c){chrs+=c;}
rslt=test.fn!=null?test.fn.test(chrs,getMaskSet(),position,strict,opts):(c===test.def||c===opts.skipOptionalPartCharacter)&&test.def!==""?{c:test.def,pos:position}:false;if(rslt!==false){var elem=rslt.c!==undefined?rslt.c:c;elem=(elem===opts.skipOptionalPartCharacter&&test.fn===null)?test.def:elem;var validatedPos=position,possibleModifiedBuffer=getBuffer();if(rslt.remove!==undefined){if(!$.isArray(rslt.remove))rslt.remove=[rslt.remove];$.each(rslt.remove.sort(function(a,b){return b-a;}),function(ndx,lmnt){stripValidPositions(lmnt,lmnt+1,true);});}
if(rslt.insert!==undefined){if(!$.isArray(rslt.insert))rslt.insert=[rslt.insert];$.each(rslt.insert.sort(function(a,b){return a-b;}),function(ndx,lmnt){isValid(lmnt.pos,lmnt.c,true);});}
if(rslt.refreshFromBuffer){var refresh=rslt.refreshFromBuffer;strict=true;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,possibleModifiedBuffer);if(rslt.pos===undefined&&rslt.c===undefined){rslt.pos=getLastValidPosition();return false;}
validatedPos=rslt.pos!==undefined?rslt.pos:position;if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true));return false;}}else if(rslt!==true&&rslt.pos!==undefined&&rslt.pos!==position){validatedPos=rslt.pos;refreshFromBuffer(position,validatedPos);if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true));return false;}}
if(rslt!==true&&rslt.pos===undefined&&rslt.c===undefined){return false;}
if(ndx>0){resetMaskSet(true);}
if(!setValidPosition(validatedPos,$.extend({},tst,{"input":casing(elem,test)}),fromSetValid))
rslt=false;return false;}});return rslt;}
function alternate(pos,c,strict,fromSetValid){var validPsClone=$.extend(true,{},getMaskSet().validPositions),lastAlt,alternation,isValidRslt,altPos,i,validPos;for(var lAlt=getLastValidPosition();lAlt>=0;lAlt--){altPos=getMaskSet().validPositions[lAlt];if(altPos&&altPos.alternation!==undefined){lastAlt=lAlt;alternation=getMaskSet().validPositions[lastAlt].alternation;if(getTestTemplate(lastAlt).locator[altPos.alternation]!==altPos.locator[altPos.alternation]){break;}}}
if(alternation!==undefined){lastAlt=parseInt(lastAlt);for(var decisionPos in getMaskSet().validPositions){decisionPos=parseInt(decisionPos);altPos=getMaskSet().validPositions[decisionPos];if(decisionPos>=lastAlt&&altPos.alternation!==undefined){var altNdxs=getMaskSet().validPositions[lastAlt].locator[alternation].toString().split(','),decisionTaker=altPos.locator[alternation]||altNdxs[0];if(decisionTaker.length>0){decisionTaker=decisionTaker.split(',')[0];}
for(var mndx=0;mndx<altNdxs.length;mndx++){if(decisionTaker<altNdxs[mndx]){var possibilityPos,possibilities;for(var dp=decisionPos;dp>=0;dp--){possibilityPos=getMaskSet().validPositions[dp];if(possibilityPos!==undefined){possibilities=possibilityPos.locator[alternation];possibilityPos.locator[alternation]=parseInt(altNdxs[mndx]);break;}}
if(decisionTaker!==possibilityPos.locator[alternation]){var validInputs=[],staticInputsBeforePos=0;for(i=decisionPos+1;i<getLastValidPosition()+1;i++){validPos=getMaskSet().validPositions[i];if(validPos){if(validPos.match.fn!=null){validInputs.push(validPos.input);}else if(i<pos)staticInputsBeforePos++;}
delete getMaskSet().validPositions[i];delete getMaskSet().tests[i];}
resetMaskSet(true);opts.keepStatic=!opts.keepStatic;isValidRslt=true;while(validInputs.length>0){var input=validInputs.shift();if(input!==opts.skipOptionalPartCharacter){if(!(isValidRslt=isValid(getLastValidPosition()+1,input,false,true))){break;}}}
possibilityPos.alternation=alternation;possibilityPos.locator[alternation]=possibilities;if(isValidRslt){var targetLvp=getLastValidPosition(pos)+1;var staticInputsBeforePosAlternate=0;for(i=decisionPos+1;i<getLastValidPosition()+1;i++){validPos=getMaskSet().validPositions[i];if(validPos&&validPos.match.fn==null&&i<pos)
staticInputsBeforePosAlternate++;}
pos=pos+(staticInputsBeforePosAlternate-staticInputsBeforePos);isValidRslt=isValid(pos>targetLvp?targetLvp:pos,c,strict,fromSetValid);}
opts.keepStatic=!opts.keepStatic;if(!isValidRslt){resetMaskSet();getMaskSet().validPositions=$.extend(true,{},validPsClone);}else
return isValidRslt;}}}
break;}}}
return false;}
function trackbackAlternations(originalPos,newPos){var vp=getMaskSet().validPositions[newPos],targetLocator=vp.locator,tll=targetLocator.length;for(var ps=originalPos;ps<newPos;ps++){if(!isMask(ps)){var tests=getTests(ps),bestMatch=tests[0],equality=-1;$.each(tests,function(ndx,tst){for(var i=0;i<tll;i++){if(tst.locator[i]&&checkAlternationMatch(tst.locator[i].toString().split(','),targetLocator[i].toString().split(','))&&equality<i){equality=i;bestMatch=tst;}}});setValidPosition(ps,$.extend({},bestMatch,{"input":bestMatch.match.def}),true);}}}
var buffer=getBuffer();for(var pndx=pos-1;pndx>-1;pndx--){if(getMaskSet().validPositions[pndx])
break;}
pndx++;for(;pndx<pos;pndx++){if(getMaskSet().validPositions[pndx]===undefined&&(((!isMask(pndx)||buffer[pndx]!==getPlaceholder(pndx))&&getTests(pndx).length>1)||(buffer[pndx]===opts.radixPoint||buffer[pndx]==="0"&&$.inArray(opts.radixPoint,buffer)<pndx)))
{_isValid(pndx,buffer[pndx],true);}}
var maskPos=pos,result=false,positionsClone=$.extend(true,{},getMaskSet().validPositions);if(maskPos<getMaskLength()){result=_isValid(maskPos,c,strict,fromSetValid);if((!strict||fromSetValid)&&result===false){var currentPosValid=getMaskSet().validPositions[maskPos];if(currentPosValid&&currentPosValid.match.fn===null&&(currentPosValid.match.def===c||c===opts.skipOptionalPartCharacter)){result={"caret":seekNext(maskPos)};}else if((opts.insertMode||getMaskSet().validPositions[seekNext(maskPos)]===undefined)&&!isMask(maskPos)){for(var nPos=maskPos+1,snPos=seekNext(maskPos);nPos<=snPos;nPos++){result=_isValid(nPos,c,strict,fromSetValid);if(result!==false){trackbackAlternations(maskPos,nPos);maskPos=nPos;break;}}}}}
if(result===false&&opts.keepStatic&&isComplete(buffer)){result=alternate(pos,c,strict,fromSetValid);}
if(result===true)result={"pos":maskPos};if($.isFunction(opts.postValidation)&&result!==false&&!strict){resetMaskSet(true);var postValidResult=opts.postValidation(getBuffer(),opts);if(!postValidResult){resetMaskSet(true);getMaskSet().validPositions=$.extend(true,{},positionsClone);result=false;}else if(postValidResult.refreshFromBuffer){var refresh=postValidResult.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,postValidResult.buffer);resetMaskSet(true);result=postValidResult;}}
return result;}
function isMask(pos){var test=getTest(pos);if(test.fn!=null)
return test.fn;else if(!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos),staticAlternations=true;for(var i=0;i<tests.length;i++){if(tests[i].match.def!==""&&((tests[i].alternation===undefined||tests[i].locator[tests[i].alternation].length>1))){staticAlternations=false;break;}}
return staticAlternations;}
return false;}
function getMaskLength(){var maskLength;maxLength=$el.prop("maxLength");if(maxLength===-1)maxLength=undefined;var pos,lvp=getLastValidPosition(),testPos=getMaskSet().validPositions[lvp],ndxIntlzr=testPos!==undefined?testPos.locator.slice():undefined;for(pos=lvp+1;testPos===undefined||(testPos.match.fn!==null||(testPos.match.fn===null&&testPos.match.def!==""));pos++){testPos=getTestTemplate(pos,ndxIntlzr,pos-1);ndxIntlzr=testPos.locator.slice();}
var lastTest=getTest(pos-1);maskLength=(lastTest.def!=="")?pos:pos-1;return(maxLength===undefined||maskLength<maxLength)?maskLength:maxLength;}
function seekNext(pos,newBlock){var maskL=getMaskLength();if(pos>=maskL)return maskL;var position=pos;while(++position<maskL&&((newBlock===true&&(getTest(position).newBlockMarker!==true||!isMask(position)))||(newBlock!==true&&!isMask(position)&&(opts.nojumps!==true||opts.nojumpsThreshold>position)))){}
return position;}
function seekPrevious(pos,newBlock){var position=pos;if(position<=0)return 0;while(--position>0&&((newBlock===true&&getTest(position).newBlockMarker!==true)||(newBlock!==true&&!isMask(position)))){}
return position;}
function getBufferElement(position){return getMaskSet().validPositions[position]===undefined?getPlaceholder(position):getMaskSet().validPositions[position].input;}
function writeBuffer(input,buffer,caretPos,event,triggerInputEvent){if(event&&$.isFunction(opts.onBeforeWrite)){var result=opts.onBeforeWrite.call(input,event,buffer,caretPos,opts);if(result){if(result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer||buffer);resetMaskSet(true);buffer=getBuffer();}
caretPos=result.caret!==undefined?result.caret:caretPos;}}
input.inputmask._valueSet(buffer.join(''));if(caretPos!==undefined&&(event===undefined||event.type!=="blur")){caret(input,caretPos);}
if(triggerInputEvent===true){skipInputEvent=true;$(input).trigger("input");}}
function getPlaceholder(pos,test){test=test||getTest(pos);if(test.placeholder!==undefined)
return test.placeholder;else if(test.fn===null){if(!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos),hasAlternations=false,prevTest;for(var i=0;i<tests.length;i++){if(prevTest&&tests[i].match.def!==""&&(tests[i].match.def!==prevTest.match.def&&(tests[i].alternation===undefined||tests[i].alternation===prevTest.alternation))){hasAlternations=true;break;}
if(tests[i].match.optionality!==true&&tests[i].match.optionalQuantifier!==true)
prevTest=tests[i];}
if(hasAlternations)
return opts.placeholder.charAt(pos%opts.placeholder.length);}
return test.def;}else{return opts.placeholder.charAt(pos%opts.placeholder.length);}}
function checkVal(input,writeOut,strict,nptvl){var inputValue=nptvl!==undefined?nptvl.slice():input.inputmask._valueGet().split(''),charCodes="",initialNdx=0;function isTemplateMatch(){var isMatch=false;var charCodeNdx=getBufferTemplate().slice(initialNdx,seekNext(initialNdx)).join("").indexOf(charCodes);if(charCodeNdx!==-1&&!isMask(initialNdx)){isMatch=true;var bufferTemplateArr=getBufferTemplate().slice(initialNdx,initialNdx+charCodeNdx);for(var i=0;i<bufferTemplateArr.length;i++){if(bufferTemplateArr[i]!==" "){isMatch=false;break;}}}
return isMatch;}
resetMaskSet();getMaskSet().p=seekNext(-1);if(writeOut)input.inputmask._valueSet("");if(!strict){if(opts.autoUnmask!==true){var staticInput=getBufferTemplate().slice(0,seekNext(-1)).join(''),matches=inputValue.join('').match(new RegExp("^"+Inputmask.escapeRegex(staticInput),"g"));if(matches&&matches.length>0){inputValue.splice(0,matches.length*staticInput.length);initialNdx=seekNext(initialNdx);}}else{initialNdx=seekNext(initialNdx);}}
$.each(inputValue,function(ndx,charCode){var keypress=$.Event("keypress");keypress.which=charCode.charCodeAt(0);charCodes+=charCode;var lvp=getLastValidPosition(undefined,true),lvTest=getMaskSet().validPositions[lvp],nextTest=getTestTemplate(lvp+1,lvTest?lvTest.locator.slice():undefined,lvp);if(!isTemplateMatch()||strict||opts.autoUnmask){var pos=strict?ndx:(nextTest.match.fn==null&&nextTest.match.optionality&&(lvp+1)<getMaskSet().p?lvp+1:getMaskSet().p);keypressEvent.call(input,keypress,true,false,strict,pos);initialNdx=pos+1;charCodes="";}else{keypressEvent.call(input,keypress,true,false,true,lvp+1);}});if(writeOut){writeBuffer(input,getBuffer(),$(input).is(":focus")?seekNext(getLastValidPosition(0)):undefined,$.Event("checkval"));}}
function unmaskedvalue($input){if($input[0].inputmask&&!$input.hasClass("hasDatepicker")){var umValue=[],vps=getMaskSet().validPositions;for(var pndx in vps){if(vps[pndx].match&&vps[pndx].match.fn!=null){umValue.push(vps[pndx].input);}}
var unmaskedValue=umValue.length===0?null:(isRTL?umValue.reverse():umValue).join("");if(unmaskedValue!==null){var bufferValue=(isRTL?getBuffer().slice().reverse():getBuffer()).join("");if($.isFunction(opts.onUnMask)){unmaskedValue=(opts.onUnMask.call($input,bufferValue,unmaskedValue,opts)||unmaskedValue);}}
return unmaskedValue;}else{return $input[0].inputmask._valueGet();}}
function caret(input,begin,end){function translatePosition(pos){if(isRTL&&typeof pos==="number"&&(!opts.greedy||opts.placeholder!=="")){var bffrLght=getBuffer().join("").length;pos=bffrLght-pos;}
return pos;}
var npt=input.jquery&&input.length>0?input[0]:input,range;if(typeof begin==="number"){begin=translatePosition(begin);end=translatePosition(end);end=(typeof end=="number")?end:begin;if(!$(npt).is(":visible")){return;}
var scrollCalc=$(npt).css("font-size").replace("px","")*end;npt.scrollLeft=scrollCalc>npt.scrollWidth?scrollCalc:0;if(!androidchrome&&opts.insertMode===false&&begin===end)end++;if(npt.setSelectionRange){npt.selectionStart=begin;npt.selectionEnd=end;}else if(window.getSelection){range=document.createRange();if(npt.firstChild===undefined){var textNode=document.createTextNode("");npt.appendChild(textNode);}
range.setStart(npt.firstChild,begin<npt.inputmask._valueGet().length?begin:npt.inputmask._valueGet().length);range.setEnd(npt.firstChild,end<npt.inputmask._valueGet().length?end:npt.inputmask._valueGet().length);range.collapse(true);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range);}else if(npt.createTextRange){range=npt.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select();}}else{if(npt.setSelectionRange){begin=npt.selectionStart;end=npt.selectionEnd;}else if(window.getSelection){range=window.getSelection().getRangeAt(0);if(range.commonAncestorContainer.parentNode===npt||range.commonAncestorContainer===npt){begin=range.startOffset;end=range.endOffset;}}else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=0-range.duplicate().moveStart("character",-100000);end=begin+range.text.length;}
return{"begin":translatePosition(begin),"end":translatePosition(end)};}}
function determineLastRequiredPosition(returnDefinition){var buffer=getBuffer(),bl=buffer.length,pos,lvp=getLastValidPosition(),positions={},lvTest=getMaskSet().validPositions[lvp],ndxIntlzr=lvTest!==undefined?lvTest.locator.slice():undefined,testPos;for(pos=lvp+1;pos<buffer.length;pos++){testPos=getTestTemplate(pos,ndxIntlzr,pos-1);ndxIntlzr=testPos.locator.slice();positions[pos]=$.extend(true,{},testPos);}
var lvTestAlt=lvTest&&lvTest.alternation!==undefined?lvTest.locator[lvTest.alternation]:undefined;for(pos=bl-1;pos>lvp;pos--){testPos=positions[pos];if((testPos.match.optionality||testPos.match.optionalQuantifier||(lvTestAlt&&((lvTestAlt!==positions[pos].locator[lvTest.alternation]&&testPos.match.fn!=null)||(testPos.match.fn===null&&testPos.locator[lvTest.alternation]&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(","),lvTestAlt.toString().split(","))&&getTests(pos)[0].def!==""))))&&buffer[pos]===getPlaceholder(pos,testPos.match)){bl--;}else break;}
return returnDefinition?{"l":bl,"def":positions[bl]?positions[bl].match:undefined}:bl;}
function clearOptionalTail(buffer){var rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break;}
buffer.splice(rl,lmib+1-rl);return buffer;}
function isComplete(buffer){if($.isFunction(opts.isComplete))return opts.isComplete.call($el,buffer,opts);if(opts.repeat==="*")return undefined;var complete=false,lrp=determineLastRequiredPosition(true),aml=seekPrevious(lrp.l);if(lrp.def===undefined||lrp.def.newBlockMarker||lrp.def.optionality||lrp.def.optionalQuantifier){complete=true;for(var i=0;i<=aml;i++){var test=getTestTemplate(i).match;if((test.fn!==null&&getMaskSet().validPositions[i]===undefined&&test.optionality!==true&&test.optionalQuantifier!==true)||(test.fn===null&&buffer[i]!==getPlaceholder(i,test))){complete=false;break;}}}
return complete;}
function isSelection(begin,end){return isRTL?(begin-end)>1||((begin-end)===1&&opts.insertMode):(end-begin)>1||((end-begin)===1&&opts.insertMode);}
function installEventRuler(npt){var events=$._data(npt).events,inComposition=false;$.each(events,function(eventType,eventHandlers){$.each(eventHandlers,function(ndx,eventHandler){if(eventHandler.namespace==="inputmask"){var handler=eventHandler.handler;eventHandler.handler=function(e){if(this.inputmask===undefined){var imOpts=$(this).data("_inputmask_opts");if(imOpts)
(new Inputmask(imOpts)).mask(this);else $(this).unbind(".inputmask");}else if(e.type!=="setvalue"&&(this.disabled||(this.readOnly&&!(e.type==="keydown"&&(e.ctrlKey&&e.keyCode===67)||(opts.tabThrough===false&&e.keyCode===Inputmask.keyCode.TAB)))))
e.preventDefault();else{switch(e.type){case"input":if(skipInputEvent===true||inComposition===true){skipInputEvent=false;return e.preventDefault();}
break;case"keydown":skipKeyPressEvent=false;inComposition=false;break;case"keypress":if(skipKeyPressEvent===true)
return e.preventDefault();skipKeyPressEvent=true;break;case"compositionstart":inComposition=true;break;case"compositionupdate":skipInputEvent=true;break;case"compositionend":inComposition=false;break;}
return handler.apply(this,arguments);}};}});});}
function patchValueProperty(npt){var valueGet;var valueSet;function patchValhook(type){if($.valHooks[type]===undefined||$.valHooks[type].inputmaskpatch!==true){var valhookGet=$.valHooks[type]&&$.valHooks[type].get?$.valHooks[type].get:function(elem){return elem.value;};var valhookSet=$.valHooks[type]&&$.valHooks[type].set?$.valHooks[type].set:function(elem,value){elem.value=value;return elem;};$.valHooks[type]={get:function(elem){var $elem=$(elem);if(elem.inputmask){if(elem.inputmask.opts.autoUnmask)
return elem.inputmask.unmaskedvalue();else{var result=valhookGet(elem),maskset=elem.inputmask.maskset,bufferTemplate=maskset._buffer;bufferTemplate=bufferTemplate?bufferTemplate.join(""):"";return result!==bufferTemplate?result:"";}}else return valhookGet(elem);},set:function(elem,value){var $elem=$(elem),result;result=valhookSet(elem,value);if(elem.inputmask)
$elem.triggerHandler("setvalue.inputmask");return result;},inputmaskpatch:true};}}
function getter(){if(this.inputmask)
return this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():(valueGet.call(this)!==getBufferTemplate().join("")?valueGet.call(this):"");else return valueGet.call(this);}
function setter(value){valueSet.call(this,value);if(this.inputmask)
$(this).triggerHandler("setvalue.inputmask");}
function installNativeValueSetFallback(npt){$(npt).bind("mouseenter.inputmask",function(event){var $input=$(this),input=this,value=input.inputmask._valueGet();if(value!==""&&value!==getBuffer().join(""))
$input.triggerHandler("setvalue.inputmask");});var events=$._data(npt).events;var handlers=events.mouseover;if(handlers){var ourHandler=handlers[handlers.length-1];for(var i=handlers.length-1;i>0;i--){handlers[i]=handlers[i-1];}
handlers[0]=ourHandler;}}
if(!npt.inputmask.__valueGet){var valueProperty;if(Object.getOwnPropertyDescriptor&&npt.value===undefined){valueGet=function(){return this.textContent;};valueSet=function(value){this.textContent=value;};Object.defineProperty(npt,"value",{get:getter,set:setter});}else if((valueProperty=(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(npt,"value")))&&valueProperty.configurable&&false){npt._value=valueProperty.value;valueGet=function(){return this._value||"";};valueSet=function(value){this._value=value;this.select();this.setRangeText(value);this.selectionStart=this.selectionEnd;};Object.defineProperty(npt,"value",{get:getter,set:setter});}else if(document.__lookupGetter__&&npt.__lookupGetter__("value")){valueGet=npt.__lookupGetter__("value");valueSet=npt.__lookupSetter__("value");npt.__defineGetter__("value",getter);npt.__defineSetter__("value",setter);}else{valueGet=function(){return npt.value;};valueSet=function(value){npt.value=value;};patchValhook(npt.type);installNativeValueSetFallback(npt);}
npt.inputmask.__valueGet=valueGet;npt.inputmask._valueGet=function(overruleRTL){return isRTL&&overruleRTL!==true?valueGet.call(this.el).split("").reverse().join(""):valueGet.call(this.el);};npt.inputmask.__valueSet=valueSet;npt.inputmask._valueSet=function(value){valueSet.call(this.el,isRTL?value.split("").reverse().join(""):value);};}}
function handleRemove(input,k,pos,strict){function generalize(){if(opts.keepStatic){resetMaskSet(true);var validInputs=[],lastAlt,positionsClone=$.extend(true,{},getMaskSet().validPositions);for(lastAlt=getLastValidPosition();lastAlt>=0;lastAlt--){var validPos=getMaskSet().validPositions[lastAlt];if(validPos){if(validPos.match.fn!=null)
validInputs.push(validPos.input);delete getMaskSet().validPositions[lastAlt];if(validPos.alternation!==undefined&&validPos.locator[validPos.alternation]===getTestTemplate(lastAlt).locator[validPos.alternation])
break;}}
if(lastAlt>-1)
while(validInputs.length>0){getMaskSet().p=seekNext(getLastValidPosition());var keypress=$.Event("keypress");keypress.which=validInputs.pop().charCodeAt(0);keypressEvent.call(input,keypress,true,false,false,getMaskSet().p);}else getMaskSet().validPositions=$.extend(true,{},positionsClone);}}
if(opts.numericInput||isRTL){if(k===Inputmask.keyCode.BACKSPACE)
k=Inputmask.keyCode.DELETE;else if(k===Inputmask.keyCode.DELETE)
k=Inputmask.keyCode.BACKSPACE;if(isRTL){var pend=pos.end;pos.end=pos.begin;pos.begin=pend;}}
if(k===Inputmask.keyCode.BACKSPACE&&(pos.end-pos.begin<1||opts.insertMode===false)){pos.begin=seekPrevious(pos.begin);if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.begin--;}}else if(k===Inputmask.keyCode.DELETE&&pos.begin===pos.end){pos.end=isMask(pos.end)?pos.end+1:seekNext(pos.end)+1;if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.end++;}}
stripValidPositions(pos.begin,pos.end,false,strict);if(strict!==true)
generalize();var lvp=getLastValidPosition(pos.begin);if(lvp<pos.begin){if(lvp===-1)resetMaskSet();getMaskSet().p=seekNext(lvp);}else if(strict!==true){getMaskSet().p=pos.begin;}}
function keydownEvent(e){var input=this,$input=$(input),k=e.keyCode,pos=caret(input);if(k===Inputmask.keyCode.BACKSPACE||k===Inputmask.keyCode.DELETE||(iphone&&k===127)||(e.ctrlKey&&k===88&&!isInputEventSupported("cut"))){e.preventDefault();if(k===88)undoValue=getBuffer().join('');handleRemove(input,k,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(''));if(input.inputmask._valueGet()===getBufferTemplate().join(''))
$input.trigger('cleared');else if(isComplete(getBuffer())===true)
$input.trigger("complete");if(opts.showTooltip){$input.prop("title",getMaskSet().mask);}}else if(k===Inputmask.keyCode.END||k===Inputmask.keyCode.PAGE_DOWN){setTimeout(function(){var caretPos=seekNext(getLastValidPosition());if(!opts.insertMode&&caretPos===getMaskLength()&&!e.shiftKey)caretPos--;caret(input,e.shiftKey?pos.begin:caretPos,caretPos);},0);}else if((k===Inputmask.keyCode.HOME&&!e.shiftKey)||k===Inputmask.keyCode.PAGE_UP){caret(input,0,e.shiftKey?pos.begin:0);}else if(((opts.undoOnEscape&&k===Inputmask.keyCode.ESCAPE)||(k===90&&e.ctrlKey))&&e.altKey!==true){checkVal(input,true,false,undoValue.split(''));$input.click();}else if(k===Inputmask.keyCode.INSERT&&!(e.shiftKey||e.ctrlKey)){opts.insertMode=!opts.insertMode;caret(input,!opts.insertMode&&pos.begin===getMaskLength()?pos.begin-1:pos.begin);}else if(opts.tabThrough===true&&k===Inputmask.keyCode.TAB){if(e.shiftKey===true){if(getTest(pos.begin).fn===null)
pos.begin=seekNext(pos.begin);pos.end=seekPrevious(pos.begin,true);pos.begin=seekPrevious(pos.end,true);}else{pos.begin=seekNext(pos.begin,true);pos.end=seekNext(pos.begin,true);if(pos.end<getMaskLength())pos.end--;}
if(pos.begin<getMaskLength()){e.preventDefault();caret(input,pos.begin,pos.end);}}else if(opts.insertMode===false&&!e.shiftKey){if(k===Inputmask.keyCode.RIGHT){setTimeout(function(){var caretPos=caret(input);caret(input,caretPos.begin);},0);}else if(k===Inputmask.keyCode.LEFT){setTimeout(function(){var caretPos=caret(input);caret(input,isRTL?caretPos.begin+1:caretPos.begin-1);},0);}}
opts.onKeyDown.call(this,e,getBuffer(),caret(input).begin,opts);ignorable=$.inArray(k,opts.ignorables)!==-1;}
function keypressEvent(e,checkval,writeOut,strict,ndx){var input=this,$input=$(input),k=e.which||e.charCode||e.keyCode;if(checkval!==true&&(!(e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||ignorable))){if(k===Inputmask.keyCode.ENTER&&undoValue!==getBuffer().join("")){setTimeout(function(){$input.change();undoValue=getBuffer().join("");},0);}
return true;}else{if(k){if(k===46&&e.shiftKey===false&&opts.radixPoint===",")k=44;var pos=checkval?{begin:ndx,end:ndx}:caret(input),forwardPosition,c=String.fromCharCode(k);var isSlctn=isSelection(pos.begin,pos.end);if(isSlctn){getMaskSet().undoPositions=$.extend(true,{},getMaskSet().validPositions);handleRemove(input,Inputmask.keyCode.DELETE,pos,true);pos.begin=getMaskSet().p;if(!opts.insertMode){opts.insertMode=!opts.insertMode;setValidPosition(pos.begin,strict);opts.insertMode=!opts.insertMode;}
isSlctn=!opts.multi;}
getMaskSet().writeOutBuffer=true;var p=isRTL&&!isSlctn?pos.end:pos.begin;var valResult=isValid(p,c,strict);if(valResult!==false){if(valResult!==true){p=valResult.pos!==undefined?valResult.pos:p;c=valResult.c!==undefined?valResult.c:c;}
resetMaskSet(true);if(valResult.caret!==undefined)
forwardPosition=valResult.caret;else{var vps=getMaskSet().validPositions;if(!opts.keepStatic&&(vps[p+1]!==undefined&&getTests(p+1,vps[p].locator.slice(),p).length>1||vps[p].alternation!==undefined))
forwardPosition=p+1;else
forwardPosition=seekNext(p);}
getMaskSet().p=forwardPosition;}
if(writeOut!==false){var self=this;setTimeout(function(){opts.onKeyValidation.call(self,valResult,opts);},0);if(getMaskSet().writeOutBuffer&&valResult!==false){var buffer=getBuffer();writeBuffer(input,buffer,checkval?undefined:opts.numericInput?seekPrevious(forwardPosition):forwardPosition,e,checkval!==true);if(checkval!==true){setTimeout(function(){if(isComplete(buffer)===true)
$input.trigger("complete");},0);}}else if(isSlctn){getMaskSet().buffer=undefined;getMaskSet().validPositions=getMaskSet().undoPositions;}}else if(isSlctn){getMaskSet().buffer=undefined;getMaskSet().validPositions=getMaskSet().undoPositions;}
if(opts.showTooltip){$input.prop("title",getMaskSet().mask);}
if(checkval&&$.isFunction(opts.onBeforeWrite)){var result=opts.onBeforeWrite.call(this,e,getBuffer(),forwardPosition,opts);if(result&&result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer);resetMaskSet(true);if(result.caret){getMaskSet().p=result.caret;}}}
e.preventDefault();if(checkval){return valResult;}}}}
function pasteEvent(e){var input=this,$input=$(input),inputValue=input.inputmask._valueGet(true),caretPos=caret(input);if(e.type==="propertychange"&&input.inputmask._valueGet().length<=getMaskLength()){return true;}else if(e.type==="paste"){var valueBeforeCaret=inputValue.substr(0,caretPos.begin),valueAfterCaret=inputValue.substr(caretPos.end,inputValue.length);if(valueBeforeCaret===getBufferTemplate().slice(0,caretPos.begin).join(""))valueBeforeCaret="";if(valueAfterCaret===getBufferTemplate().slice(caretPos.end).join(""))valueAfterCaret="";if(window.clipboardData&&window.clipboardData.getData){inputValue=valueBeforeCaret+window.clipboardData.getData('Text')+valueAfterCaret;}else if(e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData){inputValue=valueBeforeCaret+e.originalEvent.clipboardData.getData('text/plain')+valueAfterCaret;}}
var pasteValue=inputValue;if($.isFunction(opts.onBeforePaste)){pasteValue=opts.onBeforePaste.call(input,inputValue,opts);if(pasteValue===false){e.preventDefault();return false;}
if(!pasteValue)
pasteValue=inputValue;}
checkVal(input,false,false,isRTL?pasteValue.split('').reverse():pasteValue.split(''));writeBuffer(input,getBuffer(),undefined,e,true);$input.click();if(isComplete(getBuffer())===true)
$input.trigger("complete");return false;}
function inputFallBackEvent(e){var input=this;checkVal(input,true,false);if(isComplete(getBuffer())===true)
$(input).trigger("complete");e.preventDefault();}
function compositionStartEvent(e){var input=this;undoValue=getBuffer().join("");if(compositionData===""||e.originalEvent.data.indexOf(compositionData)!==0){compositionCaretPos=caret(input);}}
function compositionUpdateEvent(e){var input=this,caretPos=caret(input);if(e.originalEvent.data.indexOf(compositionData)===0){resetMaskSet();caretPos=compositionCaretPos;}
var newData=e.originalEvent.data;caret(input,caretPos.begin,caretPos.end);for(var i=0;i<newData.length;i++){var keypress=$.Event("keypress");keypress.which=newData.charCodeAt(i);skipKeyPressEvent=false;ignorable=false;keypressEvent.call(input,keypress);}
setTimeout(function(){var forwardPosition=getMaskSet().p;writeBuffer(input,getBuffer(),opts.numericInput?seekPrevious(forwardPosition):forwardPosition);},0);compositionData=e.originalEvent.data;}
function compositionEndEvent(e){}
function mask(el){$el=$(el);if(opts.showTooltip)
$el.prop("title",getMaskSet().mask);if(el.dir==="rtl"||opts.rightAlign)
$el.css("text-align","right");if(el.dir==="rtl"||opts.numericInput){el.dir="ltr";$el.removeAttr("dir");el.inputmask.isRTL=true;isRTL=true;}
$el.unbind(".inputmask");if(($el.is(":input")&&isInputTypeSupported($el.attr("type")))||el.isContentEditable){$el.closest("form").bind("submit",function(){if(undoValue!==getBuffer().join(""))
$el.change();if(opts.clearMaskOnLostFocus&&getLastValidPosition()===-1&&$el[0].inputmask._valueGet&&$el[0].inputmask._valueGet()===getBufferTemplate().join(""))
$el[0].inputmask._valueSet("");if(opts.removeMaskOnSubmit)
$el.inputmask("remove");}).bind("reset",function(){setTimeout(function(){$el.triggerHandler("setvalue.inputmask");},0);});$el.bind("mouseenter.inputmask",function(){var $input=$(this),input=this;mouseEnter=true;if(!$input.is(":focus")&&opts.showMaskOnHover)
if(input.inputmask._valueGet()!==getBuffer().join(""))
writeBuffer(input,getBuffer());}).bind("blur.inputmask",function(e){var $input=$(this),input=this;if(input.inputmask){var nptValue=input.inputmask._valueGet(),buffer=getBuffer().slice();firstClick=true;if(undoValue!==buffer.join("")){setTimeout(function(){$input.change();undoValue=buffer.join("");},0);}
if(nptValue!==""){if(opts.clearMaskOnLostFocus){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join(""))
buffer=[];else{clearOptionalTail(buffer);}}
if(isComplete(buffer)===false){setTimeout(function(){$input.trigger("incomplete");},0);if(opts.clearIncomplete){resetMaskSet();if(opts.clearMaskOnLostFocus)
buffer=[];else{buffer=getBufferTemplate().slice();}}}
writeBuffer(input,buffer,undefined,e);}}}).bind("focus.inputmask",function(e){var $input=$(this),input=this,nptValue=input.inputmask._valueGet();if(opts.showMaskOnFocus&&(!opts.showMaskOnHover||(opts.showMaskOnHover&&nptValue===""))){if(input.inputmask._valueGet()!==getBuffer().join("")){writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()));}}else if(mouseEnter===false){caret(input,seekNext(getLastValidPosition()));}
if(opts.positionCaretOnTab===true){setTimeout(function(){caret(input,seekNext(getLastValidPosition()));},0);}
undoValue=getBuffer().join('');}).bind("mouseleave.inputmask",function(){var $input=$(this),input=this;mouseEnter=false;if(opts.clearMaskOnLostFocus){var buffer=getBuffer().slice(),nptValue=input.inputmask._valueGet();if(!$input.is(":focus")&&nptValue!==$input.attr("placeholder")&&nptValue!==""){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join(""))
buffer=[];else{clearOptionalTail(buffer);}
writeBuffer(input,buffer);}}}).bind("click.inputmask",function(){var $input=$(this),input=this;if($input.is(":focus")){var selectedCaret=caret(input);if(selectedCaret.begin===selectedCaret.end){if(opts.radixFocus&&opts.radixPoint!==""&&$.inArray(opts.radixPoint,getBuffer())!==-1&&(firstClick||getBuffer().join("")===getBufferTemplate().join(""))){caret(input,$.inArray(opts.radixPoint,getBuffer()));firstClick=false;}else{var clickPosition=selectedCaret.begin,lastPosition=seekNext(getLastValidPosition(clickPosition));if(clickPosition<lastPosition){caret(input,isMask(clickPosition)?clickPosition:seekNext(clickPosition));}else{caret(input,opts.numericInput?0:lastPosition);}}}}}).bind("dblclick.inputmask",function(){var input=this;setTimeout(function(){caret(input,0,seekNext(getLastValidPosition()));},0);}).bind(PasteEventType+".inputmask dragdrop.inputmask drop.inputmask",pasteEvent).bind("cut.inputmask",function(e){skipInputEvent=true;var input=this,$input=$(input),pos=caret(input);if(isRTL){var clipboardData=window.clipboardData||e.originalEvent.clipboardData,clipData=clipboardData.getData("text").split('').reverse().join('');clipboardData.setData("text",clipData);}
handleRemove(input,Inputmask.keyCode.DELETE,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(""));if(input.inputmask._valueGet()===getBufferTemplate().join(''))
$input.trigger("cleared");if(opts.showTooltip){$input.prop("title",getMaskSet().mask);}}).bind("complete.inputmask",opts.oncomplete).bind("incomplete.inputmask",opts.onincomplete).bind("cleared.inputmask",opts.oncleared);$el.bind("keydown.inputmask",keydownEvent).bind("keypress.inputmask",keypressEvent);if(!androidfirefox){$el.bind("compositionstart.inputmask",compositionStartEvent).bind("compositionupdate.inputmask",compositionUpdateEvent).bind("compositionend.inputmask",compositionEndEvent);}
if(PasteEventType==="paste"){$el.bind("input.inputmask",inputFallBackEvent);}}
$el.bind("setvalue.inputmask",function(){var input=this,value=input.inputmask._valueGet();input.inputmask._valueSet($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask.call(input,value,opts)||value):value);checkVal(input,true,false);undoValue=getBuffer().join('');if((opts.clearMaskOnLostFocus||opts.clearIncomplete)&&input.inputmask._valueGet()===getBufferTemplate().join(''))
input.inputmask._valueSet('');});patchValueProperty(el);var initialValue=$.isFunction(opts.onBeforeMask)?(opts.onBeforeMask.call(el,el.inputmask._valueGet(),opts)||el.inputmask._valueGet()):el.inputmask._valueGet();checkVal(el,true,false,initialValue.split(''));var buffer=getBuffer().slice();undoValue=buffer.join('');var activeElement;try{activeElement=document.activeElement;}catch(e){}
if(isComplete(buffer)===false){if(opts.clearIncomplete)
resetMaskSet();}
if(opts.clearMaskOnLostFocus){if(buffer.join("")===getBufferTemplate().join("")){buffer=[];}else{clearOptionalTail(buffer);}}
writeBuffer(el,buffer);if(activeElement===el){caret(el,seekNext(getLastValidPosition()));}
installEventRuler(el);}
var valueBuffer;if(actionObj!==undefined){switch(actionObj.action){case"isComplete":el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;return isComplete(actionObj.buffer);case"unmaskedvalue":el=actionObj.el;if(el===undefined){$el=$({});el=$el[0];el.inputmask=new Inputmask();el.inputmask.opts=opts;el.inputmask.el=el;el.inputmask.maskset=maskset;el.inputmask.isRTL=opts.numericInput;if(opts.numericInput){isRTL=true;}
valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask.call($el,actionObj.value,opts)||actionObj.value):actionObj.value).split('');checkVal($el,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite.call(this,undefined,getBuffer(),0,opts);}else $el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;isRTL=el.inputmask.isRTL;return unmaskedvalue($el);case"mask":undoValue=getBuffer().join('');mask(actionObj.el);break;case"format":$el=$({});$el[0].inputmask=new Inputmask();$el[0].inputmask.opts=opts;$el[0].inputmask.el=$el[0];$el[0].inputmask.maskset=maskset;$el[0].inputmask.isRTL=opts.numericInput;if(opts.numericInput){isRTL=true;}
valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask.call($el,actionObj.value,opts)||actionObj.value):actionObj.value).split('');checkVal($el,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite.call(this,undefined,getBuffer(),0,opts);if(actionObj.metadata){return{value:isRTL?getBuffer().slice().reverse().join(''):getBuffer().join(''),metadata:$el.inputmask("getmetadata")};}
return isRTL?getBuffer().slice().reverse().join(""):getBuffer().join("");case"isValid":$el=$({});$el[0].inputmask=new Inputmask();$el[0].inputmask.opts=opts;$el[0].inputmask.el=$el[0];$el[0].inputmask.maskset=maskset;$el[0].inputmask.isRTL=opts.numericInput;if(opts.numericInput){isRTL=true;}
valueBuffer=actionObj.value.split('');checkVal($el,false,true,isRTL?valueBuffer.reverse():valueBuffer);var buffer=getBuffer();var rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break;}
buffer.splice(rl,lmib+1-rl);return isComplete(buffer)&&actionObj.value===buffer.join('');case"getemptymask":el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;return getBufferTemplate();case"remove":el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;el.inputmask._valueSet(unmaskedvalue($el));$el.unbind(".inputmask");var valueProperty;if(Object.getOwnPropertyDescriptor)
valueProperty=Object.getOwnPropertyDescriptor(el,"value");if(valueProperty&&valueProperty.get){if(el.inputmask.__valueGet){Object.defineProperty(el,"value",{get:el.inputmask.__valueGet,set:el.inputmask.__valueSet});}}else if(document.__lookupGetter__&&el.__lookupGetter__("value")){if(el.inputmask.__valueGet){el.__defineGetter__("value",el.inputmask.__valueGet);el.__defineSetter__("value",el.inputmask.__valueSet);}}
el.inputmask=undefined;break;case"getmetadata":el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;if($.isArray(maskset.metadata)){var alternation,lvp=getLastValidPosition();for(var firstAlt=lvp;firstAlt>=0;firstAlt--){if(getMaskSet().validPositions[firstAlt]&&getMaskSet().validPositions[firstAlt].alternation!==undefined){alternation=getMaskSet().validPositions[firstAlt].alternation;break;}}
if(alternation!==undefined)
return maskset.metadata[getMaskSet().validPositions[lvp].locator[alternation]];else return maskset.metadata[0];}
return maskset.metadata;}}}
window.Inputmask=Inputmask;return Inputmask;})(jQuery);
jQuery.fn.highlight=function(pat){function innerHighlight(node,pat){var skip=0;if(node.nodeType==3){var pos=node.data.toUpperCase().indexOf(pat);if(pos>=0){var spannode=document.createElement('span');spannode.className='highlight';var middlebit=node.splitText(pos);var endbit=middlebit.splitText(pat.length);var middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);skip=1;}}
else if(node.nodeType==1&&node.childNodes&&!/(script|style)/i.test(node.tagName)){for(var i=0;i<node.childNodes.length;++i){i+=innerHighlight(node.childNodes[i],pat);}}
return skip;}
return this.each(function(){innerHighlight(this,pat.toUpperCase());});};jQuery.fn.removeHighlight=function(){function newNormalize(node){for(var i=0,children=node.childNodes,nodeCount=children.length;i<nodeCount;i++){var child=children[i];if(child.nodeType==1){newNormalize(child);continue;}
if(child.nodeType!=3){continue;}
var next=child.nextSibling;if(next==null||next.nodeType!=3){continue;}
var combined_text=child.nodeValue+next.nodeValue;new_node=node.ownerDocument.createTextNode(combined_text);node.insertBefore(new_node,child);node.removeChild(child);node.removeChild(next);i--;nodeCount--;}}
return this.find("span.highlight").each(function(){var thisParent=this.parentNode;thisParent.replaceChild(this.firstChild,this);newNormalize(thisParent);}).end();};
registerListener('load',setLazy);registerListener('load',lazyLoad);registerListener('scroll',lazyLoad);var lazy=[];function setLazy(){lazy=document.getElementsByClassName('lazyimg');console.log('Found '+lazy.length+' lazy images');}
function lazyLoad(){for(var i=0;i<lazy.length;i++){if(isInViewport(lazy[i])){if(lazy[i].getAttribute('data-src')){lazy[i].src=lazy[i].getAttribute('data-src');lazy[i].removeAttribute('data-src');}}}
cleanLazy();}
function cleanLazy(){lazy=Array.prototype.filter.call(lazy,function(l){return l.getAttribute('data-src');});}
function isInViewport(el){var rect=el.getBoundingClientRect();return(rect.bottom>=0&&rect.right>=0&&rect.top<=(window.innerHeight||document.documentElement.clientHeight)&&rect.left<=(window.innerWidth||document.documentElement.clientWidth));}
function registerListener(event,func){if(window.addEventListener){window.addEventListener(event,func)}else{window.attachEvent('on'+event,func)}}
$(function(){var autoPlay;$('#bonus-slider-lg').movingBoxes({speed:1000,startPanel:1,reducedSize:0.6,wrap:true,buildNav:true,navFormatter:function(){return"&#9679;";},hashTags:false});$('#bonus-slider-xs').movingBoxes({speed:800,startPanel:1,reducedSize:0.6,wrap:true,buildNav:true,navFormatter:function(){return"&#9679;";},hashTags:false});function startSlider($button){autoPlay=setInterval(function(){$button.click();},6000);}
function stopSlider(){clearInterval(autoPlay);}
if($('.mb-parent').size()){$.each($('.mb-parent'),function(){var $this=$(this);if($this.css('display')!=='none'){var $button=$this.find('.mb-right');$('.mb-slider').mouseover(function(){stopSlider()});$('.mb-slider').mouseout(function(){startSlider($button)});startSlider($button);}});}});
function sleep(ms){ms+=new Date().getTime();while(new Date()<ms){}}
function socialAuth(token){$.post("/s/social-auth.json",{token:token},function(response){if(response.result=="success"){if(response.network){var $li=$("#uLogin").find('a[data-uloginbutton="'+response.network.type+'"]').parents("li");if(response.network.active){$li.addClass("active");$li.find("a").text("открепить");}else{$li.removeClass("active");$li.find("a").text("прикрепить");}}
if(response.redirect){window.location.replace(response.redirect);}}
if(response.result=="error"){var modal;if(response.hasOwnProperty("modal")){modal=response.modal;}else{modal=false;}
ms.showErrorModal(response.error,modal);$("#login .loader-box").hide();}},"json");}
var CONFIRM_TIMER=30;var remainTime=0;var timeinterval="";var currentOrderStatusTimeInterval="";var $body=$("html");var ms={$loader:null,attempts:0,modals:{$randomModal:null,$loginModal:null,$loginConfirmModal:null,$registerModal:null,$registerConfirmModal:null,$registerThanksmModal:null,$filterModal:null,$giftsModal:null,$errorModal:null,$orderConfirmModal:null,$commentModal:null,$commentModalThanks:null,$promoModal:null,$promoModalThanks:null,$yourCode:null,$yourCodeAlias:null,$endOrdersModal:null,$cartItemModal:null,$infoModal:null,$offerChoiceModal:null,$birthdayModal:null},forms:{$catalogFilterForm:null,$cartStepOneForm:null,$cartStepTwoForm:null,$birthdayModalForm:null},url:{api:"/s",getBannerSlider:"/get-banner-slider.json",getMainSlider:"/get-main-slider.json",getProduct:"/get-product.json",getGroupProduct:"/get-group-product.json",getProducts:"/get-products.json",getNewsItem:"/get-news-item.json",getActionItem:"/get-action-item.json",sendTestimonial:"/send-testimonial.json",sendCallback:"/send-callback.json",sendFAQ:"/send-faq.json",getSurprise:"/get-surprise.json",addToCart:"/add-to-cart.json",addGiftToCart:"/add-gift-to-cart.json",getRegistrationConfirmCode:"/get-registration-confirm-code.json",confirmRegistration:"/confirm-registration.json",getLoginConfirmCode:"/get-login-confirm-code.json",confirmLogin:"/confirm-login.json",getStreets:"/get-streets.json",newAddress:"/new-address.json",updateAccountProfile:"/update-account-profile.json",getCartStepOne:"/get-cart-step-one.json",checkCartStepOne:"/check-cart-step-one.json",checkCartStepTwo:"/check-cart-step-two.json",increaseCartItem:"/increase-cart-item.json",decreaseCartItem:"/decrease-cart-item.json",removeCartItem:"/remove-cart-item.json",setCartItem:"/set-cart-item.json",increaseCartToppingItem:"/increase-cart-topping-item.json",decreaseCartToppingItem:"/decrease-cart-topping-item.json",setCartTopingItem:"/set-cart-toping-item.json",increaseCartFlatwareItem:"/increase-cart-flatware-item.json",decreaseCartFlatwareItem:"/decrease-cart-flatware-item.json",setCartFlatwareItem:"/set-cart-flatware-item.json",clearCart:"/clear-cart.json",repeatOrder:"/repeat-order.json",getDeliveryDates:"/get-delivery-dates.json",getDeliveryTimes:"/get-delivery-times.json",getDeliveryCost:"/get-delivery-cost.json",orderConfirm:"/order-confirm.json",activatePromo:"/activate-promo.json",getOrderTimer:"/get-order-timer.json",getCurrentOrderStatusTimer:"/get-current-order-status-timer.json",getBlockingTV:"/getblocking.json",sendTestimonialMail:"/send-testimonial-mail.json",commentsShowElse:"/get-comments-else.json",sendFriendPhone:"/send-friend-phone.json",changeSort:"/change-sort.json",saveBirthdayChoice:"/save-birthday-choice.json",incLike:"/inc-like.json",getAdditionProductsBlock:"/get-addition-products-block.json",sendFreePromo:"/send-freepromo.json",sendTestPromo:"/send-testpromo.json",refreshToken:"/refresh-token.json"},init:function(){this.$loader=$(".preloader-box");this.modals.$randomModal=$("#random-modal");this.modals.$registerModal=$("#register");this.modals.$registerConfirmModal=$("#register-confirm");this.modals.$registerThanksmModal=$("#thx-register");this.modals.$loginModal=$("#login");this.modals.$loginConfirmModal=$("#login-confirm");this.modals.$filterModal=$("#filter-modal");this.modals.$giftsModal=$("#gift-modal");this.modals.$errorModal=$("#error-common");this.modals.$orderConfirmModal=$("#order-confirm");this.modals.$commentModal=$("#comment");this.modals.$commentModalThanks=$("#thx-comment");this.modals.$promoModal=$("#promo-modal");this.modals.$promoModalThanks=$("#thx-promo");this.forms.$catalogFilterForm=$("#catalog-filter-form");this.forms.$cartStepOneForm=$("#cart-step-one-form");this.forms.$cartStepTwoForm=$("#cart-step-two-form");this.forms.$birthdayModalForm=$("#birthday-modal-form");this.modals.$yourCode=$("#your-code-modal");this.modals.$endOrdersModal=$("#orders-end-modal");this.modals.$yourCodeAlias="vash-lichnyij-kod";this.modals.$cartItemModal=$("#cart-item-modal");this.modals.$infoModal=$("#info-common");this.modals.$offerChoiceModal=$("#offer-choice");this.modals.$birthdayModal=$("#birthday-modal");this.setDefaultCity();if($(".cabinet-header").length>0){currentOrderStatusTimeInterval=setInterval(function(){ms.getCurrentOrderStatusTimer()},5*60*1000);if($("#order_delivered").hasClass("active")){clearInterval(currentOrderStatusTimeInterval);}}},showErrorModal:function(text,modal){if(!ms.modals.$errorModal.hasClass("opened")){$(".modal").modal("hide");ms.modals.$errorModal.addClass("opened");if(modal){ms.modals.$errorModal.find("button").attr("data-toggle","modal");ms.modals.$errorModal.find("button").attr("data-target","#"+modal);if(modal=="login"){ms.modals.$loginModal.find("#uLogin").remove();}}
ms.modals.$errorModal.find(".thx-modal-text").text(text);ms.modals.$errorModal.modal("show");}},clearFormInput:function($container){$container.find(":input").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected");$container.find(".has-error").removeClass("has-error");},supportLocalStorage:function(){var test="mirsushi";try{localStorage.setItem(test,test);localStorage.removeItem(test);return true;}catch(e){return false;}},setDefaultCity:function(){if(ms.supportLocalStorage()){var link=localStorage.getItem("startCityLink");var $button=$(".js-choose-city");$button.attr("href",link);$button.parents(".starter-page-container-box").find('option[value="'+link+'"]').attr("selected","selected");}},loaderShow:function(){ms.$loader.fadeIn(100);},loaderHide:function(){ms.$loader.fadeOut(100);},getBannerSlider:function(device,alias){$.get(ms.url.api+ms.url.getBannerSlider,{device:device,alias:alias},function(response){if(response.slider){$(".wrapper-slider").html(response.slider);bannerSliderInit();}},"json");},getMainSlider:function(device){$.get(ms.url.api+ms.url.getMainSlider,{device:device},function(response){if(response.slider){$(".wrapper-slider").html(response.slider);mainSliderInit();}
if(response.catalog){$(".main-cat").html(response.catalog);}
if(response.bestsellers){$(".bestsellers").html(response.bestsellers).prev(".row").find(".prefooter-block-T").show();}else{$(".bestsellers").prev(".row").find(".prefooter-block-T").hide();}},"json");},getProduct:function($button){if(ms.modals.$randomModal.length>0){ms.modals.$randomModal.modal("hide");}
var $modalContent=$("#cart-item-modal").find(".modal-content");var itemId=$button.data("item-id");var bestseller=$button.data("bestseller");var surprise=$button.data("surprise");var action_type=$button.data("action-type");var action_id=$button.data("action-id");var data={item_id:itemId,bestseller:bestseller,surprise:surprise,action_type:action_type,action_id:action_id};$.get(ms.url.api+ms.url.getProduct,data,function(response){if(response.html){$modalContent.hide(200,function(){$modalContent.html(response.html);});$modalContent.show(200);var link=window.location.protocol+"//"+window.location.hostname+"/"+$button.attr("href");window.history.pushState("",null,link);}},"json");},sendTestimonial:function($form){var request=new FormData();var $testimonialFile=$("#testimonial_file");if($testimonialFile.length>0){$.each($testimonialFile[0].files,function(i,file){request.append("testimonial_file[]",file);});}
request.append("testimonial_text",$("#testimonial_text").val());request.append("testimonial_email",$("#testimonial_email").val());$.ajax({url:ms.url.api+ms.url.sendTestimonial,data:request,processData:false,contentType:false,type:"post",success:function(response){if(response.result=="success"){ms.clearFormInput(ms.modals.$commentModal);ms.modals.$commentModal.find(".file_upload").find("button").text("Прикрепить файл");ms.modals.$commentModalThanks.modal("show");ms.sendTestimonialMail(response.mail);}
if(response.result=="error"&&response.errors){if(typeof response.errors==="string"){ms.showErrorModal(response.errors);}else{$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});}}
var $button=$form.find("button");$button.removeAttr("disabled");}});ms.modals.$commentModal.modal("hide");},sendTestimonialMail:function(mail){$.post(ms.url.api+ms.url.sendTestimonialMail,mail,function(response){},"json");},getNews:function($button){var itemId=$button.data("item-id");$.get(ms.url.api+ms.url.getNewsItem,{item_id:itemId},function(response){if(response.html){$("#news-modal").find(".modal-content").html(response.html);var link=window.location.protocol+"//"+window.location.hostname+"/"+$button.attr("href");window.history.pushState("",null,link);}},"json");},getAction:function($button){var itemId=$button.data("item-id"),lastGridReload="";$.get(ms.url.api+ms.url.getActionItem,{item_id:itemId},function(response){if(response.html){$("#stock-modal").find(".modal-content").html(response.html);var link=window.location.protocol+"//"+window.location.hostname+"/"+$button.attr("href");window.history.pushState("",null,link);}},"json");},sendCallback:function($form){ms.loaderShow();$form.find(".has-error").removeClass("has-error");$.post(ms.url.api+ms.url.sendCallback,$form.find(":input"),function(response){if(response.result=="success"){ms.loaderHide();$("#callback-modal").modal("hide");$("#thx-callback").modal("show");}
if(response.result=="error"&&response.errors){ms.loaderHide();if(typeof response.errors==="string"){ms.showErrorModal(response.errors);}else{$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});}}
var $button=$form.find("button");$button.removeAttr("disabled");},"json");},sendFAQ:function($form){$.post(ms.url.api+ms.url.sendFAQ,$form.find(":input"),function(response){if(response.result=="success"){$("#help-modal").modal("hide");$("#thx-callback").modal("show");}
var $button=$form.find("button");$button.removeAttr("disabled");},"json");},getSurprise:function($form){$.get(ms.url.api+ms.url.getSurprise,$form.find(":input"),function(response){if(response.result=="success"){ms.modals.$randomModal.find(".modal-content").html(response.html);ms.modals.$randomModal.modal("show");textCrop();}
if(response.result=="error"){if(response.errors){$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});}}},"json");},addToCart:function($button){var requestData={item_id:$button.data("item-id"),action_id:$button.data("action-id")||"",action_type:$button.data("action-type")||""};var windowWidth=parseInt($(window).width(),10);var windowHeight=parseInt($(window).height(),10);var mobile=($(".mm-mobile-open").css("display")=="block");var cart=$(".icon-basket");var imgtodrag=($button.closest(".cat-item").find(".cat-item-img").length>0)?$button.closest(".cat-item").find(".cat-item-img"):$button.closest(".cart-item-modal").find(".cart-item-modal-img");if(imgtodrag.length==0&&$button.closest(".mob-cat-item").find(".mob-cat-item-img").length>0)imgtodrag=$button.closest(".mob-cat-item").find(".mob-cat-item-img");if(imgtodrag.length==0&&$(".product-card-block").length>0)imgtodrag=$(".product-card-block").find(".product-card-item-img");if(imgtodrag.length>0){var imgclone=imgtodrag.clone().offset({top:imgtodrag.offset().top,left:imgtodrag.offset().left}).css({opacity:"0.5",position:"absolute",height:imgtodrag.height(),width:imgtodrag.width(),"z-index":"10002"}).appendTo($body).animate({top:(!mobile)?(cart.offset().top+windowHeight/2-$('.side-nav').height()/4-10):cart.offset().top,left:(!mobile)?(windowWidth-30):windowWidth-30,width:0,height:0},700);imgclone.animate({width:0,height:0},function(){$(this).detach();});}
$.post(ms.url.api+ms.url.addToCart,requestData,function(response){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart").find(".basket-count").text(response.cart_total);pixel.ProductEvent(response.price_list_id,"add_to_cart",{"products":[{"id":response.product_id}]});if($(".js-cart-step-one").length>0){ms.cartStepOne(true);}
if($button.parents('#action-product-modal').length>0){window.location.replace("cart/");ms.loaderShow();}},"json");},addGiftToCart:function($button){var requestData={item_id:$button.data("item-id"),action_id:$button.data("action-id")||"",action_type:$button.data("action-type")||"",quantity_max:$button.data("quantity-max")||1};var windowWidth=parseInt($(window).width(),10);var windowHeight=parseInt($(window).height(),10);var mobile=($(".mm-mobile-open").css("display")=="block");var cart=$(".icon-basket");var imgtodrag=($button.closest(".cat-item").find(".cat-item-img").length>0)?$button.closest(".cat-item").find(".cat-item-img"):$button.closest(".cart-item-modal").find(".cart-item-modal-img");if(imgtodrag.length>0){var imgclone=imgtodrag.clone().offset({top:imgtodrag.offset().top,left:imgtodrag.offset().left}).css({opacity:"0.5",position:"absolute",height:imgtodrag.height(),width:imgtodrag.width(),"z-index":"10002"}).appendTo($body).animate({top:(!mobile)?(cart.offset().top+windowHeight/2-$('.side-nav').height()/4-10):cart.offset().top,left:(!mobile)?(windowWidth-30):windowWidth-30,width:0,height:0},700);imgclone.animate({width:0,height:0},function(){$(this).detach();});}
$.post(ms.url.api+ms.url.addGiftToCart,requestData,function(response){if(response.gift){$(".cart-product-item-gift").remove();$(".cart-product-item:last").after(response.gift);}
$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart").find(".basket-count").text(response.cart_total);ms.modals.$giftsModal.modal("hide");ms.modals.$cartItemModal.modal("hide");},"json");},addGiftToCartRandom:function(){var $button,buttons=[];$.each(ms.modals.$giftsModal.find(".js-add-gift-to-cart"),function(){$button=$(this);buttons.push($button);});var index=Math.floor(Math.random()*buttons.length);ms.addGiftToCart(buttons[index]);},addToCartOffer:function($button){var requestData={item_id:$button.data("item-id")};$.post(ms.url.api+ms.url.addToCart,requestData,function(response){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart").find(".basket-count").text(response.cart_total);window.location.replace("cart/");ms.loaderShow();},"json");},increaseCartItem:function($button){$button.attr("disabled","disabled");$.post(ms.url.api+ms.url.increaseCartItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);var $quantity=$button.prev();var quantity=parseInt($quantity.text(),10);quantity++;$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}},"json");},decreaseCartItem:function($button){$button.attr("disabled","disabled");$.post(ms.url.api+ms.url.decreaseCartItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart").find(".basket-count").text(response.cart_total);var $quantity=$button.next();var quantity=parseInt($quantity.text(),10);quantity--;if(quantity==0){var $removeButton=$button.parents(".cart-product-item").find(".js-cart-product-remove");ms.removeCartItem($removeButton);}else{$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}}},"json");},removeCartItem:function($button){$button.attr("disabled","disabled");$.post(ms.url.api+ms.url.removeCartItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart").find(".basket-count").text(response.cart_total);if(!response.empty){$button.parents(".cart-product-item").remove();$button.parents(".cart-product-item-gift").remove();}
pixel.ProductEvent(response.price_list_id,"remove_from_cart",{"products":[{"id":response.product_id}]});ms.cartStepOne(true);}},"json");},setCartItem:function($span,value){$.post(ms.url.api+ms.url.setCartItem,{item_id:$span.data("item-id"),value:value},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);ms.recalcCart();ms.cartStepOne(true);}},"json");},increaseCartTopingItem:function($button){$button.attr("disabled","disabled");$.post(ms.url.api+ms.url.increaseCartToppingItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart-content-item.souces").find(".cart-content-item-cost-sum").find("span").text(response.addition_total);var $quantity=$button.prev();var quantity=parseInt($quantity.text(),10);quantity++;$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}},"json");},decreaseCartTopingItem:function($button){$button.attr("disabled","disabled");var $quantity=$button.next();var quantity=parseInt($quantity.text(),10);var quantityDefault=$button.data("quantity-default");if(quantity>quantityDefault){$.post(ms.url.api+ms.url.decreaseCartToppingItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);$(".cart-content-item.souces").find(".cart-content-item-cost-sum").find("span").text(response.addition_total);quantityDefault=parseInt(quantityDefault,10);quantity--;$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}},"json");}},setCartTopingItem:function($span,value){$.post(ms.url.api+ms.url.setCartTopingItem,{item_id:$span.data("item-id"),value:value},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);ms.recalcCart();ms.cartStepOne(true);}},"json");},increaseCartFlatwareItem:function($button){$button.attr("disabled","disabled");$.post(ms.url.api+ms.url.increaseCartFlatwareItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);var $quantity=$button.prev();var quantity=parseInt($quantity.text(),10);quantity++;$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}},"json");},decreaseCartFlatwareItem:function($button){$button.attr("disabled","disabled");var $quantity=$button.next();var quantity=parseInt($quantity.text(),10);var quantityDefault=$button.data("quantity-default");if(quantity>quantityDefault){$.post(ms.url.api+ms.url.decreaseCartFlatwareItem,{item_id:$button.data("item-id")},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);quantityDefault=parseInt(quantityDefault,10);quantity--;$quantity.text(quantity);ms.recalcCart();ms.cartStepOne(true);}},"json");}},setCartFlatwareItem:function($span,value){$.post(ms.url.api+ms.url.setCartFlatwareItem,{item_id:$span.data("item-id"),value:value},function(response){if(response.result=="success"){$(".side-nav").find(".basket-count").text(response.cart_total);ms.recalcCart();ms.cartStepOne(true);}},"json");},startConfirmTimer:function($confirmModal){var timer=CONFIRM_TIMER;var $confirmTimerAgain=$confirmModal.find(".resend-confirm-code").find("a");var $confirmTimer=$confirmModal.find(".confirm-timer");$confirmTimerAgain.addClass("disabled");var interval=setInterval(function(){if(timer==0){$confirmTimerAgain.removeClass("disabled");$confirmTimer.parent().hide();clearInterval(interval);}else{timer--;$confirmTimer.text(timer);}},1000);$confirmTimer.text(timer);$confirmTimer.parent().show();},getRegistrationConfirmCode:function($form){var $loader=$form.parents(".modal-body").find(".loader-box");$loader.show();$form.find("button").attr("disabled","disabled");$form.find(".has-error").removeClass("has-error");$.post(ms.url.api+ms.url.getRegistrationConfirmCode,$form.find(":input"),function(response){$loader.hide();if(response.result=="success"){ms.modals.$loginModal.modal("hide");ms.modals.$registerConfirmModal.find(".modal-body-header-text").find("span").text(response.phone);ms.modals.$registerConfirmModal.modal("show");ms.modals.$registerConfirmModal.find("input").focus();ms.startConfirmTimer(ms.modals.$registerConfirmModal);}
if(response.result=="error"){if(response.error){if(response.error=="user-exists"){ms.modals.$loginModal.modal("hide");var $modalText=ms.modals.$errorModal.find(".thx-modal-text");$modalText.text("Вы уже зарегистрированы на нашем сайте и можете авторизоваться через вкладку «Войти»");$modalText.next().attr("data-toggle","modal");$modalText.next().attr("data-target","#login");$modalText.next().attr("data-tab","#login-tab");ms.modals.$errorModal.modal("show");}else{ms.showErrorModal(response.error);}}
if(response.errors){$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});}}},"json");},confirmRegistration:function($form){var $loader=$form.parents(".modal-body").find(".loader-box");var $button=$form.find("button");$button.attr("disabled","disabled");$loader.show();$.post(ms.url.api+ms.url.confirmRegistration,$form.find(":input"),function(response){$loader.hide();if(response.result=="success"){ms.modals.$registerModal.find("input").val("");ms.modals.$registerModal.find("button").removeAttr("disabled");ms.modals.$registerConfirmModal.modal("hide");ms.modals.$registerThanksmModal.find("button").attr("onclick",'location.replace("'+response.redirect+'")');ms.modals.$registerThanksmModal.modal("show");}
if(response.result=="error"){ms.modals.$registerConfirmModal.modal("hide");var $modalText=ms.modals.$errorModal.find(".thx-modal-text");$modalText.text("Вы указали неверный проверочный код");$modalText.next().attr("data-toggle","modal");$modalText.next().attr("data-target","#register-confirm");ms.modals.$errorModal.modal("show");$button.removeAttr("disabled");}},"json");},getLoginConfirmCode:function($form){var $loader=$form.parents(".modal-body").find(".loader-box");$loader.show();$form.find("button").attr("disabled","disabled");$form.find(".has-error").removeClass("has-error");$.post(ms.url.api+ms.url.getLoginConfirmCode,$form.find(":input"),function(response){$loader.hide();if(response.result=="success"){ms.modals.$loginModal.modal("hide");ms.modals.$loginConfirmModal.find(".modal-body-header-text").find("span").text(response.phone);ms.modals.$loginConfirmModal.modal("show");ms.startConfirmTimer(ms.modals.$loginConfirmModal);}
if(response.result=="error"){if(response.error){switch(response.error){case"not-registered":var $regTab=ms.modals.$loginModal.find('a[href="#register-tab"]');$("#register_phone").val($("#login_phone").val());$regTab.click();break;default:ms.showErrorModal(response.error);}}
if(response.errors){$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});}}
$form.find("button").removeAttr("disabled");},"json");},confirmLogin:function($form){var $loader=$form.parents(".modal-body").find(".loader-box");var $button=$form.find("button");$button.attr("disabled","disabled");$loader.show();$.post(ms.url.api+ms.url.confirmLogin,$form.find(":input"),function(response){$loader.hide();if(response.result=="success"&&response.redirect){if(response.token){localStorage.setItem('ms_Token',JSON.stringify(response.token));}
ms.modals.$loginModal.find("input").val("");ms.modals.$loginModal.find("button").removeAttr("disabled");window.location.reload();}
if(response.result=="error"){ms.modals.$loginConfirmModal.modal("hide");var $modalText=ms.modals.$errorModal.find(".thx-modal-text");$modalText.text("Вы указали неверный проверочный код");$modalText.next().attr("data-toggle","modal");$modalText.next().attr("data-target","#login-confirm");ms.modals.$errorModal.modal("show");$button.removeAttr("disabled");}},"json");},getCurrentOrderStatusTimer:function(){$.post(ms.url.api+ms.url.getCurrentOrderStatusTimer,{},function(response){if(response.result=="success"){if(!($("#current_mark").length>0)){$(".cabinet-nav>ul").prepend('<li id="current_mark"><a href="#current" data-toggle="tab"><i class="icon-current_order"></i> Текущий заказ</a></li>');}
$(".tab-content.cabinet-page #current").remove();$(".tab-content.cabinet-page").append(response.html);if($("#order_delivered").hasClass("active")){clearInterval(currentOrderStatusTimeInterval);}}
if(response.result=="error"){if(response.message=='order_done'){}
if(response.message=='no_user'){clearInterval(currentOrderStatusTimeInterval);window.location.replace(response.redirect);}}});},getOrderTimer:function(){var timer=$(".side-nav .timer");var timer_message=$(".side-nav #timer-message");var timer_num=$(".side-nav .timer-num");var timer_img=$(".side-nav .timer-img");var timer_gift=$(".side-nav #timer-gift");var timer_heart=$(".side-nav #timer-heart");$.post(ms.url.api+ms.url.getOrderTimer,{order_id:timer.data('order')},function(response){if(response.result=="success"){if(response.code!='Complete'){timer.removeClass("hidden").data('order',response.order['id']);timer_message.text(response.message);switch(response.code){case'Processing':timer_img.addClass("hidden");timer_num.removeClass("hidden");remainTime=response.order['remainTime'];updateClock();timeinterval=setInterval(updateClock,1000);break;case'Late':timer_num.addClass("hidden");timer_heart.addClass("hidden");timer_gift.removeClass("hidden");setTimeout('clearInterval(timeinterval);ms.getOrderTimer()',1*60*1000);break;default:timer_num.addClass("hidden");timer_gift.addClass("hidden");timer_heart.removeClass("hidden");setTimeout('clearInterval(timeinterval);ms.getOrderTimer()',1*60*1000);}}else{timer.addClass("hidden").data('order','');}}
if(response.result=="error"){timer.addClass("hidden").data('order','');}});},getDeliveryCost:function(street,house){if(street.length>0&&house.length>0){var $tab=$(".tab-pane.active").attr("id");var requestData=ms.getStepTwoFormData($tab);var $productsTotal=$("#invoice-cart-total");var $shippingTotal=$("#invoice-shipping-total");var deliveryDate=$(".tab-pane.active").find('#checkout_delivery_date-styler .jq-selectbox__select-text').text().toString();$.post(ms.url.api+ms.url.getDeliveryCost,requestData,function(response){if(response.result=="success"){if($shippingTotal.length==0){$productsTotal.after(response.html);}else{$shippingTotal.replaceWith(response.html);}
ms.recalcInvoice();if(response.bonus>0){$(".cart-content-balls-T").find("span").text(response.bonus);}
if(response.response['response']['isGuaranteeDelivery']){$("#guarantee_delivery_box").addClass('in');if(deliveryDate.indexOf("Сегодня")>-1){$("#guarantee_delivery_box").show(400).find("#guarantee_delivery_accept").attr("data-time",response.response['response']['guaranteeTime']);}
$("#guarantee-delivery-modal").find("#guarantee_descr").text(response.response['response']['guaranteeDescription']);}else $("#guarantee_delivery_box").hide(400).removeClass('in').find("#guarantee_delivery_accept").removeAttr("checked");}
if(response.result=="error"){$("#guarantee_delivery_box").hide(400).removeClass('in').find("#guarantee_delivery_accept").removeAttr("checked");}});}},getStreets:function(term,$target){var list="";$.get(ms.url.api+ms.url.getStreets,{term:term},function(response){if(response.streets.length>0){$.each(response.streets,function(){list+='<li data-code="'+this.code+'">'+this.name+" ("+this.locality+")</li>";});$(".tab-pane.active .streets-list").remove();$target.after('<div id="streets-list" class="streets-list"><ul>'+list+"</ul></div>");}},"json");},setStreet:function($item){var $streetInput=$item.parents(".form-group").find(".js-street-autocomplete");var $streets=$(".streets-list");$streetInput.attr("data-street-code",$item.data("code"));$streetInput.val($item.text());$streets.remove();if($("#account-profile-form").length>0){$streetInput.next().val($item.data("code"));}},setAddress:function($item){var street_code=(!!$item.data("street-code"))?$item.data("street-code"):$item.data("streetcode");$("#checkout_street").val($item.data("street")).attr("data-street-code",street_code);$("#checkout_house_number").val($item.data("house"));$("#checkout_porch").val($item.data("porch"));$("#checkout_floor").val($item.data("floor"));$("#checkout_flat").val($item.data("flat"));$("#addresses-list").addClass("hidden");$(".js-street-autocomplete").addClass("from-favorite-address");ms.getDeliveryCost(street_code.toString(),$item.data("house").toString());},removeAccountAddress:function($button){$button.parents(".cabinet-data-form-ajax-item").parent().remove();},addAccountAddress:function($button){$.get(ms.url.api+ms.url.newAddress,{},function(response){if(response.html){$(".addresses-list").append(response.html);stylerInit();}},"json");},updateAccountProfile:function($form){$form.find(".has-error").removeClass("has-error");var validate=true;var $required=$form.find('input[data-required="true"]');$required.each(function($item){var $this=$(this);if($this.val()===""){$this.parents(".form-group").addClass("has-error");ms.scrollToError();ms.modals.$errorModal.find(".thx-modal-text").text("Пожалуйста, заполните все поля, отмеченные *");ms.modals.$errorModal.modal("show");return(validate=false);}});if(validate){ms.loaderShow();var requestData=$form.find('input[type="text"], input[type="email"], input[type="hidden"], input[type="checkbox"]:checked, input[type="radio"]:checked');$.post(ms.url.api+ms.url.updateAccountProfile,requestData,function(response){if(response.result=="success"){$(".login.inside.toolbar").find(".user-name").text(response.name);$(".cabinet-header-text").find("span").text(response.name);}
if(response.result=="error"){ms.showErrorModal(response.errors);}
ms.loaderHide();},"json");}},recalcCart:function(){var cartTotal=0;$.each($(".cart-product-item"),function(){var $row=$(this);var price=$row.find(".cart-content-item-cost").find("span").text();price=parseFloat(price);var quantity=$row.find(".cart-content-item-count-box").find("span").text();quantity=parseInt(quantity,10);var total=price*quantity;$row.find(".cart-content-item-cost-sum").find("span").text(total);cartTotal+=total;});$.each($(".cart-product-item-topping"),function(){var $row=$(this);var price=$row.find(".js-cart-add-product-dec").data("price");price=parseFloat(price);var quantity=$row.find(".cart-content-item-count-box").find("span").text();quantity=parseInt(quantity,10);var freeQuantity=$row.find(".js-cart-add-product-dec").data("quantity-default");var total=price*(quantity-freeQuantity);$row.find(".cart-content-item-cost-sum").find("span").text(total);cartTotal+=total;});$.each($(".cart-product-item-flatware"),function(){var $row=$(this);var price=$row.find(".js-cart-add-flatware-dec").data("price");price=parseFloat(price);var quantity=$row.find(".cart-content-item-count-box").find("span").text();quantity=parseInt(quantity,10);var freeQuantity=$row.find(".js-cart-add-flatware-dec").data("quantity-default");var total=price*(quantity-freeQuantity);$row.find(".cart-content-item-cost-sum").find("span").text(total);cartTotal+=total;});$(".cart-total-amount").find("li").html(cartTotal+' <i class="icon-rubl_bold"></i>');},recalcInvoice:function(){var total;var products=parseFloat($("#invoice-cart-total").find(".icon-rubl_regular").parent().text());var shipping=parseFloat($("#invoice-shipping-total").find(".icon-rubl_regular").parent().text())||0;var discount=parseFloat($("#invoice-discount-total").find(".icon-rubl_regular").parent().text())||0;var bonus=parseFloat($("#invoice-bonus-total").find("input").val())||0;total=products+shipping-discount-bonus;$("#invoice-total").find("li").html(total.toFixed(2)+' <i class="icon-rubl_regular"></i>');},cartStepOne:function(update){update=update||false;ms.loaderShow();var phone=$("#cart_step_one_phone").val();var $productsBeacon=$("#cart-products-list-beacon");var $toppingsBeacon=$("#cart-toppings-list-beacon");var $flatwareBeacon=$("#cart-flatware-list-beacon");var $actionsBeacon=$("#cart-actions-block-beacon");var $formBeacon=$("#cart-step-one-form-beacon");var $toppingsContainer=$("#souses-modal").find(".modal-body").find(".row:first");var $giftsContainer=$("#gift-modal").find(".modal-body").find(".row:first");var $buttonPlus=$(".icon-plus").parent();var $buttonMinus=$(".icon-minus").parent();var $buttonRemove=$(".js-cart-product-remove");$buttonPlus.attr("disabled","disabled");$buttonMinus.attr("disabled","disabled");$buttonRemove.attr("disabled","disabled");$.post(ms.url.api+ms.url.getCartStepOne,{phone:phone,update:update},function(response){ms.loaderHide();if(response.result=="error"){ms.showErrorModal(response.errors);}else{if(response.empty){$(".js-cart-step-one").parents("ul").hide();var $c=$(".cart-content").find(".container");var $f=$c.find(".cart-outer");$f.next().remove();$f.next().remove();$f.next().remove();$f.remove();$c.find(".cart-content-footer").remove();$c.find(".cart-content-header").remove();$c.find(".cart-content-more-items").remove();$c.append(response.empty);}else{var $next;if(update){$(".cart-product-item").remove();$(".cart-product-item-gift").remove();}
if(response.cart.products){$productsBeacon.after(response.cart.products);}
if(update){$(".cart-product-item-topping").remove();}
if(response.cart.toppings){$toppingsBeacon.after(response.cart.toppings);}
if(update){$(".cart-product-item-flatware").remove();}
if(response.cart.flatware){$flatwareBeacon.after(response.cart.flatware);}
if(response.list.toppings){$toppingsContainer.html(response.list.toppings);}
if(update){$next=$actionsBeacon.next();if($next.hasClass("cart-content-more-items_container")){$next.remove();}}
if(response.list.actions){$actionsBeacon.after(response.list.actions).show();}
if(response.list.gifts){$giftsContainer.html(response.list.gifts);}
if(update){$formBeacon.next().remove();}
if(response.form){$formBeacon.after(response.form);}
$(".cart").find(".basket-count").text(response.totals.cart);$(".cart-content-sum").find(".icon-rubl_bold").parent().html(response.totals.cart+' <i class="icon-rubl_bold"></i>');$("#cart-total-bonus").text(response.totals.bonus);ms.initInputMasks();if(response.showOfferChoice==1){ms.forms.$birthdayModalForm.html(response.birthdayOffers);ms.modals.$birthdayModal.modal("show");}else $(".cart-content-choice").html("");}}
$buttonPlus.removeAttr("disabled");$buttonMinus.removeAttr("disabled");$buttonRemove.removeAttr("disabled");if(response.totals&&response.totals.cart){$(".side-nav").find(".basket-count").text(response.totals.cart);}},"json");},checkCartStepOne:function($form){var validate=true;$form.find(".has-error").removeClass("has-error");if($('#cart_step_one_phone').val()==''){$form.find("#cart_step_one_phone").parents(".form-group").addClass("has-error");validate=false;}
if(!validate){ms.modals.$errorModal.find(".thx-modal-text").text("Заполните поля корректно.");ms.modals.$errorModal.modal("show");ms.scrollToError();$(".js-step-one-checkout").removeAttr("disabled");return;}
var data=$form.find("input");$.post(ms.url.api+ms.url.checkCartStepOne,data,function(response){if(response.result=="success"){window.location.replace(response.redirect);}
if(response.result=="error"){$(".js-step-one-checkout").removeAttr("disabled");if(response.error=="birthday"){$("#error-birthday").modal("show");}else{if(response.error=="no-gift"){$("#error-no-gift").modal("show");}else{ms.modals.$errorModal.find(".thx-modal-text").text("Заполните поля корректно.");ms.modals.$errorModal.modal("show");}}
$.each(response.errors,function(key,value){$("#"+value).parents(".form-group").addClass("has-error");});ms.scrollToError();}},"json");},checkCartStepTwo:function(){ms.loaderShow();var $activeTab=$(".tab-pane.active");var tabId=$activeTab.attr("id");var formData=ms.getStepTwoFormData(tabId);if(formData.isGuaranteeDelivery){$.post(ms.url.api+ms.url.getDeliveryTimes,formData,function(response){if(response.result=="success"){formData.delivery["time"]["index"]=0;formData.delivery["time"]["id"]=response.times["0"]["id"];ms.goNextStepTwo(tabId,formData);}
if(response.result=="error"){ms.loaderHide();$activeTab.find("#guarantee_delivery_box").hide().removeClass("in").find("#guarantee_delivery_accept").removeAttr('checked');ms.modals.$errorModal.find(".thx-modal-text").text(response.error);ms.modals.$errorModal.modal("show");}});}else{ms.goNextStepTwo(tabId,formData);}},goNextStepTwo:function(tabId,formData){$("#"+tabId).find(".has-error").removeClass("has-error");console.log(formData);$.post(ms.url.api+ms.url.checkCartStepTwo,formData,function(response){if(response.result=="success"){if(response.redirect){window.location.replace(response.redirect);}else{ms.loaderHide();if(response.online){switch(response.online_operator){case('yandex'):$body.append(response.form);var orderTotal=$("#invoice-total").find("li").text();var $form=$body.find("#online-payment-form");if($form.length>0){$form.find('input[name="sum"]').val(orderTotal);$form.submit();}
break;case('sber'):ms.modals.$errorModal.find("button").remove();ms.modals.$errorModal.find(".thx-modal-text").html(response.message).parents('.modal-body').append(response.button);link=ms.modals.$errorModal.find('.modal-body a').attr({'class':'main-btn-small','type':'button'}).attr('href');ms.modals.$errorModal.modal("show");setTimeout(function(){window.location.replace(link);},3000);break;case('cloud'):response.params.amount=Number.parseFloat(response.params.amount);ms.cloudPaymentsWidget(response.params,response.online_redirect);break;case('epos'):ms.modals.$errorModal.find("button").remove();ms.modals.$errorModal.find(".thx-modal-text").html(response.message).parents('.modal-body').append(response.body);ms.modals.$errorModal.modal("show");var cnt=3;var tmId=setInterval(function(){if(cnt<0){clearInterval(tmId);$('#epos_form').submit();return;}
$('#epos_sec').text(cnt);cnt--;},1000);break;}}else{if(typeof response.mustSend!==typeof undefined&&response.mustSend==false){$("#order-confirm-form").find("input").val(response.code).submit();}else{ms.modals.$orderConfirmModal.find(".modal-body-header-text").find("span").text(response.phone);ms.modals.$orderConfirmModal.modal("show");ms.startConfirmTimer(ms.modals.$orderConfirmModal);}}}}
if(response.result=="error"){$(".js-step-two-checkout").removeAttr("disabled");ms.loaderHide();ms.showErrorModal(response.error);if(response.errors){var prefix;if(tabId=="tab-1"){prefix="checkout_";}else{prefix="checkout_pickup_";}
$.each(response.errors,function(key,value){$("#"+prefix+value).parents(".form-group").addClass("has-error");$("#"+prefix+value+"_number").parents(".form-group").addClass("has-error");});ms.scrollToError();}}},"json");},orderConfirm:function($form){ms.loaderShow();var $button=$form.find("button");$.post(ms.url.api+ms.url.orderConfirm,$form.find(":input"),function(response){if(response.result=="success"){if(response.redirect){window.location.replace(response.redirect);}else{ms.loaderHide();if(response.online){switch(response.online_operator){case('yandex'):$body.append(response.form);var orderTotal=$("#invoice-total").find("li").text();var $form=$body.find("#online-payment-form");if($form.length>0){$form.find('input[name="sum"]').val(orderTotal);$form.submit();}
break;case('sber'):ms.modals.$orderConfirmModal.modal("hide");ms.modals.$errorModal.find("button").remove();ms.modals.$errorModal.find(".thx-modal-text").html(response.message).parents('.modal-body').append(response.button);link=ms.modals.$errorModal.find('.modal-body a').attr({'class':'main-btn-small','type':'button'}).attr('href');ms.modals.$errorModal.modal("show");setTimeout(function(){window.location.replace(link);},3000);break;}}}}
if(response.result=="error"){ms.loaderHide();ms.modals.$orderConfirmModal.modal("hide");(response.rbs===1)?ms.showErrorModal(response.error):ms.showErrorModal(response.error,"order-confirm");}
$(".js-step-two-checkout").removeAttr("disabled");},"json");},getDeliveryDates:function(street,house,type){var requestData={street_code:street||"",house_number:house||""};$.post(ms.url.api+ms.url.getDeliveryDates,requestData,function(response){var i,date,list="";if(response.result=="success"){for(i=0;i<response.dates.length;i++){date=response.dates[i];list+='<option value="'+date.date+'" data-index="'+date.index+'">'+date.name+"</option>";}
$("#checkout_"+type+"_date").html(list).trigger("refresh");setTimeout(function(){var dt=$(".js-delivery-time-refresh");dt.val("");dt.attr("data-code","");dt.attr("data-index","");},100);}
if(response.result=="error"){ms.showErrorModal(response.errors);}},"json");},getDeliveryTimes:function($target){if($target.hasClass("refreshing")){return false;}
$(".time-list").remove();$target.val("");$target.attr("data-code","");$target.attr("data-index","");$target.addClass("refreshing");var $tab=$(".tab-pane.active").attr("id");var requestData=ms.getStepTwoFormData($tab);if(requestData.street&&requestData.house){var $loader=$target.parents(".tab-pane").find(".loader-box");$loader.show();$.post(ms.url.api+ms.url.getDeliveryTimes,requestData,function(response){if(response.result=="success"){var list="";$.each(response.times,function(){list+='<li data-index="'+this.index+'" data-code="'+this.id+'">'+this.name+"</li>";});$target.after('<div class="time-list"><ul>'+list+"</ul></div>");$("#checkout_payment_online").attr("data-org",response.organization.Code);if(parseInt(response.isOnline)!=1){$("label[for='checkout_payment_cash']").click();$("#checkout_payment_online").parent(".form-group").hide();}
else $("#checkout_payment_online").parent(".form-group").show();ms.checkRequiredFields();}
if(response.result=="error"){ms.modals.$errorModal.find(".thx-modal-text").text(response.error);ms.modals.$errorModal.modal("show");}
$target.removeClass("refreshing");$loader.hide();});}else{if(requestData.type=="courier"){ms.modals.$errorModal.find(".thx-modal-text").text("Для расчёта доступного времени доставки укажите адрес. Для этого выберите улицу из списка и укажите номер дома.");if(!requestData.street){$(".js-street-autocomplete").val("");}}else{ms.modals.$errorModal.find(".thx-modal-text").text("Для расчёта доступного времени доставки укажите адрес самовывоза.");}
ms.modals.$errorModal.modal("show");$target.removeClass("refreshing");}},setTime:function($item){var $times=$item.parents(".time-list");var $timeInput=$times.prev();if($item.is(':first-child'))
$('#can_later_box').show(400);else
$('#can_later_box').hide(400);$timeInput.attr("data-code",$item.data("code"));$timeInput.attr("data-index",$item.data("index"));$timeInput.val($item.text());$times.remove();},getStepTwoFormData:function(tabId){var formData={},$deliveryTime,$deliveryDate;switch(tabId){case"tab-1":var $checkoutStreet=$("#checkout_street");formData.name=$("#checkout_name").val();formData.street=$checkoutStreet.attr("data-street-code");formData.street_name=$checkoutStreet.val();formData.house=$("#checkout_house_number").val();formData.floor=$("#checkout_floor").val();formData.porch=$("#checkout_porch").val();formData.flat=$("#checkout_flat").val();$deliveryDate=$("#checkout_delivery_date");formData.delivery={};formData.delivery["date"]=$deliveryDate.val()||$deliveryDate.find("option:first").val();$deliveryTime=$("#checkout_delivery_time");formData.delivery["time"]={};formData.delivery["time"]["index"]=$deliveryTime.attr("data-index");formData.delivery["time"]["id"]=$deliveryTime.attr("data-code");formData.delivery["time"]["text"]=$deliveryTime.val();formData.isGuaranteeDelivery=$("#guarantee_delivery_accept").attr("checked")?true:false;formData.guaranteeTime=$("#guarantee_delivery_accept").attr("checked")?$("#guarantee_delivery_accept").attr("data-time"):"";formData.guarantee_delivery_accept=$('#can_later_accept').is(":checked")?true:false;formData.comment=$("#checkout_comment").val();formData.type="courier";formData.quick_order=$("#quick_order").is(':checked');formData.tvName=(ms.modals.$endOrdersModal)?ms.modals.$endOrdersModal.data("tv"):'';break;case"tab-2":formData.name=$("#checkout_pickup_name").val();var $pickupPlace=$("#checkout_pickup_place");var t=$pickupPlace.val().split("::");formData.place=t[2];formData.street=t[0];formData.house=t[1];$deliveryDate=$("#checkout_pickup_date");formData.delivery={};formData.delivery["date"]=$deliveryDate.val()||$deliveryDate.find("option:first").val();$deliveryTime=$("#checkout_pickup_time");formData.delivery["time"]={};formData.delivery["time"]["id"]=$deliveryTime.attr("data-code");formData.delivery["time"]["index"]=$deliveryTime.attr("data-index");formData.delivery["time"]["text"]=$deliveryTime.val();formData.delivery["place"]=$pickupPlace.find(":selected").text();formData.comment=$("#checkout_pickup_comment").val();formData.quick_order=$("#quick_order").is(':checked');formData.type="pickup";break;}
formData.promocode=$('#cart_step_two_promocode').val();formData.payment={};formData.payment["type"]=$('input[name="checkout_payment"]:checked').val();$paytype=formData.payment["type"];formData.payment["online"]=false;if($paytype=='online'){formData.payment["type"]='online';formData.payment["online"]='cloud';formData.payment["org"]=$("#checkout_payment_online").attr("data-org");}
if($paytype=='onlineep'){formData.payment["type"]='online';formData.payment["online"]='epos';formData.payment["org"]=$("#checkout_payment_online").attr("data-org");}
formData.payment["bonus"]=$("#invoice-bonus-total").find("input").val();formData.payment["total"]=$("#invoice-total").find("li").text();return formData;},checkRequiredFields:function(){var result=$('#checkout_street').val()!==''&&$('#checkout_house_number').val()!==''&&$('#checkout_delivery_date').val()!==''&&$('#checkout_delivery_time').val()!==''||$('#checkout_pickup_place').val()!==''&&$('#checkout_pickup_date').val()!==''&&$('#checkout_pickup_time').val()!=='';if(result){$('#cart_step_two_promocode').removeProp('disabled')}else{$('#cart_step_two_promocode').prop('disabled','disabled')}},clearCatalogFilters:function(){ms.forms.$catalogFilterForm.find(".radiobtn").removeAttr("checked");ms.forms.$catalogFilterForm.submit();},doCatalogFilter:function($form){ms.loaderShow();var $this,value;var showClearFilterButton=false;var labels={include:[],exclude:[]};var ingredients={include:[],exclude:[]};$.each($form.find(":input:checked"),function(){showClearFilterButton=true;$this=$(this);value=$this.data("value");if($this.data("kind")=="label"){if($this.data("type")=="include"){labels.include.push(value);}
if($this.data("type")=="exclude"){labels.exclude.push(value);}}
if($this.data("kind")=="ingredient"){if($this.data("type")=="include"){ingredients.include.push(value);}
if($this.data("type")=="exclude"){ingredients.exclude.push(value);}}});var data={category:$form.data("category"),li:labels.include.join(),le:labels.exclude.join(),ii:ingredients.include.join(),ie:ingredients.exclude.join()};$.get(ms.url.api+ms.url.getProducts,data,function(response){var $resetCatalogFilter=$("#reset-catalog-filter");$("#products-list").html(response.html);if(showClearFilterButton){$resetCatalogFilter.show();}else{$resetCatalogFilter.hide();}
ms.loaderHide();ms.modals.$filterModal.modal("hide");},"json");},initInputMasks:function(){$(".inputDateBirthMask").inputmask({skipInputEvent:false,skipKeyPressEvent:false,clearIncomplete:true,placeholder:"__.__.____",greedy:false,mask:"99.99.9999"});$(".inputPhoneMask").inputmask({constrainInput:true,skipInputEvent:false,skipKeyPressEvent:false,clearIncomplete:true,placeholder:"+7 ___-___-__-__",greedy:false,mask:"+7 999-999-99-99"});$(".inputCountMask").inputmask({skipInputEvent:false,skipKeyPressEvent:false,clearIncomplete:false,placeholder:"",greedy:false,mask:"99"});},changeCity:function(cityLink){var $modal=$("#change-city");$modal.find("button:last").attr("data-city-link",cityLink);$modal.modal("show");},changeCityConfirm:function($button){var href=$button.data("city-link")||false;ms.clearCart(href);},clearCart:function(redirect){$.post(ms.url.api+ms.url.clearCart,{},function(response){if(response.result=="success"){if(redirect){window.location.replace(redirect);}}},"json");},changeSort:function($option){ms.loaderShow();$option=typeof $option!=='undefined'?$option:$('.mm-city.sort>a');var sortby=$option.data("sort"),text=$option.find('span').text(),$span=$('.js-product-sort'),oldText=$span.text(),oldType=$span.parent().data('sort'),resource=$("#products-list").data('alias'),device=($(window).width()<768)?'mobile':'desktop',link=location.toString();$('.mm-city.sort').removeClass('active');$.post(ms.url.api+ms.url.changeSort,{resource:resource,sortby:sortby,device:device},function(response){ms.loaderHide();if(response.result=="success"){$option.data('sort',oldType);$option.find('span').text(oldText);$span.text(text).parent().data('sort',sortby);$('#products-list').html(response.html);textCrop();setLazy();lazyLoad();var pos=link.search(/#/);if(pos!=-1&&pos!=(link.length-1)){var hash=link.slice(pos);$("[data-hash="+hash+"]").trigger('click');}}},"json");},getAdditionProductsBlock:function(){ms.loaderShow();$.post(ms.url.api+ms.url.getAdditionProductsBlock,{id:$('#addition-products-block').data('id')},function(response){ms.loaderHide();if(response.result=="success"){$('#addition-products-block').html(response.html);}},"json");},changeProductGroupItem:function($tab){var img;var itemId=$tab.data("item-id");var $cell=($tab.parent().hasClass('cat-item-footer'))?$tab.parents(".cat-item").parent().parent():$tab.parents(".mob-cat-item").parent().parent();$.get(ms.url.api+ms.url.getGroupProduct,{item_id:itemId},function(response){if(response.html){$cell.replaceWith(response.html);textCrop();setLazy();lazyLoad();}},"json");},repeatOrder:function($button){var orderId=$button.data("order-id");$.post(ms.url.api+ms.url.repeatOrder,{order_id:orderId},function(response){if(response.result=="success"){location.replace(response.redirect);}},"json");},checkHash:function(){var url=window.location.hash;if(url.length){setTimeout(function(){$(document).find('[data-hash="'+url+'"]').trigger("click");},500);}},checkSocials:function(){var $socials=$(".social.toolbar");if($socials.find("li").length==0){$socials.parents(".social.moved").remove();}},activatePromo:function($form){var $loader=$form.find(".loader-box");$loader.show();$.post(ms.url.api+ms.url.activatePromo,$form.find(":input"),function(response){if(response.result=="success"){ms.modals.$promoModal.modal("hide");ms.modals.$promoModalThanks.find(".thx-modal-text").text(response.message);ms.modals.$promoModalThanks.modal("show");}
if(response.result=="error"){ms.showErrorModal(response.error);}
$loader.hide();},"json");},getBlockingTV:function(tvName,obj){$.post(ms.url.api+ms.url.getBlockingTV,{tvName:tvName},function(response){if(response.result=="success"){if(response.tvValue=="false"){$(obj).val("");$(".time-list").remove();$("#guarantee_delivery_box").hide(400).removeClass('in').find("#guarantee_delivery_accept").removeAttr("checked");ms.modals.$endOrdersModal.modal("show");ms.modals.$errorModal.modal("hide");ms.checkRequiredFields();}else{if(obj)ms.getDeliveryTimes($(obj));}}
if(response.result=="error"){}},"json");},commentsShowElse:function($button){$.post(ms.url.api+ms.url.commentsShowElse,{shown:$button.data("shown")},function(response){if(response.result=="success"){$(".testimonials-beacon").append(response.html);$button.data("shown",response.shown).attr("data-shown",response.shown);if(response.stop)$button.remove();}
if(response.result=="error"){$button.remove();}},"json");},sendFriendPhone:function($form){var ajax=true;$form.find(":input").each(function(){var tel=$(this).val().replace(/\D/g,'');if((tel.length<11)&&(tel.length>0)){ajax=false;ms.showErrorModal("В номере: "+$(this).val()+"менее 11 цифр !","your-code-modal");}});if(ajax){ms.loaderShow();$.post(ms.url.api+ms.url.sendFriendPhone,$form.find(":input"),function(response){if(response.result=="success"){ms.loaderHide();$form.find("input").val("");ms.modals.$yourCode.modal("hide");(response.html1)?$("#thx-friend").find("#friends-text1").removeClass('hidden').find("#phones1").html(response.html1):$("#thx-friend").find("#friends-text1").addClass('hidden');(response.html2)?$("#thx-friend").find("#friends-text2").removeClass('hidden').find("#phones2").html(response.html2):$("#thx-friend").find("#friends-text2").addClass('hidden');if((response.html1)||(response.html2))$("#thx-friend").modal("show");}
if(response.result=="error"&&response.errors){ms.loaderHide();if(typeof response.errors==="string"){ms.showErrorModal(response.errors);}else{$.each(response.errors,function(key,value){$("#"+value).addClass("has-error");});}}},"json");}},sendInterview:function($form){var data={radio:[],time:[]};var radio=$form.find(":input[id^='radio']:checked");var time=$form.find(":input[id^='time']:checked");radio.each(function(){data.radio.push({"radio_id":$(this).attr('id').slice(-1),"radio_name":$(this).next($("label[for="+$(this).attr('id')+"]")).html()});});time.each(function(){data.time.push({"time_id":$(this).attr('id').slice(-1),"time_interval":$(this).next($("label[for="+$(this).attr('id')+"]")).html()});});$.post(ms.url.api+"/send-interview.json",data,function(response){},"json");$form.parents().find("#interview").modal('hide');$form.find(":input:checked").removeAttr("checked");},saveBirthdayChoice:function(choice){ms.loaderShow();$.post(ms.url.api+ms.url.saveBirthdayChoice,{choice:choice},function(response){if(response.result=="success"){ms.loaderHide();if(response.html){$(".cart-content-choice").html(response.html);}}
if(response.result=="error"){ms.loaderHide();ms.showErrorModal(response.message);}},"json");},scrollToError:function(){destination=$(".has-error").offset().top-$('#mm-nav').height();window.scrollTo(0,destination);},cloudPaymentsWidget:function(params,redirect){var widget=new cp.CloudPayments();widget.auth(params,function(options){ms.loaderShow();window.location.replace(redirect);},function(reason,options){$(".js-step-two-checkout").removeAttr("disabled");reason=(reason==='User has cancelled')?"Вы отменили оплату!":reason;ms.showErrorModal(reason);});},incLike:function($this){$id=$this.parents('a').data('item-id');$.post(ms.url.api+ms.url.incLike,{product_id:$id},function(response){if(response.result=="success"){$this.parent().find('span').text(response.likes);$this.removeClass('heart').addClass('heart-filled');}},"json");},freePromo:function($this){var bonus;$.post(ms.url.api+ms.url.sendFreePromo,{freepromo:$this.parent().find('input#freepromo').val()},function(response){if(response.result=="success"){$('.cart-content-balls-T span').text(response.bonus);}
if(response.result=="error"){ms.loaderHide();ms.showErrorModal(response.message);}},"json");},testPromo:function($this){ms.attempts++;if(ms.attempts>3){$('#cart_step_two_promocode_btn').prop('disabled','disabled');setTimeout(function(){$('#cart_step_two_promocode_btn').removeProp('disabled');ms.attempts=0;},60*1000);ms.showErrorModal('Вы исчерпали количество попыток проверки промокода! Проверка будет доступна через 1 мин.');}
var $activeTab=$(".tab-pane.active");var tabId=$activeTab.attr("id");var formData=ms.getStepTwoFormData(tabId);ms.loaderShow();$.post(ms.url.api+ms.url.sendTestPromo,formData,function(response){if(response.result=="success"){ms.showErrorModal('Промокод верный!');}
if(response.result=="error"){ms.loaderHide();ms.showErrorModal(response.message);}
ms.loaderHide();},"json");},checkToken:function(){var stoken=localStorage.getItem('ms_Token');if(stoken===null)return;var token=JSON.parse(stoken);if(Date.now()>=token.access_expires*1000){ms.refreshToken(token.refresh_token);}},refreshToken:function(refresh_token){$.post(ms.url.api+ms.url.refreshToken,{refreshtoken:refresh_token},function(response){if(response.result=="success"){if(response.token){localStorage.setItem('ms_Token',JSON.stringify(response.token));}}
if(response.result=="error"){ms.loaderHide();ms.showErrorModal(response.message);}},"json");},getBonus:function(){}};$(document).ready(function(){ms.init();ms.checkToken();$("#cart-item-modal").on("show.bs.modal",function(e){var $button=$(e.relatedTarget);$(this).find(".modal-content").html("");ms.getProduct($button);});$body.on("click","#btn-your-code",function(e){var link=location.toString()+"#"+ms.modals.$yourCodeAlias;window.history.pushState("",null,link);});if($("#btn-your-code").length>0){var link=location.toString();var result=link.slice(link.search(/#/)+1);var ban=localStorage["ms.modalYourCode.ban"];switch(result){case(ms.modals.$yourCodeAlias):ms.modals.$yourCode.modal("show");break;default:if(!ban){var link=location.toString()+"#"+ms.modals.$yourCodeAlias;window.history.pushState("",null,link);ms.modals.$yourCode.modal("show");}
break;}}
if(ms.modals.$yourCode.length>0){var $checkBox=$('#account_profile_modal_action_show');var ban=localStorage["ms.modalYourCode.ban"];(ban)?$checkBox.attr('checked','checked').prop('checked','checked'):$checkBox.removeAttr('checked');}
$('#account_profile_modal_action_show').on("click",function(){if($(this).attr("checked")){$(this).removeAttr('checked');localStorage.removeItem("ms.modalYourCode.ban");}else{$(this).attr('checked','checked').prop('checked','checked');localStorage["ms.modalYourCode.ban"]=true;}});if($(".banner-slider").length){var device=($(window).width()<768)?'mobile':'desktop',link=location.toString(),result=link.slice(link.search(/#/)+1);var params=link.split('/');params=params[params.length-1];params=params.split('?');alias=params[0];ms.getBannerSlider(device,alias);switch(result){case(ms.modals.$yourCodeAlias):ms.modals.$loginModal.modal("show");result=link.slice(0,link.search(/#/)-1);window.history.pushState("",null,result);break;default:break;}}
if($(".main-slider").length){var device=($(window).width()<768)?'mobile':'desktop',link=location.toString(),result=link.slice(link.search(/#/)+1);ms.getMainSlider(device);switch(result){case(ms.modals.$yourCodeAlias):ms.modals.$loginModal.modal("show");result=link.slice(0,link.search(/#/)-1);window.history.pushState("",null,result);break;default:break;}
var tv=(ms.modals.$endOrdersModal)?ms.modals.$endOrdersModal.data("tv"):'';ms.getBlockingTV(tv,null);}
if($("#products-list").length>0){}
if($("#addition-products-block").length>0){ms.getAdditionProductsBlock();}
$body.on("click",".js-get-prev-product, .js-get-next-product",function(e){e.preventDefault();var $button=$(this);ms.getProduct($button);});$("#news-modal").on("show.bs.modal",function(e){var $button=$(e.relatedTarget);ms.getNews($button);});$body.on("click",".js-get-prev-news, .js-get-next-news",function(e){e.preventDefault();var $button=$(this);ms.getNews($button);});$body.on("submit","#comment-form",function(e){e.preventDefault();if($("#testimonial_text").val()===""){ms.showErrorModal("Пожалуйста, заполните текст отзыва!","comment");}else{var $form=$(this);var $button=$form.find("button");$button.attr("disabled","disabled");ms.sendTestimonial($form);}});$body.on("submit","#send-phones-form",function(e){e.preventDefault();var $form=$(this);ms.sendFriendPhone($form);});$body.on("keypress",".friend_phone",function(e){if(e.which==13){e.preventDefault();var num=$(this).attr('id');num=++num[num.length-1];($("#friend_phone_"+num).length>0)?$("#friend_phone_"+num).focus():$(this).parents("form").submit();}});$body.on("submit","#callback-form",function(e){e.preventDefault();var $form=$(this);var $button=$form.find("button");$button.attr("disabled","disabled");ms.sendCallback($form);});$body.on("submit","#help-form",function(e){e.preventDefault();var $form=$(this);var $button=$form.find("button");$button.attr("disabled","disabled");ms.sendFAQ($form);});$body.on("submit","#surprise-me-form",function(e){e.preventDefault();var $form=$(this);ms.getSurprise($form);});$body.on("click",".js-surprise-me-renew",function(e){e.preventDefault();setTimeout(function(){$("#surprise-me-form").submit();},1000);});$body.on("click",".js-surprise-me-to-cart",function(){var $button=$(this);$button.attr("disabled","disabled");$button.parents(".modal-footer").find(".loader-box").show();setTimeout(function(){$.each(ms.modals.$randomModal.find(".js-add-to-cart"),function(){$(this).click();sleep(500);});$("#surprise-me-form").find(":input").val("");ms.modals.$randomModal.modal("hide");},1000);});$body.on("click",".js-add-to-cart",function(e){e.preventDefault();var $button=$(this);ms.addToCart($button);});$body.on("submit","#login-form",function(e){e.preventDefault();var $form=$(this);ms.getLoginConfirmCode($form);});$body.on("submit","#login-confirm-form",function(e){e.preventDefault();var $form=$(this);ms.confirmLogin($form);});$body.on("submit","#register-form",function(e){e.preventDefault();var $form=$(this);ms.getRegistrationConfirmCode($form);});$body.on("submit","#register-confirm-form",function(e){e.preventDefault();var $form=$(this);ms.confirmRegistration($form);});$body.on("click",".js-resend-code-again",function(e){e.preventDefault();var $button=$(this);if(!$button.hasClass("disabled")){$button.addClass("disabled");$("#"+$(this).data("form")).submit();}});$body.on("click",".streets-list li",function(){var $this=$(this);ms.setStreet($this);});$body.on("click",".js-account-address-remove",function(e){e.preventDefault();var $button=$(this);ms.removeAccountAddress($button);});$body.on("click",".js-account-address-add",function(e){e.preventDefault();var $button=$(this);ms.addAccountAddress($button);});$body.on("submit","#account-profile-form",function(e){e.preventDefault();var $form=$(this);ms.updateAccountProfile($form);});var $stepOne=$(".js-cart-step-one");if($stepOne.length>0&&$stepOne.parent().hasClass("active")){ms.cartStepOne();}
$body.on("click",".js-cart-product-inc",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");var quantity=$button.prev().val();if((typeof disabled===typeof undefined)&&(quantity<99)){ms.increaseCartItem($button);}});$body.on("click",".js-cart-product-dec",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");if(typeof disabled===typeof undefined){ms.decreaseCartItem($button);}});$body.on("click",".js-cart-product-remove",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");if(typeof disabled===typeof undefined){ms.removeCartItem($button);}});var oldValProd,newValProd;$body.on("keypress",".js-cart-product-count",function(e){if(e.which==13){e.preventDefault();$(this).blur();}});$body.on("focus",".js-cart-product-count",function(){oldValProd=$(this).text();});$body.on("blur",".js-cart-product-count",function(){var $span=$(this);newValProd=($span.val().length!=0)?$span.val():0;$span.val(newValProd);if($span.val()==0){var $removeButton=$span.parents(".cart-product-item").find(".js-cart-product-remove");ms.removeCartItem($removeButton);}else{if(oldValProd!=newValProd){ms.setCartItem($span,newValProd-oldValProd);}}});$body.on("click",".js-cart-add-product-inc",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");var quantity=$button.prev().val();if((typeof disabled===typeof undefined)&&(quantity<99)){ms.increaseCartTopingItem($button);}});$body.on("click",".js-cart-add-product-dec",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");if(typeof disabled===typeof undefined){ms.decreaseCartTopingItem($button);}});$body.on("dblclick",".js-cart-add-product-count",function(e){e.preventDefault();$(this).val("");});var oldValTopings,newValTopings;$body.on("keypress",".js-cart-add-product-count",function(e){e.preventDefault();if(e.which==13){$(this).blur();}});$body.on("focus",".js-cart-add-product-count",function(){oldValTopings=$(this).text();});$body.on("blur",".js-cart-add-product-count",function(){var $span=$(this);newValTopings=($span.text()>$span.data("quantity-default"))?$span.text():$span.data("quantity-default");$span.val(newValTopings);if(oldValTopings!=newValTopings){ms.setCartTopingItem($span,newValTopings-oldValTopings);}});$body.on("click",".js-cart-add-flatware-inc",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");var quantity=$button.prev().val();if((typeof disabled===typeof undefined)&&(quantity<99)){ms.increaseCartFlatwareItem($button);}});$body.on("click",".js-cart-add-flatware-dec",function(e){e.preventDefault();var $button=$(this);var disabled=$button.attr("disabled");if(typeof disabled===typeof undefined){ms.decreaseCartFlatwareItem($button);}});$body.on("dblclick",".js-cart-flatware-count",function(e){e.preventDefault();$(this).val("");});var oldVal,newVal;$body.on("keypress",".js-cart-flatware-count",function(e){if(e.which==13){e.preventDefault();$(this).blur();}});$body.on("focus",".js-cart-flatware-count",function(){oldVal=$(this).text();});$body.on("blur",".js-cart-flatware-count",function(){var $span=$(this);newVal=($span.text()>$span.data("quantity-default"))?$span.text():$span.data("quantity-default");$span.val(newVal);if(oldVal!=newVal){ms.setCartFlatwareItem($span,newVal-oldVal);}});$body.on("submit","#catalog-filter-form",function(e){e.preventDefault();var $form=$(this);ms.doCatalogFilter($form);});$body.on("click",".js-cities-list a",function(e){e.preventDefault();var $this=$(this);var changeCityLink=$this.attr("href");ms.changeCity(changeCityLink);});$body.on("click",".js-change-city-confirm",function(e){e.preventDefault();var $this=$(this);ms.changeCityConfirm($this);});$("#stock-modal").on("show.bs.modal",function(e){var $button=$(e.relatedTarget);ms.getAction($button);});$body.on("click",".js-sort-list a",function(e){e.preventDefault();var $option=$(this);ms.changeSort($option);});$body.on("click",".js-get-prev-action, .js-get-next-action",function(e){e.preventDefault();var $button=$(this);ms.getAction($button);});$body.on("click",".js-catalog-reset-filter",function(e){e.preventDefault();ms.clearCatalogFilters();});$body.on("click",".js-step-one-checkout",function(e){e.preventDefault();var $button=$(this);$button.attr("disabled","disabled");var $form=$("#cart-step-one-form");if($button.data("ignore-gift")){$form.append('<input type="hidden" name="cart_step_one_ignore_gift" value="true" />');}
ms.checkCartStepOne($form);});$body.on("click",".js-add-gift-to-cart",function(e){e.preventDefault();var $button=$(this);ms.addGiftToCart($button);});$body.on("click",".js-add-gift-to-cart-random",function(e){e.preventDefault();ms.addGiftToCartRandom();});$body.on("click",".js-add-to-cart-offer",function(e){e.preventDefault();var $button=$(this);ms.addToCartOffer($button);});$body.on("click",".js-product-group-select",function(e){e.preventDefault();var $this=$(this);ms.changeProductGroupItem($this);});$(document).on("blur","#cart_step_one_phone",function(e){var that=this;e.preventDefault();var val=$(that).val();if(val.length==0){}
return true;});$(document).on("change","#cart_step_one_phone",function(e){var that=this;e.preventDefault();var val=$(that).val();if(val.length==0){}
if(val.substr(3,1)=='8'||val.substr(3,1)=='7'){$(that).val('');alert('Ошибка в номере телефона '+val);$(that).focus();return false;}
return true;});$body.on("keyup",".js-street-autocomplete",function(e){if(e.keyCode!=40){$("#addresses-list").addClass("hidden");var $this=$(this);if($this.val().length>=3){ms.getStreets($this.val(),$this);}else{if($this.hasClass("from-favorite-address")){$("#checkout_street").attr("data-street-code","");$("#checkout_house_number").val("");$("#checkout_porch").val("");$("#checkout_floor").val("");$("#checkout_flat").val("");$this.removeClass("from-favorite-address");}}}});$body.on("change",".js-street-autocomplete",function(e){$("#guarantee_delivery_box").hide(400).removeClass("in").find('#guarantee_delivery_accept').removeAttr('checked');$("#checkout_house_number").val("");$("#checkout_porch").val("");$("#checkout_floor").val("");$("#checkout_flat").val("");$("#checkout_template-styler .jq-selectbox__dropdown ul li:first").click();});$body.on("click",".js-street-autocomplete",function(e){$('#checkout_delivery_time').removeAttr("disabled").val("").attr("data-code","").attr("data-index","").next(".time-list").remove();});$body.on("blur",".js-street-autocomplete",function(e){if($(this).val()==""){$(".tab-pane.active #streets-list").remove();}});$body.on("change","#checkout_pickup_place",function(e){$('#checkout_pickup_time').removeAttr("disabled").val("").attr("data-code","").attr("data-index","");$(".tab-pane.active .time-list").remove();});$body.on("click",".js-cart-step-two",function(e){e.preventDefault();$(".js-step-one-checkout").click();});$body.on("click",".js-order-history-repeat",function(e){e.preventDefault();var $this=$(this);ms.repeatOrder($this);});$body.on("focusout","#checkout_house_number",function(e){e.preventDefault();var street=$("#checkout_street").data("street-code");var house=$("#checkout_house_number").val();ms.getDeliveryCost(street,house);});$body.on("change","#checkout_delivery_date",function(e){var deliveryDate=$(".tab-pane.active").find('.jq-selectbox__select-text').text();var $deliveryTime=$(".tab-pane.active").find('#checkout_delivery_time');$deliveryTime.removeAttr("disabled");if((deliveryDate.indexOf("Сегодня")>-1)&&$("#guarantee_delivery_box").hasClass('in')){$("#guarantee_delivery_box").show(400).find('#guarantee_delivery_accept').removeAttr('checked');}else{$("#guarantee_delivery_box").hide(400);}
$(".time-list").remove();if(deliveryDate.indexOf("Сегодня")==-1){ms.getDeliveryTimes($("#checkout_delivery_time"));}else{var tv=(ms.modals.$endOrdersModal)?ms.modals.$endOrdersModal.data("tv"):'';ms.getBlockingTV(tv,"#checkout_delivery_time");}});$body.on("change","#checkout_pickup_date",function(e){var deliveryDate=$(".tab-pane.active").find('.jq-selectbox__select-text').text();$(".time-list").remove();if(deliveryDate.indexOf("Сегодня")==-1){ms.getDeliveryTimes($("#checkout_pickup_time"));}else{var tv=(ms.modals.$endOrdersModal)?ms.modals.$endOrdersModal.data("tv"):'';ms.getBlockingTV(tv,"#checkout_pickup_time");}});$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){$("#invoice-shipping-total").remove();$("#checkout_street").data("street-code","");$("#checkout_house_number").val("");$("#checkout_floor").val("");$("#checkout_porch").val("");$("#checkout_flat").val("");$("#checkout_delivery_time").val("");$("#checkout_pickup_place").val("");$("#checkout_pickup_time").val("");setTimeout(function(){$("#checkout_pickup_place").trigger("refresh");},1);ms.recalcInvoice();});$body.on("keyup","#invoice-bonus-total input",function(e){var $this=$(this);var max=parseFloat($this.attr("max"));var value=$this.val();if(value.match(/[^0-9\.\,]/g)){value=value.replace(/[^0-9\.\,]/g,"");$this.val(value);}
value=value.replace(",",".");$this.val(value);var dotsCount=(value.match(/\./g)||[]).length;if(dotsCount>1){value=value.substring(0,value.length-1);$this.val(value);}
value=parseFloat(value);if(value>max){$this.val(max);}
ms.recalcInvoice();});$body.on("hide.bs.modal",".modal",function(e){});$body.on("hide.bs.modal","#news-modal, #stock-modal, #cart-item-modal, #your-code-modal",function(e){var link=window.location.protocol+"//"+window.location.hostname+window.location.pathname;window.history.pushState("",null,link);});$body.on("keyup","#checkout_name",function(e){var inputVal=$(this).val();$("#checkout_pickup_name").val(inputVal);});$body.on("keyup","#checkout_pickup_name",function(e){var inputVal=$(this).val();$("#checkout_name").val(inputVal);});$body.on("keyup","#checkout_comment",function(e){var inputVal=$(this).val();$("#checkout_pickup_comment").val(inputVal);});$body.on("keyup","#checkout_pickup_comment",function(e){var inputVal=$(this).val();$("#checkout_comment").val(inputVal);});$body.on("click",".js-step-two-checkout",function(e){e.preventDefault();var $button=$(this);$button.attr("disabled","disabled");ms.checkCartStepTwo();});$body.on("submit","#order-confirm-form",function(e){e.preventDefault();var $form=$(this);ms.orderConfirm($form);});$body.on("click",".radiobtn + label",function(e){var $this=$(this);var $checkbox=$this.parents(".filter-group").find(":checked");if($checkbox.length>0){var type=$checkbox.data("type");var clickedType=$this.prev().data("type");if(clickedType!=type){$this.parents(".filter-group").find('[data-type="'+type+'"]').removeAttr("checked");}}});$body.on("click",".js-choose-city",function(e){e.preventDefault();var link=$(this).attr("href");if(ms.supportLocalStorage()){localStorage.setItem("startCityLink",link);}
if(link){ms.clearCart(link);}});$body.on("keydown",".js-delivery-time-refresh",function(e){return false;});$body.on("click",".js-delivery-time-refresh",function(e){e.preventDefault();var deliveryDate=$(".tab-pane.active").find('.jq-selectbox__select-text').text();if(deliveryDate.indexOf("Сегодня")==-1){ms.getDeliveryTimes($(this));}else{var tv=(ms.modals.$endOrdersModal)?ms.modals.$endOrdersModal.data("tv"):'';ms.getBlockingTV(tv,this);}});$('#guarantee_delivery_accept_').on("click",function(){var $deliveryTime=$(".tab-pane.active").find("#checkout_delivery_time");var $guaranteeModal=$("#guarantee-delivery-modal");$guaranteeModal.find("#guarantee_time").html($(this).attr("data-time"));if($(this).attr("checked")){$(this).removeAttr('checked');$deliveryTime.removeAttr("disabled");}else{$(this).removeAttr('checked');$guaranteeModal.modal("show");}});$("#js-guarantee-agree").on("click",function(e){$('#guarantee_delivery_accept').prop("checked","checked").attr("checked","checked");$(".tab-pane.active").find("#checkout_delivery_time").val("").attr("disabled","disabled");$(".tab-pane.active").find(".time-list").remove();$(this).parents(".modal.fade.in").modal("hide");});$(".js-comments-show-else").on("click",function(e){e.preventDefault();var $button=$(this);ms.commentsShowElse($button);});$body.on("click",".time-list li",function(){var $this=$(this);ms.setTime($this);ms.checkRequiredFields();});$(".modal").on("shown.bs.modal",function(){$(this).find(":input:first").focus();});$("#login").on("show.bs.modal",function(e){var $button=$(e.relatedTarget);var $modal=$(this);var activeTab=$button.data("tab")||false;if(activeTab){$modal.find('a[href="'+activeTab+'"]').click();}});if($(".cart-delivery-nav").length>0){ms.getDeliveryDates("","","delivery");ms.getDeliveryDates("","","pickup");ms.recalcInvoice();var $fatalError=$("#fatal-error");if($fatalError.length>0){ms.showErrorModal($fatalError.val());}}
var $searchPage=$(".search-page");if($searchPage.length>0){var searchTerm=$searchPage.find('input[name="term"]').val();$searchPage.removeHighlight();if(searchTerm){$searchPage.highlight(searchTerm);}}
$("#comment").on("hide.bs.modal",function(e){var $modal=$(this);ms.clearFormInput($modal);$modal.find(".file_upload").find("button").text("Прикрепить файл");});$("#callback-modal").on("hide.bs.modal",function(e){var $textarea=$(this).find("textarea");$textarea.val("");});$("#error-common").on("hide.bs.modal",function(e){var $modal=$(this);$modal.removeClass("opened");});$body.on("change","#checkout_template",function(e){$(".tab-pane.active #streets-list").remove();$('#checkout_delivery_time').val("").attr("data-code","").attr("data-index","").next(".time-list").remove();var $this=$(this);var $item=$this.find('option:contains('+$this.val()+')');ms.setAddress($item);});$body.on("focus","#checkout_name, #checkout_house_number, #checkout_porch, #checkout_floor, #checkout_flat, #checkout_delivery_time",function(e){var $street=$(".js-street-autocomplete");if($street.attr("data-street-code").length==0&&$street.val().length>0){ms.showErrorModal("Вы указали неверную улицу. Для этого выберите улицу из списка.");$street.val("");$street.data("street-code","");}
$('#checkout_delivery_time').val("").attr("data-code","").attr("data-index","").next(".time-list").remove();});$body.on("click","#login #uLogin a",function(e){e.preventDefault();var $this=$(this);$this.parents("#login").find(".loader-box").show();});$body.on("submit","#promo-form",function(e){e.preventDefault();var $form=$(this);ms.activatePromo($form);});$body.on("click",".js-ind-offer",function(e){ms.loaderShow();window.location.replace("/menu");});$body.on("click","button.disabled",function(e){e.preventDefault();var text="Вы можете воспользоваться одним индивидуальным предложением в день!";ms.showErrorModal(text);});$body.on("click","#checkout_payment_online",function(e){$onlines=$(this).parents('.container').find('.checkout_online_payment');$onlinesep=$(this).parents('.container').find('.checkout_online_paymentep');$onlinesep.fadeOut(400,'linear').find('input').removeAttr("checked");$("#checkout-invoice").hide().addClass('col-sm-offset-2 col-md-offset-3 col-lg-offset-4');$onlines.show(400,'linear',function(){$("#checkout-invoice").fadeIn(400);});$onlines.find('input').removeAttr("checked");});$body.on("click","#checkout_payment_onlineep",function(e){$onlines=$(this).parents('.container').find('.checkout_online_payment');$onlinesep=$(this).parents('.container').find('.checkout_online_paymentep');$onlines.fadeOut(400,'linear').find('input').removeAttr("checked");$("#checkout-invoice").hide().addClass('col-sm-offset-2 col-md-offset-3 col-lg-offset-4');$onlinesep.show(400,'linear',function(){$("#checkout-invoice").fadeIn(400);});$onlines.find('input').removeAttr("checked");});$body.on("click","#checkout_payment_cash, #checkout_payment_card",function(e){$onlines=$(this).parents('.container').find('.checkout_online_payment');$onlinesep=$(this).parents('.container').find('.checkout_online_paymentep');$onlinesep.fadeOut(400,'linear').find('input').removeAttr("checked");$("#checkout-invoice").hide().removeClass('col-sm-offset-2 col-md-offset-3 col-lg-offset-4');$onlines.fadeOut(400,'linear',function(){$("#checkout-invoice").fadeIn(400);}).find('input').removeAttr("checked");});$body.on("submit","#interview-form",function(e){e.preventDefault();var $form=$(this);ms.sendInterview($form);});$body.on("click","#interview-form button",function(e){localStorage["ms.modalInterview.ban"]=true;});$body.on("click",".js-choose-birthdayman",function(e){e.preventDefault();ms.modals.$birthdayModal.modal("hide");var $radio=ms.modals.$birthdayModal.find(":input[type='radio']:checked");if(typeof $radio.val()===typeof undefined){ms.showErrorModal("Вы не сделали выбор!","birthday-modal");return;}
var choice=$radio.val();ms.saveBirthdayChoice(choice);});$body.on("click",".js-choose-birthdayman-random",function(e){e.preventDefault();ms.modals.$birthdayModal.modal("hide");var $inputs=ms.forms.$birthdayModalForm.find(":input[type='radio']");var choice=Math.floor(Math.random()*$inputs.length);ms.saveBirthdayChoice(choice);});$body.on("click","#quick_order",function(e){if($(this).is(':checked')){$('#checkout_name').attr('disabled','disabled');$('#checkout_name').removeProp('required');$('#checkout_pickup_name').attr('disabled','disabled');$('#checkout_pickup_name').removeProp('required');$('#checkout_template').attr('disabled','disabled');$('#checkout_template').trigger('refresh');$('#checkout_street').attr('disabled','disabled');$('#checkout_street').removeProp('required');$('#checkout_house_number').attr('disabled','disabled');$('#checkout_porch').attr('disabled','disabled');$('#checkout_floor').attr('disabled','disabled');$('#checkout_flat').attr('disabled','disabled');$('#checkout_delivery_date').attr('disabled','disabled');$('#checkout_delivery_date').removeProp('required');$('#checkout_delivery_date').trigger('refresh');$('#checkout_pickup_date').attr('disabled','disabled');$('#checkout_pickup_date').removeProp('required');$('#checkout_pickup_date').trigger('refresh');$('#checkout_delivery_time').attr('disabled','disabled');$('#checkout_delivery_time').removeProp('required');$('#checkout_pickup_time').attr('disabled','disabled');$('#checkout_pickup_time').removeProp('required');$('#checkout_pickup_place').attr('disabled','disabled');$('#checkout_pickup_place').trigger('refresh');$('#checkout_comment').attr('disabled','disabled');$('#checkout_pickup_comment').attr('disabled','disabled');}
else{$('#checkout_name').removeAttr('disabled');$('#checkout_name').prop('required','required');$('#checkout_pickup_name').removeAttr('disabled');$('#checkout_pickup_name').prop('required','required');$('#checkout_template').removeAttr('disabled');$('#checkout_template').trigger('refresh');$('#checkout_street').removeAttr('disabled');$('#checkout_street').prop('required','required');$('#checkout_house_number').removeAttr('disabled');$('#checkout_porch').removeAttr('disabled');$('#checkout_floor').removeAttr('disabled');$('#checkout_flat').removeAttr('disabled');$('#checkout_delivery_date').removeAttr('disabled');$('#checkout_delivery_date').prop('required','required');$('#checkout_delivery_date').trigger('refresh');$('#checkout_pickup_date').removeAttr('disabled');$('#checkout_pickup_date').prop('required','required');$('#checkout_pickup_date').trigger('refresh');$('#checkout_delivery_time').removeAttr('disabled');$('#checkout_delivery_time').prop('required','required');$('#checkout_pickup_time').removeAttr('disabled');$('#checkout_pickup_time').prop('required','required');$('#checkout_pickup_place').removeAttr('disabled');$('#checkout_pickup_place').trigger('refresh');$('#checkout_comment').removeAttr('disabled');$('#checkout_pickup_comment').removeAttr('disabled');}
return true;});$(document).on("change","#checkout_street",function(){ms.checkRequiredFields();});$(document).on("change","#checkout_house_number",function(){ms.checkRequiredFields();});$(document).on("change","#checkout_delivery_date",function(){ms.checkRequiredFields();});$(document).on("change","#checkout_pickup_place",function(){ms.checkRequiredFields();});$(document).on("change","#checkout_pickup_date",function(){ms.checkRequiredFields();});$(document).on("change","#checkout_pickup_time",function(){ms.checkRequiredFields();});$body.on("keyup","#cart_step_one_promocode",function(e){var inputVal=$(this).val().toLowerCase();var pnames=['победный','для друзей','настроение'];setname='';if(inputVal=='мой выбор'){products=$('.cart-outer .cart-product-item');$.each(products,function(k,itm){pname=$(itm).find('.cart-content-item-T a').text().trim();var ss=pname.toLowerCase();if(pnames.indexOf(ss)!==-1){setname=' '+pname;}});$(this).val($(this).val()+setname);}});$(document).on("click",".btn-slide",function(){var $this=$(this);if($('.product-content-wrap').is(':visible')){$(this).val('▼ Показать описание');$('.product-content-wrap').hide(400);}
else{$(this).val('▲ Скрыть описание');$('.product-content-wrap').show(400);}});$(document).on("click",".heart,.heart-filled",function(e){e.preventDefault();var $this=$(this);ms.incLike($this);return false;});$(document).on("click",".btn-activate-bonus",function(e){e.preventDefault();var $this=$(this);ms.freePromo($this);return false;});$(document).on("click","#persdata",function(e){if($(this).is(':checked')){$(this).parents('.cart-delivery-footer').find('.main-btn').removeProp('disabled');}else{$(this).parents('.cart-delivery-footer').find('.main-btn').prop('disabled','disabled');}});$(document).on("click","#rpersdata",function(e){if($(this).is(':checked')){$(this).parents('#register-form').find('.main-btn-small').removeProp('disabled');}else{$(this).parents('#register-form').find('.main-btn-small').prop('disabled','disabled');}});$(document).on("click","#cart_step_two_promocode_btn",function(e){e.preventDefault();var $this=$(this);ms.testPromo($this);return false;});ms.checkHash();ms.checkSocials();});